# Release Note for 10323

## Notable new features
* REST API Endpoints security
* Workflow endpoints
* Workflow services
* REST API rate limit and quota limit

## Other new features
* Button form element supports full OperationEndpoint
* Reorder members in EntityDefinition designer should now works with full drag and drop, see issue #3139
* Solution Explorer now displays item with `Name` not the id or source file name anymore
* You get a set of new icons in fontawesome 4.6.1


## Major Updates

### Workflow Services
* Allow developers to build their own Workflow dashboard
* GetPendingTask
* Search endpoint - search using predicates
* Get one by Id endpoint
* Changes in `*.config` files especially in web.config , workers.console.runner.exe.config and workers.windowsservice.runner.exe.config where `ICorrelationRepository` entry should be removed and comes the `IWorkflowService`. The default implementation of `IWorkflowService` is  `Bespoke.Sph.ElasticsearchRepository.WorkflowService, elasticsearch.repository`

Remove this
```xml
<object name="ICorrelationRepository" type="Bespoke.Sph.ElasticsearchRepository.CorrelationRepository, elasticsearch.repository"
```

and add this
```xml
<object name="IWorkflowService" type="Bespoke.Sph.ElasticsearchRepository.WorkflowService, elasticsearch.repository" />
```

* You'll need to recreate your elasticsearch `pendingtask` mapping to match this one

```javascript
{
   "pendingtask": {
      "properties": {
         "WorkflowId": { "type": "string", "index": "not_analyzed"},
         "WorkflowDefinitionId": { "type": "string", "index": "not_analyzed"},
         "ActivityName": { "type": "string", "index": "not_analyzed"},
         "ActivityWebId":{ "type": "string", "index": "not_analyzed"},
         "Type":{ "type": "string", "index": "not_analyzed"},
         "Correlations":{ "type": "string", "index": "not_analyzed"}
      }
   }
}
```
in elasticsearch 1.x, use
```
GET http://localhost:9200/<your-app-name>/_mapping/pendingtask
```
if the result is equal to the above, then you're fine , else
```
DELETE http://localhost:9200/<your-app-name>/_mapping/pendingtask

PUT http://localhost:9200/<your-app-name>/_mapping/pendingtask
{
   "pendingtask": {
      "properties": {
         "WorkflowId": { "type": "string", "index": "not_analyzed"},
         "WorkflowDefinitionId": { "type": "string", "index": "not_analyzed"},
         "ActivityName": { "type": "string", "index": "not_analyzed"},
         "ActivityWebId":{ "type": "string", "index": "not_analyzed"},
         "Type":{ "type": "string", "index": "not_analyzed"},
         "Correlations":{ "type": "string", "index": "not_analyzed"}
      }
   }
}
```

WARNING - dropping the mapping will remove all the data in pendingtask type

* Now repeat the same thing for `correlationset`. Check the database/mapping/correlationset.json file the mapping content



### WorkflowService Search endpoint with HTTP GET
* Use HTTP GET
* Specify predicates with query string i.e.
```
GET http://yourserver/wf/your-workflow-id/v1/search?variable1-path=value1&variable2-path=value2
Authentication: Bearer your-api-token
```
* The HTTP GET with create a filter for each Query string pair i.e. variable1-path eq value1



### WorkflowService Search endpoint with HTTP POST a

 Use HTTP POST to send complex predicates
```
POST http://yourserver/wf/your-workflow-id/v1/search
Authentication: Bearer your-api-token
[
{
  "term" : "variable-path",
  "operation": " Eq|Neq|Gt|Ge|Lt|Le",
  "value": "value1"
}

]
```

## Bugs fixes
* 3625 - Cannot create new trigger
* 3627 - entity form : cannot set operation on button element
* 3726 - message from workflow not bind on workflow form
* 3717 - User workflow form : cannot add child item on user workflow form  
* 3716 - WebId for entity always generate new WebId
* 3715 - error calling transform definition for data import  
* 3139 - EntityDefinition designer : Drag and Drop not full function
* 3243 - Icon picker missing items from fontawesome 4.4
* 3715 - error calling transform definition for data import
* 3838 - Value object definition designer didn't allow TypeName to edited for ComplexType  
* 3839 - Solution explorer opened different item if they have the same Id, even though they're different type
