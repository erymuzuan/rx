define([],function(){function u(i){var o,s,e;if(typeof google.maps=="undefined"||typeof google.maps.Map=="undefined")return o=new $.Deferred,r().done(function(){u(i).done(function(n){o.resolve(n)})}),o.promise();var f=i||{},h=f.panel||"map",c=f.zoom||11,l=f.center||new google.maps.LatLng(3.1282,101.6441);return google.maps.visualRefresh=!0,s={zoom:c,center:l,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1,scaleControl:!0,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControlOptions:{style:google.maps.NavigationControlStyle.DEFAULT}},n=new google.maps.Map(document.getElementById(h),s),i.idle&&google.maps.event.addListener(n,"idle",function(n){i.idle(n)}),f.draw&&(e=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.MARKER,google.maps.drawing.OverlayType.CIRCLE,google.maps.drawing.OverlayType.POLYGON,google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.RECTANGLE]},polygonOptions:{editable:!0}}),i.polygoncomplete&&google.maps.event.addListener(e,"polygoncomplete",function(n){n.type="polygon";t.push(n);f.polygoncomplete(n)}),i.circlecomplete&&google.maps.event.addListener(e,"circlecomplete",function(n){t.push(n);f.circlecomplete(n)}),i.polylinecomplete&&google.maps.event.addListener(e,"polylinecomplete",function(n){t.push(n);f.polylinecomplete(n)}),i.rectanglecomplete&&google.maps.event.addListener(e,"rectanglecomplete",function(n){t.push(n);f.rectanglecomplete(n)}),i.markercomplete&&google.maps.event.addListener(e,"markercomplete",function(n){t.push(n);n.type="marker";f.markercomplete(n)}),e.setMap(n)),Task.fromResult(!0)}function y(n){for(var i=new google.maps.LatLngBounds,r=n.getPath().getArray(),t=0;t<r.length;t++)i.extend(r[t]);return i.getCenter()}function p(t,i){var r=0,u;typeof t=="object"&&(r=t.lat,i=t.lng);u=new google.maps.LatLng(r,i);n.setCenter(u)}function w(t){n.setZoom(t)}function b(){var t=n.getBounds();return t.getSouthWest().lat()+","+t.getSouthWest().lng()+"|"+t.getNorthEast().lat()+","+t.getNorthEast().lng()}function k(t){for(var r=new google.maps.LatLngBounds,i=0;i<t;i++)r.extend(t.getAt(i));n.fitBounds(r)}function f(n){var r,t;return typeof google.maps=="undefined"?(r=new $.Deferred,google.load("maps","3.6",{other_params:"region=my&sensor=false&libraries=geometry,drawing,places",callback:function(){f(n).done(function(n){r.resolve(n)})}}),r.promise()):(t=new $.Deferred,i||(i=new google.maps.Geocoder),i.geocode({address:n,region:"my"},function(n,i){i==google.maps.GeocoderStatus.OK?t.resolve({status:!0,point:n[0].geometry.location}):t.resolve({status:!1,message:"Geocode was not successful for the following reason: "+i})}),t.promise())}function d(n){var t=new $.Deferred,r;return i||(i=new google.maps.Geocoder),r={region:"my",location:n},i.geocode(r,function(n,i){var u={Street:"",Street2:"",District:"",Postcode:"",State:"",Country:"Malaysia"},f,r;if(i==google.maps.GeocoderStatus.OK){for(f=0;f<n[0].address_components.length;f++)r=n[0].address_components[f],r.types[0]=="administrative_area_level_1"&&(u.State=r.long_name),r.types[0]=="locality"&&(u.District=r.long_name),r.types[0]=="route"&&(u.Street=r.long_name);u.Street||(u.Street=n[0].address_components[1].long_name);t.resolve(u)}}),t.promise()}var i,n,t=[],e=ko.observable(!1),o=ko.observableArray(),s=ko.observableArray(),h=function(n){if(n){var t=n.getPath();return google.maps.geometry.encoding.encodePath(t)}throw"The arguement cannot be null, for getEncodedPath, please get a polygon maybe";},c=function(n){n.setMap(null);var i=_.without(t,n);t.length=0;t=i},l=function(){$.each(t,function(n,t){t.setMap(null)});t.length=0},a=function(i){var f,r,u;if(!i)throw"shape is null";if(!i.encoded)throw"encoded line is null";return(f=google.maps.geometry.encoding.decodePath(i.encoded),f.length===1)?(r=new google.maps.Marker({position:f[0],map:n,zIndex:i.zIndex||0,clickable:i.clikable||!0,draggable:i.draggable||!1,title:i.title,icon:i.icon}),r.setMap(n),r.type="marker",t.push(r),google.maps.event.addListener(r,"dragend",function(){console.log(r.getPosition())}),r):(u=new google.maps.Polygon({paths:f,map:n,zIndex:i.zIndex||0,clickable:i.clikable||!0,editable:i.editable||!1,draggable:i.draggable||!1,strokeWeight:i.strokeWeight||4,strokeColor:i.strokeColor||"#2C3CEF",fillOpacity:i.fillOpacity||.5,fillColor:i.fillColor||"#00AEDB"}),u.setMap(n),u.type="polygon",t.push(u),u)},v=function(t,i){r().done(function(){var r=new google.maps.places.Autocomplete(t,{componentRestrictions:{country:"my"}});n&&r.bindTo("bounds",n);google.maps.event.addListener(r,"place_changed",function(){var t=r.getPlace(),u;n&&(t.geometry.viewport?n.fitBounds(t.geometry.viewport):(n.setCenter(t.geometry.location),n.setZoom(17)));u="";t.address_components&&(u=[t.address_components[0]&&t.address_components[0].short_name||"",t.address_components[1]&&t.address_components[1].short_name||"",t.address_components[2]&&t.address_components[2].short_name||""].join(" "));i&&i(u)})})},r=function(){if(typeof google.maps=="undefined"){var n=new $.Deferred;return google.load("maps","3.6",{other_params:"region=my&sensor=false&libraries=geometry,drawing,places",callback:function(){n.resolve(!0)}}),n.promise()}return Task.fromResult(!0)};return{map:n,isBusy:e,errors:o,messages:s,fitToBounds:k,setCenter:p,getCenter:y,getMapCenter:function(){return n.getCenter()},loadGoogleMapLibs:r,setZoom:w,init:u,clear:l,remove:c,add:a,getEncodedPath:h,getBounds:b,geocode:f,reverseGeocode:d,setupAutocomplete:v}});
//# sourceMappingURL=map.min.js.map