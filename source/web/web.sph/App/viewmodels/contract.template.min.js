define([objectbuilders.datacontext,objectbuilders.logger,"services/jsonimportexport"],function(n,t,i){var o=ko.observable(!1),l=function(t){o(!0);var i=parseInt(t.id);return r().ContractTemplateId(i),i===0&&(r(new bespoke.sph.domain.ContractTemplate),u(new bespoke.sph.domain.Topic),f(new bespoke.sph.domain.Clause)),n.loadOneAsync("ContractTemplate","ContractTemplateId eq "+t.id).then(function(n){n&&r(n);o(!1)})},r=ko.observable(new bespoke.sph.domain.ContractTemplate),a=function(n,i,r){$(n).find("input[type=file]").kendoUpload({async:{saveUrl:"/BinaryStore/Upload",removeUrl:"/BinaryStore/Remove",autoUpload:!0},multiple:!1,error:function(n){t.logError(n,n,this,!0)},success:function(n){t.log("Your file has been uploaded",n,"route/create",!0);r.StoreId(n.response.storeId)}})},v=function(n){_uiready.init(n)},y=function(){r().DocumentTemplateCollection.push(new bespoke.sph.domain.DocumentTemplate)},s=null,u=ko.observable(new bespoke.sph.domain.Topic),p=function(){u(new bespoke.sph.domain.Topic);s=null},w=function(){s?r().TopicCollection.replace(s,u()):r().TopicCollection.push(u());u(new bespoke.sph.domain.Topic)},b=function(n){var t=ko.mapping.fromJS(ko.mapping.toJS(n));u(t);s=n},e=ko.observable(new bespoke.sph.domain.Topic),k=function(n,t){e(n);var i=$(t.target);i.parents("ul").children().removeClass("selected");i.parents("li").addClass("selected")},h=null,f=ko.observable(),d=function(){if(e().Name===null){console.log("no selected topic");return}f(new bespoke.sph.domain.Clause);h=null},g=function(){h?e().ClauseCollection.replace(h,f()):e().ClauseCollection.push(f());f(new bespoke.sph.domain.Clause)},nt=function(n){var t=ko.mapping.toJSON(n),i=ko.mapping.fromJSON(t);f(i);h=n},tt=function(n,t){var i=$(t.target);i.parents("ul").children().removeClass("selected");i.parents("li").addClass("selected")},it=function(){var i=ko.mapping.toJSON({template:r});return n.post(i,"/ContractSetting/Save").then(function(n){r().ContractTemplateId(n.ContractTemplateId);o(!1);t.log("Template kontrak sudah di simpan",r(),c,!0)})},rt=function(n){r.DocumentTemplateCollection.remove(n)},ut=function(){return i.exportJson("contract.template."+r().ContractTemplateId()+".json",ko.mapping.toJSON(r))},ft=function(){return i.importJson().done(function(t){var i=n.toObservable(JSON.parse(t));r(i);r().ContractTemplateId(0)})},c={isBusy:o,activate:l,addAttachmentCommand:y,selectTopicCommand:k,selectClauseCommand:tt,topicDialogOk:w,editTopic:b,editedTopic:u,selectedTopic:e,editClause:nt,editedClause:f,clauseDialogButtonOk:g,startAddTopicCommand:p,startAddClauseCommand:d,toolbar:{saveCommand:it,exportCommand:ut,reloadCommand:function(){return l({id:c.template().ContractTemplateId()})},commands:ko.observableArray([{icon:"icon-upload",caption:"import",command:ft}])},statusbar:{text:ko.observable(),progress:ko.observable()},configureUpload:a,template:r,topic:u,clause:f,contractTypeTemplate:ko.observable(),removeDocumentCommand:rt,viewAttached:v};return c});
//# sourceMappingURL=contract.template.min.js.map