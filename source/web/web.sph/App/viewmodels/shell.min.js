define(["durandal/system","durandal/plugins/router","services/logger","services/datacontext","config",objectbuilders.cultures],function(n,t,i,r,u){function c(){return l()}function l(){return t.map(u.routes),a("System Loaded!",null,!0),t.activate(u.startModule)}function a(t,r,u){i.log(t,r,n.getModuleId(f),u)}var e=function(){var o=function(n){n.preventDefault();n.stopPropagation();var t=$(this);t.parent().addClass("open");$(document).one("click",function(){t.parent().removeClass("open")})};$(document).on("click","button.btn-context-action,a.btn-context-action",function(n){n.preventDefault();var i=$(this),t=i.parent().find(".context-action"),r=function(n){n.preventDefault();t.hide()};t.css({right:n.offsetX||"0px"}).show();$("button.close").one("click",r)});$(document).on("click","a.dropdown-toggle",o);$(document).on("click","table.table-striped th",function(n){n.preventDefault();var t=$(this).parents("table.table-striped");t&&!t.prop("sorted")&&(console.dir(n),t.tablesorter(),t.prop("sorted","1"),$(this).trigger("click"))});var r=$("#slider-menu"),f=function(){$("section#content").animate({"margin-left":0});r.animate({width:0},function(){r.hide()})},e=function(){var n=new $.Deferred;return $("section#content").animate({"margin-left":280},n.resolve),r.css("height",$(document).height()).show().animate({width:280},n.resolve),n.promise()},t=r.is(":visible");$("#drawer-menu").on("click",function(n){n.preventDefault();t?f():e();t=!t});$(document).on("keyup",function(n){n.ctrlKey&&n.keyCode===81&&(t?(f(),t=!1):e().done(function(){i.focus();t=!0}))});var s=$("div#slider-menu li"),i=$("#filter-text"),n=0,u=function(t){if(!t||!t.keyCode||t.keyCode!==40&&t.keyCode!==38&&t.keyCode!==13){n=0;var r=i.val().toLowerCase();s.each(function(){var n=$(this);typeof n.data("string")=="string"&&(n.data("string").toLowerCase().indexOf(r)>-1?n.show():n.hide())})}},h=function(t){var i=function(t){n+=t;var i=$("div#slider-menu li:visible");if(n<=0){n=1;return}if(n>i.length-1){n=i.length-1;return}i.removeClass("active");$(i[n]).addClass("active")};if(t&&t.keyCode){if(t.keyCode===40){i(1);return}if(t.keyCode===38){i(-1);return}if(t.keyCode===13){$("div#slider-menu li:visible.active").find("a").trigger("click");return}}},c=_.throttle(u,800);i.on("keyup",c).on("keyup",h).siblings("span").click(function(){i.val("");u()});i.val()&&u()},o=function(n){console.log(n);var i=String.format("Type eq '{0}' and EntityId eq {1}",n.entity,n.id()),t=new $.Deferred;return r.loadAsync("AuditTrail",i).then(function(n){f.auditTrailCollection(n.itemCollection);f.selectedAuditTrail(new bespoke.sph.domain.AuditTrail);t.resolve(!0);$("#shell-logviewer-modal").modal({})}),t.promise()},s=function(n){f.selectedAuditTrail(n)},h=function(n){var t=typeof n=="function"?n():n,i=new $.Deferred,r="/print/"+t.entity+"/"+t.id();return window.open(r),setTimeout(function(){i.resolve(!0)},500),i.promise()},f={activate:c,viewAttached:e,router:t,viewAuditTrailCommand:o,printCommand:h,auditTrailCollection:ko.observableArray(),selectedAuditTrail:ko.observable(new bespoke.sph.domain.AuditTrail),selectAuditTrail:s};return f});
//# sourceMappingURL=shell.min.js.map