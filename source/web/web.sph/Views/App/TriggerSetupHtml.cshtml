@using System.Web.Mvc.Html
@using Bespoke.Sph.Web.Models
@{
    Layout = null;
}

<h1>Trigger</h1>
<form class="form-horizontal" data-bind="with: trigger" role="form" style="clear: both">

    <div class="panel panel-primary">
        <div class="panel-heading">
            <strong>General options</strong>
        </div>
        <div class="panel-body">
            <div class="form-group">
                <label for="Name" class="col-lg-2 control-label">Name</label>
                <div class="col-lg-6">
                    <input required placeholder="Trigger's' name" class="form-control" data-bind="value: Name" id="Name" type="text" name="Name" />
                </div>
            </div>
            <div class="form-group">
                <label for="Entity" class="col-lg-2 control-label">Entity</label>
                <div class="col-lg-6">
                    <select required class="form-control" data-bind="value: Entity" id="Entity" name="Entity">
                        <option value="">[--SELECT TRIGGER ENTITY--]</option>
                        <option value="Land">Land</option>
                        <option value="Building">Building</option>
                        <option value="RentalApplication">Rental Application</option>
                        <option value="Deposit">Deposit</option>
                        <option value="Contract">Contract</option>
                        <option value="Space">Space</option>
                        <option value="Tenant">Tenant</option>
                        <option value="Invoice">Invoice</option>
                        <option value="Complaint">Complaint</option>
                        <option value="Maintenance">Maintenance</option>
                    </select>
                </div>
            </div>



            <div class="form-group">
                <label for="Note" class="col-lg-2 control-label">Note</label>
                <div class="col-lg-6">
                    <textarea class="form-control" data-bind="value: Note" id="Note" name="Note"></textarea>
                </div>
            </div>

            <div class="form-group">
                <label for="isActive" class="col-lg-2 control-label">State</label>
                <div class="col-lg-10">
                    <div class="checkbox">
                        <label>
                            <input data-bind="checked: IsActive" id="isActive" type="checkbox" name="IsActive" />
                            Active
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-lg-2 control-label">When</label>
                <div class="col-lg-10">
                    <div class="checkbox">
                        <label>
                            <input data-bind="checked: IsFiredOnAdded" id="fired-on-added" type="checkbox" name="IsFiredOnAdded" />
                            New item added
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <div class="col-lg-offset-2 col-lg-10">
                    <div class="checkbox">
                        <label>
                            <input data-bind="checked: IsFiredOnChanged" id="fired-on-changed" type="checkbox" name="IsFireOnChanged" />
                            When item has changed
                        </label>
                    </div>

                </div>
            </div>
            <div class="form-group">
                <div class="col-lg-offset-2 col-lg-10">
                    <div class="checkbox">
                        <label>
                            <input data-bind="checked: IsFiredOnDeleted" id="fire-on-deleted" type="checkbox" name="IsFireOnDeleted" />
                            When the item has been deleted
                        </label>
                    </div>

                </div>
            </div>

            <div class="form-group">
                <label for="fired-on-operations" class="control-label col-lg-2">Operation</label>
                <div class="col-lg-6">
                    <input class="form-control" data-bind="value: FiredOnOperations" id="fired-on-operations" type="text" name="FireOnOperations" />
                    <span class="help-block">When this operation is invoked. Use "," to add more than 1 operations</span>
                </div>
            </div>
        </div>
    </div>
    <h3>Rules</h3>
    <a href="#" class="pull-right" data-bind="click: addRule">+ Rule</a>
    <table id="rules-table" class="table table-striped">
        <thead>
            <tr>
                <th>Left</th>
                <th>Operator</th>
                <th>Right</th>
                <th></th>
            </tr>
        </thead>
        <tbody data-bind="foreach: RuleCollection">
            <tr>
                <td>
                    @Html.Partial("_TriggerFieldDropDown", new TypeModel { Path = "Left" })
                </td>
                <td>
                    <select name="rule-operator" class="form-control" data-bind="value: Operator">
                        <option value="Eq">=</option>
                        <option value="Le">&lt;=</option>
                        <option value="Lt">&lt;</option>
                        <option value="Ge">&gt;=</option>
                        <option value="Gt">&gt;</option>
                        <option value="Substringof">Substringof</option>
                        <option value="StartsWith">StartsWith</option>
                        <option value="EndsWith">EndsWith</option>
                    </select>
                </td>
                <td>
                    @Html.Partial("_TriggerFieldDropDown", new TypeModel { Path = "Right" })
                </td>
                <td>
                    <a rel="nofollow" href="#" data-bind="click : $parent.removeRule.call($parent,$data)">Buang</a>
                </td>
            </tr>
        </tbody>
    </table>

    <h3>Action</h3>
    <div id="action-panel" class="pull-right">
        <div class="btn-group">
            <a class="btn btn-link dropdown-toggle" data-toggle="drop-down">
                Add Action &nbsp;<span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li>
                    <a class="btn btn-link" data-bind="click: addAction('Email')">
                        <i class="fa fa-envelope"></i>
                        Add Email Action
                    </a>
                </li>
                <li>
                    <a class="btn btn-link" data-bind="click: addAction('Setter')">
                        <i class="fa fa-gear"></i>
                        Add Setter Action
                    </a>
                </li>

            </ul>
        </div>

    </div>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Title</th>
                <th>Note</th>
                <th>Is active</th>
                <th></th>
            </tr>
        </thead>
        <tbody data-bind="foreach: ActionCollection">
            <tr>
                <td>
                    <a type="button" class="btn btn-link" data-bind="click : $parent.editAction.call($parent,$data)" href="#">

                        <img data-bind="fieldImage : $type" class="pull-left" alt="." />
                        &nbsp;
                        <!-- ko text : Title -->
                        <!-- /ko -->
                    </a>
                </td>
                <td>
                    <input type="text" class="input-action-note form-control" data-bind="value: Note" />
                </td>
                <td>
                    <input class="input-action-isactive" data-bind="checked: IsActive" id="IsActive" type="checkbox" name="IsActive" />
                </td>
                <td>
                    <a class="btn btn-mini" rel="nofollow" href="#" data-bind="click: $parent.removeAction.call($parent,$data)">Buang</a>
                </td>
            </tr>
        </tbody>
    </table>
</form>
