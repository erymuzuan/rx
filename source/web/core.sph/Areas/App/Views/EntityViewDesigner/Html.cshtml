@using Bespoke.Sph.Web.Models
@{
    Layout = null;
}
<h2>View Designer</h2>
<div class="row">
    <form class="form-horizontal" data-bind="with : view">
        <div class="form-group">
            <label for="view-name" class="col-lg-2 control-label">Name</label>
            <div class="col-lg-6">
                <input type="text" data-bind="value: Name"
                       required pattern="^[A-Za-z_][A-Za-z0-9_ ]*$"
                       placeholder="Name for the view"
                       class="form-control" id="view-name">
            </div>
        </div>
        <div class="form-group">
            <label for="view-route" class="col-lg-2 control-label">Route</label>
            <div class="col-lg-6">
                <input type="text" data-bind="value: Route"
                       required pattern="^[A-Za-z_][A-Za-z0-9_-]*$"
                       placeholder="route url"
                       class="form-control" id="view-route">
            </div>
        </div>
    </form>
</div>
<div class="row" data-bind="with : view">

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Term</th>
                <th>Operator</th>
                <th>Value</th>
                <th></th>
            </tr>
        </thead>
        <tbody data-bind="foreach :FilterCollection">
            <tr>
                <td>
                    <input class="form-control" type="text" 
                           data-bind="value:Term,entityTypeaheadPath :$root.entity().EntityDefinitionId()" 
                           required pattern="^[A-Za-z][A-Za-z0-9_.]*$" />
                </td>
                <td>
                    <select name="rule-operator" class="form-control" data-bind="value: Operator">
                        <option value="Eq">=</option>
                        <option value="Le">&lt;=</option>
                        <option value="Lt">&lt;</option>
                        <option value="Ge">&gt;=</option>
                        <option value="Gt">&gt;</option>
                        <option value="Substringof">Substringof</option>
                        <option value="StartsWith">StartsWith</option>
                        <option value="EndsWith">EndsWith</option>
                    </select>
                </td>
                <td>                    @Html.Partial("_TriggerFieldDropDown", new TypeModel { Path = "Field" })
                <td>
                    <a href="#" data-bind="click : $parent.removeFilter.call($parent,$data)">
                        <span class="glyphicon glyphicon-remove"></span>
                    </a>
                </td>
            </tr>
        </tbody>
    </table>
    <button class="btn btn-default" data-bind="click : addFilter">+ Filter</button>
</div>
<div class="row" data-bind="with : view">

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Path</th>
                <th>Header</th>
                <th></th>
            </tr>
        </thead>
        <tbody data-bind="foreach :ViewColumnCollection">
            <tr>
                <td>
                    <input class="form-control" type="text" data-bind="value:Path,entityTypeaheadPath :$root.entity().EntityDefinitionId()" required pattern="^[A-Za-z][A-Za-z0-9_.]*$" />
                </td>
                <td>
                    <input class="form-control" type="text" data-bind="value:Header" required />
                <td>
                    <a href="#" data-bind="click : $parent.removeViewColumn.call($parent,$data)">
                        <span class="glyphicon glyphicon-remove"></span>
                    </a>
                </td>
            </tr>
        </tbody>
    </table>
    <button class="btn btn-default" data-bind="click : addViewColumn">+ Column</button>
</div>