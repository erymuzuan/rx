ko.bindingHandlers.kendoEditor={init:function(n,t){var u=$(n),r=t(),i=!1;setTimeout(function(){var n=u.kendoEditor({change:function(){i||(i=!0,r(this.value()),setTimeout(function(){i=!1},500))}}).data("kendoEditor");n.value(r());r.subscribe(function(t){i||(i=!0,n.value(t),setTimeout(function(){i=!1},500))})},500)},update2:function(n,t){var i=$(n),r=t(),u=i.data("kendoEditor");i.data("updating")||u.value(r())}};ko.bindingHandlers.kendoDropDownListValue={init:function(n,t){var r=t(),u=ko.utils.unwrapObservable(r),i=$(n).data("kendoDropDownList");i.value(u);i.bind("change",function(){var n=i.value();r(n)})},update:function(n,t){var r=t(),i=ko.utils.unwrapObservable(r);i&&$(n).data("kendoDropDownList").value(i)}};ko.bindingHandlers.source={};ko.bindingHandlers.kendoComboBox={init:function(n,t,i){var u=t(),f=i(),e=ko.utils.unwrapObservable(u),r=$(n).data("kendoComboBox")||$(n).kendoComboBox({dataSource:f.source()}).data("kendoComboBox");r.value(e);f.source.subscribe(function(n){r.dataSource.data(n)});r.bind("change",function(){var n=r.value();u(n)})},update:function(n,t){var r=t(),i=ko.utils.unwrapObservable(r);i&&$(n).data("kendoComboBox").value(i)}};ko.bindingHandlers.decimal={};ko.bindingHandlers.money={init:function(n,t,i){var u=t(),f=i(),o=function(){return typeof f.decimal=="undefined"?2:parseInt(f.decimal)},r=$(n),s=parseFloat(ko.unwrap(u)||"0"),e=s.toFixed(o()).replace(/./g,function(n,t,i){return t&&n!=="."&&!((i.length-t)%3)?","+n:n});if(n.tagName.toLowerCase()==="span"){r.text(e);return}r.val(e);r.on("blur",function(){var n=$(this).val().replace(/,/g,"");console.log(n);u(parseFloat(n))})},update:function(n,t,i){var u=t(),r=i(),f=function(){return typeof r.decimal=="undefined"?2:parseInt(r.decimal)},e=$(n),o=parseFloat(ko.unwrap(u)||"0"),s=o.toFixed(f()).replace(/./g,function(n,t,i){return t&&n!=="."&&!((i.length-t)%3)?","+n:n});e.val(s)}};ko.bindingHandlers.date={init:function(n,t){var i=ko.utils.unwrapObservable(t()),r=ko.unwrap(i.value),u=moment(r),e=ko.unwrap(i.invalid)||"invalid date",o=ko.unwrap(i.format)||"DD/MM/YYYY",f;i.format||typeof ko.unwrap(i)!="string"||(r=ko.unwrap(i),u=moment(r));$(n).on("change",function(){var n=$(this).val();i.value(n)});if(!r){$(n).text(e);$(n).val(e);return}if(!u){$(n).text("");$(n).val("");return}if(u.year()==1){$(n).text("");$(n).val("");return}f=u.format(o).toString();f.indexOf("NaN")<0&&($(n).text(f),$(n).val(f))},update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=ko.unwrap(i.value),u=moment(r),e=ko.unwrap(i.invalid)||"invalid date",o=ko.unwrap(i.format)||"DD/MM/YYYY",f;i.format||typeof ko.unwrap(i)!="string"||(r=ko.unwrap(i),u=moment(r));$(n).on("change",function(){var n=$(this).val();i.value(n)});if(!r){$(n).text(e);$(n).val(e);return}if(!u){$(n).text("");$(n).val("");return}if(u.year()==1){$(n).text("");$(n).val("");return}f=u.format(o).toString();f.indexOf("NaN")<0&&($(n).text(f),$(n).val(f))}};ko.bindingHandlers.kendoUpload={init:function(n,t){var e=require(objectbuilders.datacontext),u=require(objectbuilders.logger),i=t(),f=t(),r=[];typeof f=="object"&&(i=f.value,r=f.extensions);$(n).attr("name","files").kendoUpload({async:{saveUrl:"/BinaryStore/Upload",removeUrl:"/BinaryStore/Remove",autoUpload:!0},multiple:!1,error:function(n){u.logError(n,n,this,!0)},select:function(n){r.length!==0&&_(n.files).each(function(t){r.indexOf(t.extension)<0&&(u.error("Only "+r.join(",")+" files can be uploaded"),n.preventDefault())})},success:function(n){u.info("Your file has been "+n.operation);var r=n.response.storeId,f=n.operation==="upload",o=n.operation!="upload",t=i();f&&(i(r),t&&e.post(JSON.stringify({id:t}),"/BinaryStore/Remove/"));o&&i("")},remove:function(){var n=new $.Deferred,t=JSON.stringify({id:i()});return e.post(t,"/BinaryStore/Remove/").then(function(t){n.resolve(t)}),n.promise()}})}};ko.bindingHandlers.kendoDate={init:function(n,t,i){var e=t(),o=$(n),u=i(),s=ko.unwrap(e),r=moment(s),h=function(n){console.log(n);var t=this.value();r=typeof t=="string"?moment(t,"DD/MM/YYYY"):moment(t);o.data("stop","true");e(r.format("YYYY-MM-DD"));o.data("stop","false")},f=o.kendoDatePicker({format:"dd/MM/yyyy",change:h}).data("kendoDatePicker");if(typeof u.enable=="boolean"&&(u.enable||f.enable(!1)),typeof u.enable=="function"&&typeof u.enable.subscribe=="function"&&u.enable.subscribe(function(n){f.enable(n)}),!r){f.value(null);return}if(r.year()===1){f.value(null);return}f.value(r.toDate());typeof s=="undefined"&&typeof e=="function"&&e(r.format("YYYY-MM-DD"))},update:function(n,t,i){var e=$(n),r=i();if(e.data("stop")!="true"){var o=t(),s=ko.utils.unwrapObservable(o),f=moment(s),u=e.data("kendoDatePicker");if(!f){u.value(null);return}if(f.year()==1){u.value(null);return}typeof r.enable=="boolean"&&(r.enable||u.enable(!1));typeof r.enable=="function"&&typeof r.enable.subscribe=="function"&&r.enable.subscribe(function(n){u.enable(n)});u.value(f.toDate())}}};ko.bindingHandlers.kendoDateTime={init:function(n,t){var f=t(),r=$(n),e=ko.utils.unwrapObservable(f),i=moment(e),o=function(n){console.log(n);var t=this.value();i=typeof t=="string"?moment(t,"DD/MM/YYYY hh:mm"):moment(t);r.data("stop","true");f(i.format());r.data("stop","false")},u=r.kendoDateTimePicker({format:"dd/MM/yyyy HH:mm",change:o}).data("kendoDateTimePicker");if(!i){u.value(null);return}if(i.year()===1){u.value(null);return}u.value(i.toDate())},update:function(n,t){var u=$(n);if(u.data("stop")!="true"){var f=t(),e=ko.utils.unwrapObservable(f),i=moment(e),r=u.data("kendoDateTimePicker");if(!i){r.value(null);return}if(i.year()==1){r.value(null);return}r.value(i.toDate())}}};ko.bindingHandlers.slideVisible={init:function(n,t){var i=t();$(n).toggle(ko.utils.unwrapObservable(i))},update:function(n,t){var i=t();ko.utils.unwrapObservable(i)?$(n).slideDown():$(n).slideUp()}};ko.bindingHandlers.kendoEnable={init:function(n,t){var i=t(),r=ko.utils.unwrapObservable(i);r?$(n).removeClass("k-state-disabled"):$(n).addClass("k-state-disabled")},update:function(n,t){var i=t(),r=ko.utils.unwrapObservable(i);r?($(n).removeClass("k-state-disabled"),$(n).removeAttr("disabled")):($(n).addClass("k-state-disabled"),$(n).attr("disabled","disabled"))}};ko.bindingHandlers.command={init:function(n,t,i){var o=t(),r=$(n),u=i(),s=r.val(),e,f;u.isvisible&&(e=typeof u.isvisible=="function"?u.isvisible():u.isvisible,e?r.show():r.hide(),typeof u.isvisible=="function"&&u.isvisible.subscribe(function(n){n?r.show():r.hide()}));f=$("<i class='fa fa-spin fa-spinner'><\/i>").hide();r.append(f);r.click(function(n){(n.preventDefault(),!this.form||this.form.checkValidity())&&(f.show(),o().then(function(){r.button("complete").prop("disabled",!1).val(s).removeClass("btn-disabled");f.hide()}),r.data("loading-text")&&r.button("loading"),r.addClass("btn-disabled").prop("disabled",!0))})}};ko.bindingHandlers.field={init:function(){}};ko.bindingHandlers.unwrapClick={init:function(n,t,i){var u=t(),f=$(n),r=i();f.click(function(n){n.preventDefault();var t=r.property,i=r.accessor,f=r.field,e=r.entity;t?(typeof i[t]=="undefined"&&console.log("Can't figure out the accessor.prop"),typeof i[t]=="object"&&(i[t]=ko.observable(i[t])),typeof i[t]=="function"&&u(i[t],f,e)):u(i,f,e)})}};ko.bindingHandlers.fieldImage={init:function(n,t){var i=t(),r=$(n),u=typeof i=="function"?i():i;r.attr("src","/image/index/"+u)}};ko.bindingHandlers.stringArrayAutoComplete={init:function(n,t,i){var r=t(),u=i(),f=u.data();$(n).data("kendoAutoComplete")||$(n).kendoAutoComplete({dataSource:f,change:function(){var n=_(this.value().split(",")).filter(function(n){return n});r(n)},filter:"startswith",placeholder:"....",separator:","}).val(r())},update:function(n,t){var i=t();$(n).data("kendoAutoComplete").value(i())}};ko.bindingHandlers.pathAutoComplete={init:function(n,t){var r=t(),i=r.value,u=r.type;u()&&$.get("/App/TriggerPathPickerJson/"+u()).done(function(t){var r=JSON.parse(t),u=_.chain(r).map(function(n){return n.parent===""?n.name:undefined}).filter(function(n){return typeof n!="undefined"}).value(),f,e;console.log(u);f=new kendo.data.DataSource({data:u});e=$(n).data("kendoAutoComplete")||$(n).kendoAutoComplete({dataSource:r,dataTextField:"path",change:function(){var n=this.value();console.log("selected path ",n)},filter:"startswith",placeholder:"Select path...",separator:""}).data("kendoAutoComplete");$(n).change(function(){i($(this).val());console.log("new value",i())}).val(i()).on("keydown3",function(n){var t,i;(n.which===110||n.which===190)&&(t=$(this).val()+".",console.log("show the auto complete",t),i=_.chain(r).filter(function(n){return n.parent===t}).map(function(n){return n.name}).value(),console.log(i),f.data(i),e.refresh())})})}};ko.bindingHandlers.commandWithParameter={init:function(n,t){var r=t(),f=r.command,e=r.commandParameter,i=$(n),u=i.data("complete-text")||i.html();i.click(function(n){n.preventDefault();f(e).then(function(){i.button("complete");i.get(0).tagName=="BUTTON"||i.get(0).tagName=="A"?i.html(u):i.val(u)});i.data("loading-text")&&i.button("loading")})}};ko.bindingHandlers.filter={init:function(n,t,i){var f=t(),l=i(),a=f.path,v=f.tooltip||"Type to filter current page or type and [ENTER] to search the whole view",s=typeof f.offset=="undefined"?8:parseInt(f.offset),y="col-md-"+(12-s),p="col-md-offset-"+s,h=$(n),r=$("<input data-toggle='tooltip' title='"+v+"' type='search' class='search-query input-medium form-control' placeholder='Filter.. '>"),w=$("<a href='/#' title='Carian server'><i class='add-on icon-search'><\/i><a>"),e=$("<form class='form-search "+y+" "+p+"'> <div class='input-group pull-right'><span class='input-group-addon'> <span class='glyphicon glyphicon-remove'><\/span><\/span> <\/div> <\/form>"),u=l.searchPaging,o,c;e.find("span.input-group-addon").before(r);u&&e.find("span.glyphicon-remove").after(w);h.before(e);e.submit(function(n){n.preventDefault();var t=r.val().toLowerCase(),i=new $.Deferred;return t?u&&typeof u.query!="undefined"&&typeof u.query.filterAndSearch=="function"?u.query.filterAndSearch(t):i.promise():i.promise()});o=function(){var n=h.find(a),t=r.val().toLowerCase();n.each(function(){var n=$(this);n.text().toLowerCase().indexOf(t)>-1?n.show():n.hide()})};c=_.throttle(o,800);r.on("keyup",c).siblings("span.input-group-addon").click(function(){r.val("");o()});r.val()&&o();r.tooltip()}};ko.bindingHandlers.serverPaging={init:function(n,t,i,r){var u=t(),h=u.entity,c=u.query,f=u.list,l=u.map,w=u.pagerHidden||!1,e=$(n),a=require("services/datacontext"),v=$("<div><\/div>"),o=$('<img src="/Images/spinner-md.gif" alt="loading" class="absolute-center" />'),b=function(){o.show();e.fadeTo("fast",.33)},y=function(){o.hide();e.fadeTo("fast",1)},p=function(n){l&&(n=_(n).map(l));typeof f=="string"&&r[f](n);typeof f=="function"&&f(n)},k=function(n,t){b();a.loadAsync({entity:h,page:n,size:t,includeTotal:!0},c).then(function(n){p(n.itemCollection);y()})},s;return e.after(v).after(o).fadeTo("slow",.33),s=new $.Deferred,a.loadAsync({entity:h,page:1,size:20,includeTotal:!0},c).then(function(n){var t={element:v,count:n.rows,changed:k,hidden:w},i=new bespoke.utils.ServerPager(t);console.log(i);setTimeout(function(){p(n.itemCollection);s.resolve(!0);y()},500)}),s.promise()}};ko.bindingHandlers.searchPaging={init:function(n,t,i,r){var u=t(),a=u.entity,s=u.query,h=u.query||u.initialQuery||{},o=u.list,v=u.map,y=u.pagerHidden||!1,p=u.searchButton,c=$(n),w=require("services/datacontext"),tt=require("services/logger"),it=require(objectbuilders.cultures),b=$("<div><\/div>"),l=$('<img src="/Images/spinner-md.gif" alt="loading" class="absolute-center" />'),k=function(){l.show();c.fadeTo("fast",.33)},d=function(){l.hide();c.fadeTo("fast",1)},g=function(n){y||_(n).each(function(n){n.pager={page:f.page(),size:f.pageSize()}});v&&(n=_(n).map(v));typeof o=="string"&&r[o](n);typeof o=="function"&&o(n)},f=null,rt=function(n,t){k();w.searchAsync({entity:a,page:n,size:t},h).then(function(n){g(n.itemCollection);d()})},e=function(n,t,i){h=n;var r=new $.Deferred;return k(),w.searchAsync({entity:a,page:t||1,size:i||20},n).then(function(n){if(f)f.update(n.rows);else{var t={element:b,count:n.rows,changed:rt,hidden:y};f=new bespoke.utils.ServerPager(t)}setTimeout(function(){g(n.itemCollection);r.resolve(n);d()},500)}),r.promise()},nt=function(n){var i=JSON.parse(ko.toJSON(u.query||u.initialQuery)),t={from:0,size:20,query:{}};t.query.filtered=i.query.filtered;t.query.filtered.query={query_string:{default_field:"_all",query:n}};t.sort=i.sort;f.destroy();f=null;e(t)};if(s.search=e,s.filterAndSearch=nt,c.after(b).after(l).fadeTo("slow",.33),p)$(document).on("click",p,function(n){if(n.preventDefault(),!$(this).parents("form")[0].checkValidity()){tt.error(it.messages.FORM_IS_NOT_VALID);return}e(ko.toJS(s),1,f.pageSize())});return e(ko.toJS(h)),{search:e,filterAndSearch:nt}}};
/*
//# sourceMappingURL=_ko.kendo.min.js.map
*/