ko.bindingHandlers.kendoEditor={init:function(n,t){var u=$(n),r=t(),i=!1;setTimeout(function(){var n=u.kendoEditor({change:function(){i||(i=!0,r(this.value()),setTimeout(function(){i=!1},500))}}).data("kendoEditor");n.value(r());r.subscribe(function(t){i||(i=!0,n.value(t),setTimeout(function(){i=!1},500))})},500)},update2:function(n,t){var i=$(n),r=t(),u=i.data("kendoEditor");i.data("updating")||u.value(r())}};ko.bindingHandlers.kendoDropDownListValue={init:function(n,t){var r=t(),u=ko.utils.unwrapObservable(r),i=$(n).data("kendoDropDownList");i.value(u);i.bind("change",function(){var n=i.value();r(n)})},update:function(n,t){var r=t(),i=ko.utils.unwrapObservable(r);i&&$(n).data("kendoDropDownList").value(i)}};ko.bindingHandlers.source={};ko.bindingHandlers.kendoComboBox={init:function(n,t,i){var u=t(),f=i(),e=ko.utils.unwrapObservable(u),r=$(n).data("kendoComboBox")||$(n).kendoComboBox({dataSource:f.source()}).data("kendoComboBox");r.value(e);f.source.subscribe(function(n){r.dataSource.data(n)});r.bind("change",function(){var n=r.value();u(n)})},update:function(n,t){var r=t(),i=ko.utils.unwrapObservable(r);i&&$(n).data("kendoComboBox").value(i)}};ko.bindingHandlers.money={init:function(n,t){var i=ko.utils.unwrapObservable(t()),r=parseFloat(i).toFixed(2);$(n).text(r);$(n).val(r);$(n).on("change",function(){var n=$(this).val();i.text(n)})},update:function(n,t){var r=ko.utils.unwrapObservable(t()),i=parseFloat(r).toFixed(2);$(n).text(i);$(n).val(i)}};ko.bindingHandlers.date={init:function(n,t){var i=ko.utils.unwrapObservable(t()),r=ko.unwrap(i.value),u=moment(r),e=ko.unwrap(i.invalid)||"invalid date",o=ko.unwrap(i.format)||"DD/MM/YYYY",f;i.format||typeof ko.unwrap(i)!="string"||(r=ko.unwrap(i),u=moment(r));$(n).on("change",function(){var n=$(this).val();i.value(n)});if(!r){$(n).text(e);$(n).val(e);return}if(!u){$(n).text("");$(n).val("");return}if(u.year()==1){$(n).text("");$(n).val("");return}f=u.format(o).toString();f.indexOf("NaN")<0&&($(n).text(f),$(n).val(f))}};ko.bindingHandlers.kendoUpload={init:function(n,t){var r=require(objectbuilders.datacontext),u=require(objectbuilders.logger),i=t();$(n).attr("name","files").kendoUpload({async:{saveUrl:"/BinaryStore/Upload",removeUrl:"/BinaryStore/Remove",autoUpload:!0},multiple:!1,error:function(n){u.logError(n,n,this,!0)},success:function(n){u.info("Your file has been "+n.operation);var f=n.response.storeId,e=n.operation==="upload",o=n.operation!="upload",t=i();e&&(i(f),t&&r.post(JSON.stringify({id:t}),"/BinaryStore/Remove/"));o&&i("")},remove:function(){var n=new $.Deferred,t=JSON.stringify({id:i()});return r.post(t,"/BinaryStore/Remove/").then(function(t){n.resolve(t)}),n.promise()}})}};ko.bindingHandlers.kendoDate={init:function(n,t){var f=t(),r=$(n),e=ko.utils.unwrapObservable(f),i=moment(e),o=function(n){console.log(n);var t=this.value();i=typeof t=="string"?moment(t,"DD/MM/YYYY"):moment(t);r.data("stop","true");f(i.format("YYYY-MM-DD"));r.data("stop","false")},u=r.kendoDatePicker({format:"dd/MM/yyyy",change:o}).data("kendoDatePicker");if(!i){u.value(null);return}if(i.year()===1){u.value(null);return}u.value(i.toDate())},update:function(n,t){var u=$(n);if(u.data("stop")!="true"){var f=t(),e=ko.utils.unwrapObservable(f),i=moment(e),r=u.data("kendoDatePicker");if(!i){r.value(null);return}if(i.year()==1){r.value(null);return}r.value(i.toDate())}}};ko.bindingHandlers.kendoDateTime={init:function(n,t){var f=t(),r=$(n),e=ko.utils.unwrapObservable(f),i=moment(e),o=function(n){console.log(n);var t=this.value();i=typeof t=="string"?moment(t,"DD/MM/YYYY hh:mm"):moment(t);r.data("stop","true");f(i.format());r.data("stop","false")},u=r.kendoDateTimePicker({format:"dd/MM/yyyy HH:mm",change:o}).data("kendoDateTimePicker");if(!i){u.value(null);return}if(i.year()===1){u.value(null);return}u.value(i.toDate())},update:function(n,t){var u=$(n);if(u.data("stop")!="true"){var f=t(),e=ko.utils.unwrapObservable(f),i=moment(e),r=u.data("kendoDateTimePicker");if(!i){r.value(null);return}if(i.year()==1){r.value(null);return}r.value(i.toDate())}}};ko.bindingHandlers.slideVisible={init:function(n,t){var i=t();$(n).toggle(ko.utils.unwrapObservable(i))},update:function(n,t){var i=t();ko.utils.unwrapObservable(i)?$(n).slideDown():$(n).slideUp()}};ko.bindingHandlers.kendoEnable={init:function(n,t){var i=t(),r=ko.utils.unwrapObservable(i);r?$(n).removeClass("k-state-disabled"):$(n).addClass("k-state-disabled")},update:function(n,t){var i=t(),r=ko.utils.unwrapObservable(i);r?($(n).removeClass("k-state-disabled"),$(n).removeAttr("disabled")):($(n).addClass("k-state-disabled"),$(n).attr("disabled","disabled"))}};ko.bindingHandlers.command={init:function(n,t,i){var e=t(),r=$(n),u=i(),o=r.val(),f;u.isvisible&&(f=typeof u.isvisible=="function"?u.isvisible():u.isvisible,f?r.show():r.hide(),typeof u.isvisible=="function"&&u.isvisible.subscribe(function(n){n?r.show():r.hide()}));r.click(function(n){if(n.preventDefault(),!this.form||this.form.checkValidity()){var t=$("<i class='icon-spin icon-spinner icon-large'><\/i>");t.css({"margin-left":-(r.width()/2)-16,position:"fixed","margin-top":"10px"});r.after(t).show();e().then(function(){r.button("complete").prop("disabled",!0).val(o).removeClass("btn-disabled");t.hide()});r.data("loading-text")&&r.button("loading");r.addClass("btn-disabled").prop("disabled",!0)}})}};ko.bindingHandlers.field={init:function(){}};ko.bindingHandlers.unwrapClick={init:function(n,t,i){var u=t(),f=$(n),r=i();f.click(function(n){n.preventDefault();var t=r.property,i=r.accessor,f=r.field;t?(typeof i[t]=="undefined"&&console.log("Can't figure out the accessor.prop"),typeof i[t]=="object"&&(i[t]=ko.observable(i[t])),typeof i[t]=="function"&&u(i[t],f)):u(i,f)})}};ko.bindingHandlers.fieldImage={init:function(n,t){var i=t(),r=$(n),u=typeof i=="function"?i():i;r.attr("src","/image/index/"+u)}};ko.bindingHandlers.stringArrayAutoComplete={init:function(n,t,i){var r=t(),u=i(),f=u.data();$(n).data("kendoAutoComplete")||$(n).kendoAutoComplete({dataSource:f,change:function(){var n=_(this.value().split(",")).filter(function(n){return n});r(n)},filter:"startswith",placeholder:"....",separator:","}).val(r())},update:function(n,t){var i=t();$(n).data("kendoAutoComplete").value(i())}};ko.bindingHandlers.pathAutoComplete={init:function(n,t){var r=t(),i=r.value,u=r.type;u()&&$.get("/App/TriggerPathPickerJson/"+u()).done(function(t){var r=JSON.parse(t),u=_.chain(r).map(function(n){return n.parent===""?n.name:undefined}).filter(function(n){return typeof n!="undefined"}).value(),f,e;console.log(u);f=new kendo.data.DataSource({data:u});e=$(n).data("kendoAutoComplete")||$(n).kendoAutoComplete({dataSource:r,dataTextField:"path",change:function(){var n=this.value();console.log("selected path ",n)},filter:"startswith",placeholder:"Select path...",separator:""}).data("kendoAutoComplete");$(n).change(function(){i($(this).val());console.log("new value",i())}).val(i()).on("keydown3",function(n){var t,i;(n.which===110||n.which===190)&&(t=$(this).val()+".",console.log("show the auto complete",t),i=_.chain(r).filter(function(n){return n.parent===t}).map(function(n){return n.name}).value(),console.log(i),f.data(i),e.refresh())})})}};ko.bindingHandlers.commandWithParameter={init:function(n,t){var r=t(),f=r.command,e=r.commandParameter,i=$(n),u=i.data("complete-text")||i.html();i.click(function(n){n.preventDefault();f(e).then(function(){i.button("complete");i.get(0).tagName=="BUTTON"||i.get(0).tagName=="A"?i.html(u):i.val(u)});i.data("loading-text")&&i.button("loading")})}};ko.bindingHandlers.filter={init:function(n,t,i){var c=t(),l=i(),a=c.path,o=$(n),r=$("<input type='search' class='search-query input-medium form-control' placeholder='Filter..'>"),s=$("<a href='/#' title='Carian server'><i class='add-on icon-search'><\/i><a>"),e=$("<form class='form-search col-lg-4 col-lg-offset-8'> <div class='input-group pull-right'><span class='input-group-addon'> <span class='glyphicon glyphicon-remove'><\/span><\/span> <\/div> <\/form>"),u=l.searchPaging,f,h;e.find("span.input-group-addon").before(r);u&&e.find("span.glyphicon-remove").after(s);o.before(e);s.click(function(n){var i,t,f;return(n.preventDefault(),i=r.val().toLowerCase(),t=new $.Deferred,!i)?(t.promise(),t.promise()):u?(f={query:{bool:{must:[{query_string:{query:i}}]}}},u.query=f,u.search(f)):t.promise()});f=function(){var n=o.find(a),t=r.val().toLowerCase();n.each(function(){var n=$(this);n.text().toLowerCase().indexOf(t)>-1?n.show():n.hide()})};h=_.throttle(f,800);r.on("keyup",h).siblings("span.input-group-addon").click(function(){r.val("");f()});r.val()&&f()}};ko.bindingHandlers.serverPaging={init:function(n,t,i,r){var u=t(),h=u.entity,c=u.query,f=u.list,l=u.map,w=u.pagerHidden||!1,e=$(n),a=require("services/datacontext"),v=$("<div><\/div>"),o=$('<img src="/Images/spinner-md.gif" alt="loading" class="absolute-center" />'),b=function(){o.show();e.fadeTo("fast",.33)},y=function(){o.hide();e.fadeTo("fast",1)},p=function(n){l&&(n=_(n).map(l));typeof f=="string"&&r[f](n);typeof f=="function"&&f(n)},k=function(n,t){b();a.loadAsync({entity:h,page:n,size:t,includeTotal:!0},c).then(function(n){p(n.itemCollection);y()})},s;return e.after(v).after(o).fadeTo("slow",.33),s=new $.Deferred,a.loadAsync({entity:h,page:1,size:20,includeTotal:!0},c).then(function(n){var t={element:v,count:n.rows,changed:k,hidden:w},i=new bespoke.utils.ServerPager(t);console.log(i);setTimeout(function(){p(n.itemCollection);s.resolve(!0);y()},500)}),s.promise()}};ko.bindingHandlers.searchPaging={init:function(n,t,i,r){var u=t(),l=u.entity,g=u.query,s=u.initialQuery||{},e=u.list,a=u.map,v=u.pagerHidden||!1,y=u.searchButton,h=$(n),p=require("services/datacontext"),nt=require("services/logger"),tt=require(objectbuilders.cultures),w=$("<div><\/div>"),c=$('<img src="/Images/spinner-md.gif" alt="loading" class="absolute-center" />'),b=function(){c.show();h.fadeTo("fast",.33)},k=function(){c.hide();h.fadeTo("fast",1)},d=function(n){v||_(n).each(function(n){n.pager={page:f.page(),size:f.pageSize()}});a&&(n=_(n).map(a));typeof e=="string"&&r[e](n);typeof e=="function"&&e(n)},f=null,it=function(n,t){b();p.searchAsync({entity:l,page:n,size:t},s).then(function(n){d(n.itemCollection);k()})},o=function(n,t,i){s=n;var r=new $.Deferred;return b(),p.searchAsync({entity:l,page:t||1,size:i||20},n).then(function(n){if(f)f.update(n.rows);else{var t={element:w,count:n.rows,changed:it,hidden:v};f=new bespoke.utils.ServerPager(t)}setTimeout(function(){d(n.itemCollection);r.resolve(n);k()},500)}),r.promise()};if(u.search=o,h.after(w).after(c).fadeTo("slow",.33),y)$(document).on("click",y,function(n){if(n.preventDefault(),!$(this).parents("form")[0].checkValidity()){nt.error(tt.messages.FORM_IS_NOT_VALID);return}o(ko.toJS(g),1,f.pageSize())});return o(ko.toJS(s)),{search:o}}};
/*
//# sourceMappingURL=_ko.kendo.min.js.map
*/