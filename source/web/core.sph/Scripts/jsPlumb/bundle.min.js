(function(n){function t(n,t){if(!(n.originalEvent.touches.length>1)){n.preventDefault();var i=n.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null);n.target.dispatchEvent(r)}}if(n.support.touch="ontouchend"in document,n.support.touch){var i=n.ui.mouse.prototype,u=i._mouseInit,r;i._touchStart=function(n){var i=this;!r&&i._mouseCapture(n.originalEvent.changedTouches[0])&&(r=!0,i._touchMoved=!1,t(n,"mouseover"),t(n,"mousemove"),t(n,"mousedown"))};i._touchMove=function(n){r&&(this._touchMoved=!0,t(n,"mousemove"))};i._touchEnd=function(n){r&&(t(n,"mouseup"),t(n,"mouseout"),this._touchMoved||t(n,"click"),r=!1)};i._mouseInit=function(){var t=this;t.element.bind("touchstart",n.proxy(t,"_touchStart")).bind("touchmove",n.proxy(t,"_touchMove")).bind("touchend",n.proxy(t,"_touchEnd"));u.call(t)}}})(jQuery),function(){var n=function(n){return Object.prototype.toString.call(n)==="[object Array]"},e=function(n){return Object.prototype.toString.call(n)==="[object Number]"},i=function(n){return typeof n=="string"},r=function(n){return typeof n=="boolean"},o=function(n){return n==null},t=function(n){return n==null?!1:Object.prototype.toString.call(n)==="[object Object]"},u=function(n){return Object.prototype.toString.call(n)==="[object Date]"},f=function(n){return Object.prototype.toString.call(n)==="[object Function]"},s=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},h=function(t,i,r){return t=n(t)?t:[t.x,t.y],i=n(i)?i:[i.x,i.y],r(t,i)};jsPlumbUtil={isArray:n,isString:i,isBoolean:r,isNull:o,isObject:t,isDate:u,isFunction:f,isEmpty:s,isNumber:e,clone:function(e){var s,o,h,c;if(i(e))return""+e;if(r(e))return!!e;if(u(e))return new Date(e.getTime());if(f(e))return e;if(n(e)){for(s=[],o=0;o<e.length;o++)s.push(this.clone(e[o]));return s}if(t(e)){h={};for(c in e)h[c]=this.clone(e[c]);return h}return e},merge:function(u,f){var o=this.clone(u),e,s,h;for(e in f)if(o[e]==null||i(f[e])||r(f[e]))o[e]=f[e];else if(n(f[e]))s=[],n(o[e])&&s.push.apply(s,o[e]),s.push.apply(s,f[e]),o[e]=s;else if(t(f[e])){t(o[e])||(o[e]={});for(h in f[e])o[e][h]=f[e][h]}return o},copyValues:function(n,t,i){for(var r=0;r<n.length;r++)i[n[r]]=t[n[r]]},functionChain:function(n,t,i){for(var u,r=0;r<i.length;r++)if(u=i[r][0][i[r][1]].apply(i[r][0],i[r][2]),u===t)return u;return n},populate:function(r,u){var e=function(n){var i=n.match(/(\${.*?})/g),t,r;if(i!=null)for(t=0;t<i.length;t++)r=u[i[t].substring(2,i[t].length-1)],r!=null&&(n=n.replace(i[t],r));return n},f=function(r){var o,u,s,h;if(r!=null){if(i(r))return e(r);if(n(r)){for(o=[],u=0;u<r.length;u++)o.push(f(r[u]));return o}if(t(r)){s={};for(h in r)s[h]=f(r[h]);return s}return r}};return f(r)},convertStyle:function(n,t){var i;if("transparent"===n)return n;var r=n,e=function(n){return n.length==1?"0"+n:n},u=function(n){return e(Number(n).toString(16))},f=/(rgb[a]?\()(.*)(\))/;return n.match(f)&&(i=n.match(f)[2].split(","),r="#"+u(i[0])+u(i[1])+u(i[2]),t||i.length!=4||(r=r+u(i[3]))),r},findWithFunction:function(n,t){if(n)for(var i=0;i<n.length;i++)if(t(n[i]))return i;return-1},clampToGrid:function(n,t,i,r,u){var f=function(n,t){var i=n%t,r=Math.floor(n/t),u=i>=t/2?1:0;return(r+u)*t};return[r||i==null?n:f(n,i[0]),u||i==null?t:f(t,i[1])]},indexOf:function(n,t){return jsPlumbUtil.findWithFunction(n,function(n){return n==t})},removeWithFunction:function(n,t){var i=jsPlumbUtil.findWithFunction(n,t);return i>-1&&n.splice(i,1),i!=-1},remove:function(n,t){var i=jsPlumbUtil.indexOf(n,t);return i>-1&&n.splice(i,1),i!=-1},addWithFunction:function(n,t,i){jsPlumbUtil.findWithFunction(n,i)==-1&&n.push(t)},addToList:function(n,t,i,r){var u=n[t];return u==null&&(u=[],n[t]=u),u[r?"unshift":"push"](i),u},extend:function(t,i,r,u){var f,e,s,o;for(r=r||{},u=u||{},i=n(i)?i:[i],f=0;f<i.length;f++)for(e in i[f].prototype)i[f].prototype.hasOwnProperty(e)&&(t.prototype[e]=i[f].prototype[e]);s=function(n){return function(){for(var t=0;t<i.length;t++)i[t].prototype[n]&&i[t].prototype[n].apply(this,arguments);return r[n].apply(this,arguments)}};for(o in r)t.prototype[o]=s(o);return t},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&typeof console!="undefined")try{var n=arguments[arguments.length-1];console.log(n)}catch(t){}},group:function(n){jsPlumbUtil.logEnabled&&typeof console!="undefined"&&console.group(n)},groupEnd:function(n){jsPlumbUtil.logEnabled&&typeof console!="undefined"&&console.groupEnd(n)},time:function(n){jsPlumbUtil.logEnabled&&typeof console!="undefined"&&console.time(n)},timeEnd:function(n){jsPlumbUtil.logEnabled&&typeof console!="undefined"&&console.timeEnd(n)},removeElement:function(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)},removeElements:function(n){for(var t=0;t<n.length;t++)jsPlumbUtil.removeElement(n[t])},sizeElement:function(n,t,i,r,u){n&&(n.style.height=u+"px",n.height=u,n.style.width=r+"px",n.width=r,n.style.left=t+"px",n.style.top=i+"px")},wrap:function(n,t,i){return n=n||function(){},t=t||function(){},function(){var r=null;try{r=t.apply(this,arguments)}catch(u){jsPlumbUtil.log("jsPlumb function failed : "+u)}if(i==null||r!==i)try{r=n.apply(this,arguments)}catch(u){jsPlumbUtil.log("wrapped function failed : "+u)}return r}}};jsPlumbUtil.EventGenerator=function(){var n={},t=!1,i=["ready"];this.bind=function(t,i,r){return jsPlumbUtil.addToList(n,t,i,r),this};this.fire=function(r,u,f){if(!t&&n[r]){var h=n[r].length,e=0,o=!1,s=null;if(!this.shouldFireEvent||this.shouldFireEvent(r,u,f))while(!o&&e<h&&s!==!1){if(jsPlumbUtil.findWithFunction(i,function(n){return n===r})!=-1)n[r][e](u,f);else try{s=n[r][e](u,f)}catch(c){jsPlumbUtil.log("jsPlumb: fire failed for event "+r+" : "+c)}e++;(n==null||n[r]==null)&&(o=!0)}}return this};this.unbind=function(t){return t?delete n[t]:n={},this};this.getListener=function(t){return n[t]};this.setSuspendEvents=function(n){t=n};this.isSuspendEvents=function(){return t};this.cleanupListeners=function(){for(var t in n)n[t].splice(0),delete n[t]}};jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i})}(),function(){var t=!!document.createElement("canvas").getContext,i=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),n=function(){var i,t;return n.vml===undefined&&(i=document.body.appendChild(document.createElement("div")),i.innerHTML='<v:shape id="vml_flag1" adj="1" />',t=i.firstChild,t!=null&&t.style!=null?(t.style.behavior="url(#default#VML)",n.vml=t?typeof t.adj=="object":!0):n.vml=!1,i.parentNode.removeChild(i)),n.vml},r=function(n){var u={},f=[],t={},r={},i={};this.register=function(e){var s=jsPlumb.CurrentLibrary,l=s.getElementObject(e),o=n.getId(e),c=s.getOffset(l),h;u[o]||(u[o]=e,f.push(e),t[o]={});h=function(u){var f,a,e,l;if(u)for(f=0;f<u.childNodes.length;f++)u.childNodes[f].nodeType!=3&&u.childNodes[f].nodeType!=8&&(a=s.getElementObject(u.childNodes[f]),e=n.getId(u.childNodes[f],null,!0),e&&r[e]&&r[e]>0&&(l=s.getOffset(a),t[o][e]={id:e,offset:{left:l.left-c.left,top:l.top-c.top}},i[e]=o),h(u.childNodes[f]))};h(e)};this.updateOffsets=function(r){var u=jsPlumb.CurrentLibrary,s=u.getElementObject(r),a=u.getDOMElement(s),e=n.getId(a),h=t[e],c=u.getOffset(s),f,l,o;if(h)for(f in h)l=u.getElementObject(f),o=u.getOffset(l),t[e][f]={id:f,offset:{left:o.left-c.left,top:o.top-c.top}},i[f]=e};this.endpointAdded=function(f){var h=jsPlumb.CurrentLibrary,c=document.body,e=n.getId(f),v=h.getElementObject(f),l=jsPlumb.CurrentLibrary.getOffset(v),o=f.parentNode,p=o==c,s;for(r[e]=r[e]?r[e]+1:1;o!=null&&o!=c;){if(s=n.getId(o,null,!0),s&&u[s]){var y=h.getElementObject(o),a=h.getOffset(y);t[s][e]==null&&(t[s][e]={id:e,offset:{left:l.left-a.left,top:l.top-a.top}},i[e]=s);break}o=o.parentNode}};this.endpointDeleted=function(n){if(r[n.elementId]&&(r[n.elementId]--,r[n.elementId]<=0))for(var u in t)t[u]&&(delete t[u][n.elementId],delete i[n.elementId])};this.changeId=function(n,r){t[r]=t[n];t[n]={};i[r]=i[n];i[n]=null};this.getElementsForDraggable=function(n){return t[n]};this.elementRemoved=function(n){var r=i[n];r&&(delete t[r][n],delete i[n])};this.reset=function(){u={};f=[];t={};r={}};this.dragEnded=function(t){var u=n.getId(t),r=i[u];r&&this.updateOffsets(r)};this.setParent=function(n,r,u,f){var e=i[r],o,s;e&&(t[f]||(t[f]={}),t[f][r]=t[e][r],delete t[e][r],o=jsPlumb.CurrentLibrary.getOffset(u),s=jsPlumb.CurrentLibrary.getOffset(n),t[f][r].offset={left:s.left-o.left,top:s.top-o.top},i[r]=f)}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}});window.jsPlumbAdapter={headless:!1,getAttribute:function(n,t){return n.getAttribute(t)},setAttribute:function(n,t,i){n.setAttribute(t,i)},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(r){return{canvas:t,svg:i,vml:n()}[r]},getDragManager:function(n){return new r(n)},setRenderMode:function(n){var t;if(n){n=n.toLowerCase();var i=this.isRenderModeAvailable("canvas"),u=this.isRenderModeAvailable("svg"),r=this.isRenderModeAvailable("vml");n==="svg"?u?t="svg":i?t="canvas":r&&(t="vml"):n==="canvas"&&i?t="canvas":r&&(t="vml")}return t}}}(),function(){var t=jsPlumbUtil,v=function(t,r){n.CurrentLibrary.addClass(i(t),r)},ut=function(t,r){return n.CurrentLibrary.hasClass(i(t),r)},y=function(t,r){n.CurrentLibrary.removeClass(i(t),r)},i=function(t){return n.CurrentLibrary.getElementObject(t)},r=function(t){return n.CurrentLibrary.getDOMElement(t)},o=function(t,r){var u=n.CurrentLibrary.getOffset(i(t)),f;return r!=null?(f=r.getZoom(),{left:u.left/f,top:u.top/f}):u},s=function(t){return n.CurrentLibrary.getSize(i(t))},u=function(){return""+(new Date).getTime()},p=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var i={};n.extend(i,t._jsPlumb.paintStyle);n.extend(i,t._jsPlumb.hoverPaintStyle);delete t._jsPlumb.hoverPaintStyle;i.gradient&&t._jsPlumb.paintStyle.fillStyle&&delete i.gradient;t._jsPlumb.hoverPaintStyle=i}},h=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],w={mouseout:"mouseexit"},nt=function(n,t,i,r){var f=n.getAttachedElements(),u,e;if(f)for(u=0,e=f.length;u<e;u++)r&&r==f[u]||f[u].setHover(t,!0,i)},c=function(n){return n==null?null:n.split(" ")},f=function(n,i,r){var e,u,f,o;if(n.getDefaultType){for(e=n.getTypeDescriptor(),u=t.merge({},n.getDefaultType()),f=0,o=n._jsPlumb.types.length;f<o;f++)u=t.merge(u,n._jsPlumb.instance.getType(n._jsPlumb.types[f],e));i&&(u=t.populate(u,i));n.applyType(u,r);r||n.repaint()}},e=window.jsPlumbUIComponent=function(i){var e;jsPlumbUtil.EventGenerator.apply(this,arguments);var o=this,l=arguments,a=o.idPrefix,v=a+(new Date).getTime(),s=n.CurrentLibrary;if(this._jsPlumb={instance:i._jsPlumb,parameters:i.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:i.beforeDetach,beforeDrop:i.beforeDrop,overlayPlacements:[],hoverClass:i.hoverClass||i._jsPlumb.Defaults.HoverClass||n.Defaults.HoverClass,types:[]},this.getId=function(){return v},i.events)for(e in i.events)o.bind(e,i.events[e]);this.clone=function(){var n={};return this.constructor.apply(n,l),n}.bind(this);this.isDetachAllowed=function(n){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(n)}catch(r){t.log("jsPlumb: beforeDetach callback failed",r)}return i};this.isDropAllowed=function(n,i,r,u,f){var e=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f});if(this._jsPlumb.beforeDrop)try{e=this._jsPlumb.beforeDrop({sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f})}catch(o){t.log("jsPlumb: beforeDrop callback failed",o)}return e};var f=[],r=function(n,t,i){f.push([n,t,i]);n.bind(t,i)},u=[],y=function(n,t,i){var f=w[i]||i,r=function(n){t.fire(f,t,n)};u.push([n,i,r]);s.bind(n,i,r)},c=function(n,t,i){var r=w[t]||t;s.unbind(n,t,i)};this.bindListeners=function(n,t,i){r(n,"click",function(n,i){t.fire("click",t,i)});r(n,"dblclick",function(n,i){t.fire("dblclick",t,i)});r(n,"contextmenu",function(n,i){t.fire("contextmenu",t,i)});r(n,"mouseenter",function(n,r){t.isHover()||(i(!0),t.fire("mouseenter",t,r))});r(n,"mouseexit",function(n,r){t.isHover()&&(i(!1),t.fire("mouseexit",t,r))});r(n,"mousedown",function(n,i){t.fire("mousedown",t,i)});r(n,"mouseup",function(n,i){t.fire("mouseup",t,i)})};this.unbindListeners=function(){for(var t,n=0;n<f.length;n++)t=f[n],t[0].unbind(t[1],t[2]);f=null};this.attachListeners=function(n,t){for(var i=0,r=h.length;i<r;i++)y(n,t,h[i])};this.detachListeners=function(){for(var n=0;n<u.length;n++)c(u[n][0],u[n][1],u[n][2]);u=null};this.reattachListenersForElement=function(n){if(arguments.length>1){for(var t=0,i=h.length;t<i;t++)c(n,h[t]);for(t=1,i=arguments.length;t<i;t++)this.attachListeners(n,arguments[t])}}},n;jsPlumbUtil.extend(e,jsPlumbUtil.EventGenerator,{getParameter:function(n){return this._jsPlumb.parameters[n]},setParameter:function(n,t){this._jsPlumb.parameters[n]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(n){this._jsPlumb.parameters=n},addClass:function(n){this.canvas!=null&&v(this.canvas,n)},removeClass:function(n){this.canvas!=null&&y(this.canvas,n)},setType:function(n,t,i){this._jsPlumb.types=c(n)||[];f(this,t,i)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(n,t){f(this,n,t)},hasType:function(n){return jsPlumbUtil.indexOf(this._jsPlumb.types,n)!=-1},addType:function(n,t,i){var u=c(n),e=!1,r,o;if(u!=null){for(r=0,o=u.length;r<o;r++)this.hasType(u[r])||(this._jsPlumb.types.push(u[r]),e=!0);e&&f(this,t,i)}},removeType:function(n,i){var u=c(n),e=!1,s=function(n){var i=t.indexOf(this._jsPlumb.types,n);return i!=-1?(this._jsPlumb.types.splice(i,1),!0):!1}.bind(this),r,o;if(u!=null){for(r=0,o=u.length;r<o;r++)e=s(u[r])||e;e&&f(this,null,i)}},toggleType:function(n,t,i){var u=c(n),r,o,e;if(u!=null){for(r=0,o=u.length;r<o;r++)e=jsPlumbUtil.indexOf(this._jsPlumb.types,u[r]),e!=-1?this._jsPlumb.types.splice(e,1):this._jsPlumb.types.push(u[r]);f(this,t,i)}},applyType:function(n,t){if(this.setPaintStyle(n.paintStyle,t),this.setHoverPaintStyle(n.hoverPaintStyle,t),n.parameters)for(var i in n.parameters)this.setParameter(i,n.parameters[i])},setPaintStyle:function(n,t){this._jsPlumb.paintStyle=n;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;p(this);t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(n,t){this._jsPlumb.hoverPaintStyle=n;p(this);t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},cleanup:function(){this.unbindListeners();this.detachListeners()},destroy:function(){this.cleanupListeners();this.clone=null;this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(t,i,r){var f=n.CurrentLibrary;!this._jsPlumb||this._jsPlumb.instance.currentlyDragging||this._jsPlumb.instance.isHoverSuspended()||(this._jsPlumb.hover=t,this.canvas!=null&&this._jsPlumb.instance.hoverClass!=null&&f[t?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.hoverClass),this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(r=r||u(),this.repaint({timestamp:r,recalc:!1}))),this.getAttachedElements&&!i&&nt(this,t,u(),this))}});var l="__label",b=function(n,t){for(var r=-1,i=0,u=n._jsPlumb.overlays.length;i<u;i++)if(t===n._jsPlumb.overlays[i].id){r=i;break}return r},k=function(t,i){var r={cssClass:i.cssClass,labelStyle:t.labelStyle,id:l,component:t,_jsPlumb:t._jsPlumb.instance},u=n.extend(r,i);return new n.Overlays[t._jsPlumb.instance.getRenderMode()].Label(u)},d=function(i,r){var u=null,e,f;t.isArray(r)?(e=r[0],f=n.extend({component:i,_jsPlumb:i._jsPlumb.instance},r[1]),r.length==3&&n.extend(f,r[2]),u=new n.Overlays[i._jsPlumb.instance.getRenderMode()][e](f)):u=r.constructor==String?new n.Overlays[i._jsPlumb.instance.getRenderMode()][r]({component:i,_jsPlumb:i._jsPlumb.instance}):r;i._jsPlumb.overlays.push(u)},tt=function(t,i){var f=t.defaultOverlayKeys||[],r=i.overlays,o=function(i){return t._jsPlumb.instance.Defaults[i]||n.Defaults[i]||[]},u,e;for(r||(r=[]),u=0,e=f.length;u<e;u++)r.unshift.apply(r,o(f[u]));return r},it=window.OverlayCapableJsPlumbUIComponent=function(t){var i,r,u,f,o;if(e.apply(this,arguments),this._jsPlumb.overlays=[],i=tt(this,t),i)for(r=0,u=i.length;r<u;r++)d(this,i[r]);t.label&&(f=t.labelLocation||this.defaultLabelLocation||.5,o=t.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle||n.Defaults.LabelStyle,this._jsPlumb.overlays.push(k(this,{label:t.label,location:f,labelStyle:o})))};jsPlumbUtil.extend(it,e,{applyType:function(n,t){if(this.removeAllOverlays(t),n.overlays)for(var i=0,r=n.overlays.length;i<r;i++)this.addOverlay(n.overlays[i],!0)},setHover:function(n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var t=0,i=this._jsPlumb.overlays.length;t<i;t++)this._jsPlumb.overlays[t][n?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,t){d(this,n);t||this.repaint()},getOverlay:function(n){var t=b(this,n);return t>=0?this._jsPlumb.overlays[t]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(n){var t=this.getOverlay(n);t&&t.hide()},hideOverlays:function(){for(var n=0,t=this._jsPlumb.overlays.length;n<t;n++)this._jsPlumb.overlays[n].hide()},showOverlay:function(n){var t=this.getOverlay(n);t&&t.show()},showOverlays:function(){for(var n=0,t=this._jsPlumb.overlays.length;n<t;n++)this._jsPlumb.overlays[n].show()},removeAllOverlays:function(n){for(var t=0,i=this._jsPlumb.overlays.length;t<i;t++)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length);this._jsPlumb.overlayPositions=null;n||this.repaint()},removeOverlay:function(n){var t=b(this,n),i;t!=-1&&(i=this._jsPlumb.overlays[t],i.cleanup&&i.cleanup(),this._jsPlumb.overlays.splice(t,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[n])},removeOverlays:function(){for(var n=0,t=arguments.length;n<t;n++)this.removeOverlay(arguments[n])},getLabel:function(){var n=this.getOverlay(l);return n!=null?n.getLabel():null},getLabelOverlay:function(){return this.getOverlay(l)},setLabel:function(n){var t=this.getOverlay(l),i;t?n.constructor==String||n.constructor==Function?t.setLabel(n):(n.label&&t.setLabel(n.label),n.location&&t.setLocation(n.location)):(i=n.constructor==String||n.constructor==Function?{label:n}:n,t=k(this,i),this._jsPlumb.overlays.push(t));this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var n=0;n<this._jsPlumb.overlays.length;n++)this._jsPlumb.overlays[n].cleanup(),this._jsPlumb.overlays[n].destroy();this._jsPlumb.overlays.splice(0);this._jsPlumb.overlayPositions=null},setVisible:function(n){this[n?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(n,t){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{};this._jsPlumb.overlayPositions[n.id]=t},getAbsoluteOverlayPosition:function(n){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[n.id]:null}});var g=0,rt=function(){var n=g+1;return g++,n},a=window.jsPlumbInstance=function(f){var hi,ki,hr,di,oi,wt,gi,ii,ft,ar;this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};f&&n.extend(this.Defaults,f);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};jsPlumbUtil.EventGenerator.apply(this);var h=this,tr=rt(),vr=h.bind,ir={},rr=1,a=function(n){var t=r(n);return{el:t,id:jsPlumbUtil.isString(n)&&t==null?n:w(t)}};this.getInstanceIndex=function(){return tr};this.setZoom=function(n,t){rr=n;t&&h.repaintEverything()};this.getZoom=function(){return rr};for(hi in this.Defaults)ir[hi]=this.Defaults[hi];this.bind=function(n,t){"ready"===n&&ci?t():vr.apply(h,[n,t])};h.importDefaults=function(n){for(var t in n)h.Defaults[t]=n[t];return h};h.restoreDefaults=function(){return h.Defaults=n.extend({},ir),h};var ur=null,ci=!1,b=[],c={},et={},l={},li={},ai={},ot={},fr=!1,p=[],nt=!1,tt=null,vi=this.Defaults.Scope,at=null,yr=1,vt=function(){return""+yr++},pr=function(t,i){h.Defaults.Container?n.CurrentLibrary.appendElement(t,h.Defaults.Container):i?n.CurrentLibrary.appendElement(t,i):jsPlumbAdapter.appendToRoot(t)},ri=function(n){return n._nodes?n._nodes:n},st=function(n,t,i,r){var e,f,s,o,c;if(!jsPlumbAdapter.headless&&!nt){if(e=w(n),f=h.dragManager.getElementsForDraggable(e),i==null&&(i=u()),s=k({elId:e,offset:t,recalc:!1,timestamp:i}),f)for(o in f)k({elId:f[o].id,offset:{left:s.o.left+f[o].offset.left,top:s.o.top+f[o].offset.top},recalc:!1,timestamp:i});if(h.anchorManager.redraw(e,t,i,null,r),f)for(c in f)h.anchorManager.redraw(f[c].id,t,i,f[c].offset,r,!0)}},er=function(n,r){var f=null,u,e,o,s;if(t.isArray(n))for(f=[],o=0,s=n.length;o<s;o++)u=i(n[o]),e=h.getAttribute(u,"id"),f.push(r(u,e));else u=i(n),e=h.getAttribute(u,"id"),f=r(u,e);return f},yt=function(n){return et[n]},yi=function(i,r,u){var c,e,f,o,s;if(!jsPlumbAdapter.headless&&(c=r==null?!1:r,e=n.CurrentLibrary,c&&e.isDragSupported(i)&&!e.isAlreadyDraggable(i))){f=u||h.Defaults.DragOptions||n.Defaults.DragOptions;f=n.extend({},f);var l=e.dragEvents.drag,a=e.dragEvents.stop,p=e.dragEvents.start;f[p]=t.wrap(f[p],function(){h.setHoverSuspended(!0);h.select({source:i}).addClass(h.elementDraggingClass+" "+h.sourceElementDraggingClass,!0);h.select({target:i}).addClass(h.elementDraggingClass+" "+h.targetElementDraggingClass,!0);h.setConnectionBeingDragged(!0)});f[l]=t.wrap(f[l],function(){var n=e.getUIPosition(arguments,h.getZoom());st(i,n,null,!0);v(i,"jsPlumb_dragged")});f[a]=t.wrap(f[a],function(){var n=e.getUIPosition(arguments,h.getZoom());st(i,n);y(i,"jsPlumb_dragged");h.setHoverSuspended(!1);h.select({source:i}).removeClass(h.elementDraggingClass+" "+h.sourceElementDraggingClass,!0);h.select({target:i}).removeClass(h.elementDraggingClass+" "+h.targetElementDraggingClass,!0);h.setConnectionBeingDragged(!1);h.dragManager.dragEnded(i)});o=w(i);ot[o]=!0;s=ot[o];f.disabled=s==null?!1:!s;e.initDraggable(i,f,!1,h);h.dragManager.register(i)}},wr=function(i,u){var f=n.extend({},i),l,a,e,s,c,o;if(u&&n.extend(f,u),f.source&&(f.source.endpoint?f.sourceEndpoint=f.source:f.source=r(f.source)),f.target&&(f.target.endpoint?f.targetEndpoint=f.target:f.target=r(f.target)),i.uuids&&(f.sourceEndpoint=yt(i.uuids[0]),f.targetEndpoint=yt(i.uuids[1])),f.sourceEndpoint&&f.sourceEndpoint.isFull()){t.log(h,"could not add connection; source endpoint is full");return}if(f.targetEndpoint&&f.targetEndpoint.isFull()){t.log(h,"could not add connection; target endpoint is full");return}if(!f.type&&f.sourceEndpoint&&(f.type=f.sourceEndpoint.connectionType),f.sourceEndpoint&&f.sourceEndpoint.connectorOverlays)for(f.overlays=f.overlays||[],l=0,a=f.sourceEndpoint.connectorOverlays.length;l<a;l++)f.overlays.push(f.sourceEndpoint.connectorOverlays[l]);if(!f["pointer-events"]&&f.sourceEndpoint&&f.sourceEndpoint.connectorPointerEvents&&(f["pointer-events"]=f.sourceEndpoint.connectorPointerEvents),f.target&&!f.target.endpoint&&!f.targetEndpoint&&!f.newConnection&&(e=w(f.target),s=bt[e],c=kt[e],s)){if(!g[e])return;s.isTarget=!0;o=c!=null?c:h.addEndpoint(f.target,s);dt[e]&&(kt[e]=o);f.targetEndpoint=o;o._doNotDeleteOnDetach=!1;o._deleteOnDetach=!0}if(f.source&&!f.source.endpoint&&!f.sourceEndpoint&&!f.newConnection&&(e=w(f.source),s=gt[e],c=nr[e],s)){if(!d[e])return;o=c!=null?c:h.addEndpoint(f.source,s);ni[e]&&(nr[e]=o);f.sourceEndpoint=o;o._doNotDeleteOnDetach=!1;o._deleteOnDetach=!0}return f},pi=function(t){var r=h.Defaults.ConnectionType||h.getDefaultConnectionType(),u=h.Defaults.EndpointType||n.Endpoint,f=n.CurrentLibrary.getParent,i;return t.parent=t.container?t.container:t.sourceEndpoint?t.sourceEndpoint.parent:t.source.constructor==u?t.source.parent:f(t.source),t._jsPlumb=h,t.newConnection=pi,t.newEndpoint=wi,t.endpointsByUUID=et,t.endpointsByElement=c,t.finaliseConnection=ui,i=new r(t),i.id="con_"+vt(),ht("click","click",i),ht("dblclick","dblclick",i),ht("contextmenu","contextmenu",i),i.isDetachable()&&(i.endpoints[0].initDraggable(),i.endpoints[1].initDraggable()),i},ui=function(n,t,i,r){if(t=t||{},n.suspendedEndpoint||b.push(n),(n.suspendedEndpoint==null||r)&&h.anchorManager.newConnection(n),st(n.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var u={connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]};h.fire("connection",u,i)}},ht=function(n,t,i){i.bind(n,function(n,r){h.fire(t,i,r)})},or=function(t){if(t.container)return t.container;var i=n.CurrentLibrary.getTagName(t.source),r=n.CurrentLibrary.getParent(t.source);return i&&i.toLowerCase()==="td"?n.CurrentLibrary.getParent(r):r},wi=function(t){var u=h.Defaults.EndpointType||n.Endpoint,i=n.extend({},t),r;return i.parent=or(i),i._jsPlumb=h,i.newConnection=pi,i.newEndpoint=wi,i.endpointsByUUID=et,i.endpointsByElement=c,i.finaliseConnection=ui,i.fireDetachEvent=ki,i.fireMoveEvent=hr,i.floatingConnections=ai,i.getParentFromParams=or,i.elementId=w(i.source),r=new u(i),r.id="ep_"+vt(),ht("click","endpointClick",r),ht("dblclick","endpointDblClick",r),ht("contextmenu","contextmenu",r),jsPlumbAdapter.headless||h.dragManager.endpointAdded(i.source),r},bi=function(n,t,i){var r=c[n],u,e,f,o,s;if(r&&r.length)for(u=0,e=r.length;u<e;u++){for(f=0,o=r[u].connections.length;f<o;f++)if(s=t(r[u].connections[f]),s)return;i&&i(r[u])}},br=function(t,i){return er(t,function(t,r){ot[r]=i;n.CurrentLibrary.isDragSupported(t)&&n.CurrentLibrary.setDraggable(t,i)})},sr=function(n,t,i){var r,u;t=t==="block";r=null;i&&(r=t?function(n){n.setVisible(!0,!0,!0)}:function(n){n.setVisible(!1,!0,!0)});u=a(n);bi(u.id,function(n){if(t&&i){var r=n.sourceId===u.id?1:0;n.endpoints[r].isVisible()&&n.setVisible(!0)}else n.setVisible(t)},r)},kr=function(t){return er(t,function(t,i){var r=ot[i]==null?!1:ot[i];return r=!r,ot[i]=r,n.CurrentLibrary.setDraggable(t,r),r})},dr=function(n,t){var i=null;t&&(i=function(n){var t=n.isVisible();n.setVisible(!t)});bi(n,function(n){var t=n.isVisible();n.setVisible(!t)},i)},k=function(n){var u=n.timestamp,f=n.recalc,e=n.offset,t=n.elId,r;return(nt&&!u&&(u=tt),!f&&u&&u===li[t])?{o:n.offset||l[t],s:p[t]}:(f||!e?(r=i(t),r!=null&&(p[t]=s(r),l[t]=o(r,h),li[t]=u)):(l[t]=e,p[t]==null&&(r=i(t),r!=null&&(p[t]=s(r))),li[t]=u),l[t]&&!l[t].right&&(l[t].right=l[t].left+p[t][0],l[t].bottom=l[t].top+p[t][1],l[t].width=p[t][0],l[t].height=p[t][1],l[t].centerx=l[t].left+l[t].width/2,l[t].centery=l[t].top+l[t].height/2),{o:l[t],s:p[t]})},gr=function(n){var t=l[n];return t?{o:t,s:p[n]}:k({elId:n})},w=function(n,t,i){if(jsPlumbUtil.isString(n))return n;if(n==null)return null;var r=jsPlumbAdapter.getAttribute(n,"id");return r&&r!=="undefined"||(arguments.length==2&&arguments[1]!==undefined?r=t:arguments.length!=1&&(arguments.length!=3||arguments[2])||(r="jsPlumb_"+tr+"_"+vt()),i||jsPlumbAdapter.setAttribute(n,"id",r)),r};this.setConnectionBeingDragged=function(n){fr=n};this.isConnectionBeingDragged=function(){return fr};this.connectorClass="_jsPlumb_connector";this.hoverClass="_jsPlumb_hover";this.endpointClass="_jsPlumb_endpoint";this.endpointConnectedClass="_jsPlumb_endpoint_connected";this.endpointFullClass="_jsPlumb_endpoint_full";this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed";this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden";this.overlayClass="_jsPlumb_overlay";this.draggingClass="_jsPlumb_dragging";this.elementDraggingClass="_jsPlumb_element_dragging";this.sourceElementDraggingClass="_jsPlumb_source_element_dragging";this.targetElementDraggingClass="_jsPlumb_target_element_dragging";this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor";this.hoverSourceClass="_jsPlumb_source_hover";this.hoverTargetClass="_jsPlumb_target_hover";this.dragSelectClass="_jsPlumb_drag_select";this.Anchors={};this.Connectors={canvas:{},svg:{},vml:{}};this.Endpoints={canvas:{},svg:{},vml:{}};this.Overlays={canvas:{},svg:{},vml:{}};this.ConnectorRenderers={};this.SVG="svg";this.CANVAS="canvas";this.VML="vml";this.addEndpoint=function(i,u,f){var e,s,y,v,d,b,a,o;for(f=f||{},e=n.extend({},f),n.extend(e,u),e.endpoint=e.endpoint||h.Defaults.Endpoint||n.Defaults.Endpoint,e.paintStyle=e.paintStyle||h.Defaults.EndpointStyle||n.Defaults.EndpointStyle,i=ri(i),s=[],y=t.isArray(i)||i.length!=null&&!t.isString(i)?i:[i],v=0,d=y.length;v<d;v++){b=r(y[v]);a=w(b);e.source=b;k({elId:a,timestamp:tt});o=wi(e);e.parentAnchor&&(o.parentAnchor=e.parentAnchor);t.addToList(c,a,o);var g=l[a],rt=p[a],ut=o.anchor.compute({xy:[g.left,g.top],wh:rt,element:o,timestamp:tt}),it={anchorLoc:ut,timestamp:tt};nt&&(it.recalc=!1);nt||o.paint(it);s.push(o);o._doNotDeleteOnDetach=!0}return s.length==1?s[0]:s};this.addEndpoints=function(n,i,r){for(var u,f=[],e=0,o=i.length;e<o;e++)u=h.addEndpoint(n,i[e],r),t.isArray(u)?Array.prototype.push.apply(f,u):f.push(u);return f};this.animate=function(r,u,f){f=f||{};var c=i(r),e=w(r),o=n.CurrentLibrary.dragEvents.step,s=n.CurrentLibrary.dragEvents.complete;f[o]=t.wrap(f[o],function(){h.repaint(e)});f[s]=t.wrap(f[s],function(){h.repaint(e)});n.CurrentLibrary.animate(c,u,f)};this.checkCondition=function(n,i){var r=h.getListener(n),f=!0,u,e;if(r&&r.length>0)try{for(u=0,e=r.length;u<e;u++)f=f&&r[u](i)}catch(o){t.log(h,"cannot check condition ["+n+"]"+o)}return f};this.checkASyncCondition=function(n,i,r,u){var f=h.getListener(n);if(f&&f.length>0)try{f[0](i,r,u)}catch(e){t.log(h,"cannot asynchronously check condition ["+n+"]"+e)}};this.connect=function(n,t){var i=wr(n,t),r;return i&&(r=pi(i),ui(r,i)),r};this.deleteEndpoint=function(n,t){var r=h.setSuspendDrawing(!0),i=typeof n=="string"?et[n]:n;return i&&h.deleteObject({endpoint:i}),r||h.setSuspendDrawing(!1,t),h};this.deleteEveryEndpoint=function(){var u=h.setSuspendDrawing(!0),i,n,t,r;for(i in c)if(n=c[i],n&&n.length)for(t=0,r=n.length;t<r;t++)h.deleteEndpoint(n[t],!0);return c={},et={},h.anchorManager.reset(),h.dragManager.reset(),u||h.setSuspendDrawing(!1),h};ki=function(n,t,i){var u=h.Defaults.ConnectionType||h.getDefaultConnectionType(),f=n.constructor==u,r=f?{connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]}:n;t&&h.fire("connectionDetached",r,i);h.anchorManager.connectionDetached(r)};hr=function(n,t){h.fire("connectionMoved",n,t)};this.unregisterEndpoint=function(n){var t,i,u,r,f;n._jsPlumb.uuid&&(et[n._jsPlumb.uuid]=null);h.anchorManager.deleteEndpoint(n);for(t in c){if(i=c[t],i){for(u=[],r=0,f=i.length;r<f;r++)i[r]!=n&&u.push(i[r]);c[t]=u}c[t].length<1&&delete c[t]}};this.detach=function(){var i,f,o;if(arguments.length!==0){var c=h.Defaults.ConnectionType||h.getDefaultConnectionType(),s=arguments[0].constructor==c,u=arguments.length==2?s?arguments[1]||{}:arguments[0]:arguments[0],e=u.fireEvent!==!1,l=u.forceDetach,t=s?arguments[0]:u.connection;t?(l||jsPlumbUtil.functionChain(!0,!1,[[t.endpoints[0],"isDetachAllowed",[t]],[t.endpoints[1],"isDetachAllowed",[t]],[t,"isDetachAllowed",[t]],[h,"checkCondition",["beforeDetach",t]]]))&&t.endpoints[0].detach(t,!1,!0,e):(i=n.extend({},u),i.uuids?yt(i.uuids[0]).detachFrom(yt(i.uuids[1]),e):i.sourceEndpoint&&i.targetEndpoint?i.sourceEndpoint.detachFrom(i.targetEndpoint):(f=w(r(i.source)),o=w(r(i.target)),bi(f,function(n){(n.sourceId==f&&n.targetId==o||n.targetId==f&&n.sourceId==o)&&h.checkCondition("beforeDetach",n)&&n.endpoints[0].detach(n,!1,!0,e)})))}};this.detachAllConnections=function(n,t){var f,i,u,e;if(t=t||{},n=r(n),f=w(n),i=c[f],i&&i.length)for(u=0,e=i.length;u<e;u++)i[u].detachAll(t.fireEvent!==!1);return h};this.detachEveryConnection=function(n){return n=n||{},h.doWhileSuspended(function(){var r,t,i,u;for(r in c)if(t=c[r],t&&t.length)for(i=0,u=t.length;i<u;i++)t[i].detachAll(n.fireEvent!==!1);b.splice(0)}),h};this.deleteObject=function(n){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=n.fireEvent!==!1,u=n.deleteAttachedObjects!==!1,f=function(n){if(n!=null&&t.connections[n.id]==null&&(n._jsPlumb!=null&&n.setHover(!1),t.connections[n.id]=n,t.connectionCount++,u))for(var i=0;i<n.endpoints.length;i++)n.endpoints[i]._deleteOnDetach&&e(n.endpoints[i])},e=function(n){var i,r;if(n!=null&&t.endpoints[n.id]==null&&(n._jsPlumb!=null&&n.setHover(!1),t.endpoints[n.id]=n,t.endpointCount++,u))for(i=0;i<n.connections.length;i++)r=n.connections[i],f(r)},o,i,s,r;n.connection?f(n.connection):e(n.endpoint);for(o in t.connections)i=t.connections[o],i.endpoints[0].detachFromConnection(i),i.endpoints[1].detachFromConnection(i),jsPlumbUtil.removeWithFunction(b,function(n){return i.id==n.id}),ki(i,c,n.originalEvent),i.cleanup(),i.destroy();for(s in t.endpoints)r=t.endpoints[s],h.unregisterEndpoint(r),r.cleanup(),r.destroy();return t};this.draggable=function(n,t){var u,f,i;if(typeof n=="object"&&n.length)for(u=0,f=n.length;u<f;u++)i=r(n[u]),i&&yi(i,!0,t);else if(n._nodes)for(u=0,f=n._nodes.length;u<f;u++)i=r(n._nodes[u]),i&&yi(i,!0,t);else i=r(n),i&&yi(i,!0,t);return h};this.extend=function(t,i){return n.CurrentLibrary.extend(t,i)};var nu=function(n,t,i,r){for(var u=0,f=n.length;u<f;u++)n[u][t].apply(n[u],i);return r(n)},tu=function(n,t,i){for(var u=[],r=0,f=n.length;r<f;r++)u.push([n[r][t].apply(n[r],i),n[r]]);return u},ct=function(n,t,i){return function(){return nu(n,t,arguments,i)}},fi=function(n,t){return function(){return tu(n,t,arguments)}},it=function(n,t){var r=[],u,f;if(n)if(typeof n=="string"){if(n==="*")return n;r.push(n)}else if(n=i(n),t)r=n;else for(u=0,f=n.length;u<f;u++)r.push(a(n[u]).id);return r},ut=function(n,t,i){return n==="*"?!0:n.length>0?jsPlumbUtil.indexOf(n,t)!=-1:!i};this.getConnections=function(n,t){var u,e,i;n?n.constructor==String&&(n={scope:n}):n={};var o=n.scope||h.getDefaultScope(),f=it(o,!0),s=it(n.source),c=it(n.target),r=!t&&f.length>1?{}:[],l=function(n,i){if(!t&&f.length>1){var u=r[n];u==null&&(u=r[n]=[]);u.push(i)}else r.push(i)};for(u=0,e=b.length;u<e;u++)i=b[u],ut(f,i.scope)&&ut(s,i.sourceId)&&ut(c,i.targetId)&&l(i.scope,i);return r};var iu=function(n,t){return function(i){for(var r=0,u=n.length;r<u;r++)i(n[r]);return t(n)}},ru=function(n){return function(t){return n[t]}},cr=function(n,t){for(var u={length:n.length,each:iu(n,t),get:ru(n)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],e=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],i=0,r=f.length;i<r;i++)u[f[i]]=ct(n,f[i],t);for(i=0,r=e.length;i<r;i++)u[e[i]]=fi(n,e[i]);return u},pt=function(t){var i=cr(t,pt);return n.CurrentLibrary.extend(i,{setDetachable:ct(t,"setDetachable",pt),setReattach:ct(t,"setReattach",pt),setConnector:ct(t,"setConnector",pt),detach:function(){for(var n=0,i=t.length;n<i;n++)h.detach(t[n])},isDetachable:fi(t,"isDetachable"),isReattach:fi(t,"isReattach")})},ei=function(t){var i=cr(t,ei);return n.CurrentLibrary.extend(i,{setEnabled:ct(t,"setEnabled",ei),setAnchor:ct(t,"setAnchor",ei),isEnabled:fi(t,"isEnabled"),detachAll:function(){for(var n=0,i=t.length;n<i;n++)t[n].detachAll()},remove:function(){for(var n=0,i=t.length;n<i;n++)h.deleteObject({endpoint:t[n]})}})};this.select=function(n){return n=n||{},n.scope=n.scope||"*",pt(n.connections||h.getConnections(n,!0))};this.selectEndpoints=function(n){var t,r,s,i,h,l;n=n||{};n.scope=n.scope||"*";var u=!n.element&&!n.source&&!n.target,a=u?"*":it(n.element),f=u?"*":it(n.source),e=u?"*":it(n.target),v=it(n.scope,!0),o=[];for(t in c){var y=ut(a,t,!0),p=ut(f,t,!0),w=f!="*",b=ut(e,t,!0),k=e!="*";if(y||p||b)n:for(r=0,s=c[t].length;r<s;r++)if(i=c[t][r],ut(v,i.scope,!0)){if(h=w&&f.length>0&&!i.isSource,l=k&&e.length>0&&!i.isTarget,h||l)continue n;o.push(i)}}return ei(o)};this.getAllConnections=function(){return b};this.getDefaultScope=function(){return vi};this.getEndpoint=yt;this.getEndpoints=function(n){return c[a(n).id]};this.getDefaultEndpointType=function(){return n.Endpoint};this.getDefaultConnectionType=function(){return n.Connection};this.getId=w;this.getOffset=function(n){var t=l[n];return k({elId:n})};this.getSelector=function(){return n.CurrentLibrary.getSelector.apply(null,arguments)};this.getSize=function(n){var t=p[n];return t||k({elId:n}),p[n]};this.appendElement=pr;di=!1;this.isHoverSuspended=function(){return di};this.setHoverSuspended=function(n){di=n};oi=function(n){return function(){return jsPlumbAdapter.isRenderModeAvailable(n)}};this.isCanvasAvailable=oi("canvas");this.isSVGAvailable=oi("svg");this.isVMLAvailable=oi("vml");this.hide=function(n,t){return sr(n,"none",t),h};this.idstamp=vt;this.connectorsInitialized=!1;wt=[];gi=["canvas","svg","vml"];this.registerConnectorType=function(n,t){wt.push([n,t])};this.init=function(){var r=function(t,i,r){n.Connectors[t][i]=function(){r.apply(this,arguments);n.ConnectorRenderers[t].apply(this,arguments)};jsPlumbUtil.extend(n.Connectors[t][i],[r,n.ConnectorRenderers[t]])},t,i;if(!n.connectorsInitialized){for(t=0;t<wt.length;t++)for(i=0;i<gi.length;i++)r(gi[i],wt[t][1],wt[t][0]);n.connectorsInitialized=!0}ci||(h.anchorManager=new n.AnchorManager({jsPlumbInstance:h}),h.setRenderMode(h.Defaults.RenderMode),ci=!0,h.fire("ready",h))}.bind(this);this.log=ur;this.jsPlumbUIComponent=e;this.makeAnchor=function(){var f,o=function(t,i){if(n.Anchors[t])return new n.Anchors[t](i);if(!h.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"};},e;if(arguments.length===0)return null;var i=arguments[0],u=arguments[1],s=arguments[2],r=null;return i.compute&&i.getOrientation?i:(typeof i=="string"?r=o(arguments[0],{elementId:u,jsPlumbInstance:h}):t.isArray(i)&&(t.isArray(i[0])||t.isString(i[0])?i.length==2&&t.isObject(i[1])?t.isString(i[0])?(f=n.extend({elementId:u,jsPlumbInstance:h},i[1]),r=o(i[0],f)):(f=n.extend({elementId:u,jsPlumbInstance:h,anchors:i[0]},i[1]),r=new n.DynamicAnchor(f)):r=new n.DynamicAnchor({anchors:i,selector:null,elementId:u,jsPlumbInstance:s}):(e={x:i[0],y:i[1],orientation:i.length>=4?[i[2],i[3]]:[0,0],offsets:i.length>=6?[i[4],i[5]]:[0,0],elementId:u,jsPlumbInstance:s,cssClass:i.length==7?i[6]:null},r=new n.Anchor(e),r.clone=function(){return new n.Anchor(e)})),r.id||(r.id="anchor_"+vt()),r)};this.makeAnchors=function(i,r,u){for(var e=[],f=0,o=i.length;f<o;f++)typeof i[f]=="string"?e.push(n.Anchors[i[f]]({elementId:r,jsPlumbInstance:u})):t.isArray(i[f])&&e.push(h.makeAnchor(i[f],r,u));return e};this.makeDynamicAnchor=function(t,i){return new n.DynamicAnchor({anchors:t,selector:i,elementId:null,jsPlumbInstance:h})};var bt={},kt={},dt={},lt={},lr=function(t,i){t.paintStyle=t.paintStyle||h.Defaults.EndpointStyles[i]||h.Defaults.EndpointStyle||n.Defaults.EndpointStyles[i]||n.Defaults.EndpointStyle;t.hoverPaintStyle=t.hoverPaintStyle||h.Defaults.EndpointHoverStyles[i]||h.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyles[i]||n.Defaults.EndpointHoverStyle;t.anchor=t.anchor||h.Defaults.Anchors[i]||h.Defaults.Anchor||n.Defaults.Anchors[i]||n.Defaults.Anchor;t.endpoint=t.endpoint||h.Defaults.Endpoints[i]||h.Defaults.Endpoint||n.Defaults.Endpoints[i]||n.Defaults.Endpoint},gt={},nr={},ni={},d={},si={},ti={},g={},uu=function(n,t,i){for(var e=n.target||n.srcElement,u=!1,f=h.getSelector(t,i),r=0;r<f.length;r++)if(f[r]==e){u=!0;break}return u};this.makeTarget=function(r,u,f){var c=n.extend({_jsPlumb:h},f),y,v,w;n.extend(c,u);lr(c,1);var l=n.CurrentLibrary,b=c.scope||h.Defaults.Scope,k=!(c.deleteEndpointsOnDetach===!1),d=c.maxConnections||-1,p=c.onMaxConnections,nt=function(r){var v=a(r),u=v.id,nt=new e(c),f=n.extend({},c.dropOptions||{}),w,y;bt[u]=c;dt[u]=c.uniqueEndpoint;lt[u]=d;g[u]=!0;w=function(){var d,e,r;h.currentlyDragging=!1;var a=n.CurrentLibrary.getDropEvent(arguments),it=h.select({target:u}).length,y=i(l.getDragObject(arguments)),rt=h.getAttribute(y,"dragId"),b=h.getAttribute(y,"originalScope"),t=ai[rt],f=t.endpoints[0].isFloating()?0:1,w=t.endpoints[0],ot=c.endpoint?n.extend({},c.endpoint):{};if(!g[u]||lt[u]>0&&it>=lt[u])return p&&p({element:v.el,connection:t},a),!1;if(w.anchor.locked=!1,b&&l.setDragScope(y,b),t.suspendedEndpoint==null&&!t.pending)return!1;if(d=nt.isDropAllowed(f===0?u:t.sourceId,f===0?t.targetId:u,t.scope,t,null),t.suspendedEndpoint&&(t[f?"targetId":"sourceId"]=t.suspendedEndpoint.elementId,t[f?"target":"source"]=t.suspendedEndpoint.element,t.endpoints[f]=t.suspendedEndpoint),d){if(e=l.getElementObject(v.el),r=kt[u],(r==null||r._jsPlumb==null)&&(r=h.addEndpoint(e,c)),c.uniqueEndpoint&&(kt[u]=r),r._doNotDeleteOnDetach=!1,r._deleteOnDetach=!0,r.anchor.positionFinder!=null){var ut=l.getUIPosition(arguments,h.getZoom()),ft=o(e,h),et=s(e),tt=r.anchor.positionFinder(ut,ft,et,r.anchor.constructorParams);r.anchor.x=tt[0];r.anchor.y=tt[1]}t[f?"target":"source"]=r.element;t[f?"targetId":"sourceId"]=r.elementId;t.endpoints[f].detachFromConnection(t);t.endpoints[f]._deleteOnDetach&&(t.endpoints[f].deleteAfterDragStop=!0);r.addConnection(t);t.endpoints[f]=r;t.deleteEndpointsOnDetach=k;f==1?h.anchorManager.updateOtherEndpoint(t.sourceId,t.suspendedElementId,t.targetId,t):h.anchorManager.sourceChanged(t.suspendedEndpoint.elementId,t.sourceId,t);ui(t,null,a);t.pending=!1}else t.suspendedEndpoint&&(t.isReattach()?(t.setHover(!1),t.floatingAnchorIndex=null,t.suspendedEndpoint.addConnection(t),h.repaint(w.elementId)):w.detach(t,!1,!0,!0,a))};y=l.dragEvents.drop;f.scope=f.scope||b;f[y]=t.wrap(f[y],w);l.initDroppable(i(v.el),f,!0)};for(r=ri(r),y=r.length&&r.constructor!=String?r:[r],v=0,w=y.length;v<w;v++)nt(y[v]);return h};this.unmakeTarget=function(t,i){var r=a(t);return n.CurrentLibrary.destroyDroppable(r.el),i||(delete bt[r.id],delete dt[r.id],delete lt[r.id],delete g[r.id]),h};this.makeSource=function(u,f,e){var c=n.extend({},e),y,v,g;n.extend(c,f);lr(c,0);var l=n.CurrentLibrary,p=c.maxConnections||-1,b=c.onMaxConnections,nt=function(u){var y=u.id,v=i(u.el),g=function(){return c.parent==null?null:c.parent==="parent"?u.el.parentNode:r(c.parent)},a=c.parent!=null?h.getId(g()):y,tt;gt[a]=c;ni[a]=c.uniqueEndpoint;d[a]=!0;var it=l.dragEvents.stop,rt=l.dragEvents.drag,e=n.extend({},c.dragOptions||{}),ut=e.drag,ft=e.stop,f=null,nt=!1;ti[a]=p;e.scope=e.scope||c.scope;e[rt]=t.wrap(e[rt],function(){ut&&ut.apply(this,arguments);nt=!1});e[it]=t.wrap(e[it],function(){var u,p;if(ft&&ft.apply(this,arguments),h.currentlyDragging=!1,f._jsPlumb!=null){l.unbind(f.canvas,"mousedown");var w=c.anchor||h.Defaults.Anchor,e=f.anchor,b=f.connections[0],t=h.makeAnchor(w,y,h),a=f.element;if(t.positionFinder!=null){var i=o(a,h),r=s(a),k={left:i.left+e.x*r[0],top:i.top+e.y*r[1]},v=t.positionFinder(k,i,r,t.constructorParams);t.x=v[0];t.y=v[1]}f.setAnchor(t,!0);c.parent&&(u=g(),u&&(p=c.container||h.Defaults.Container||n.Defaults.Container,f.setElement(u,p)));f.repaint();h.repaint(f.elementId);h.repaint(b.targetId)}});tt=function(t){var u,tt,it,st,ht,r,o,s;if(d[a]&&(!c.filter||(u=l.getOriginalEvent(t),tt=jsPlumbUtil.isString(c.filter)?uu(u,v,c.filter):c.filter(u,v),tt!==!1))){if(it=h.select({source:a}).length,ti[a]>=0&&it>=ti[a])return b&&b({element:v,maxConnections:p},t),!1;var i=k({elId:y}).o,rt=h.getZoom(),ut=((t.pageX||t.page.x)/rt-i.left)/i.width,ft=((t.pageY||t.page.y)/rt-i.top)/i.height,et=ut,ot=ft;c.parent&&(st=g(),ht=w(st),i=k({elId:ht}).o,et=((t.pageX||t.page.x)-i.left)/i.width,ot=((t.pageY||t.page.y)-i.top)/i.height);r={};n.extend(r,c);r.isSource=!0;r.anchor=[ut,ft,0,0];r.parentAnchor=[et,ot,0,0];r.dragOptions=e;c.parent&&(o=r.container||h.Defaults.Container||n.Defaults.Container,r.container=o?o:n.CurrentLibrary.getParent(g()));f=h.addEndpoint(y,r);nt=!0;f.endpointWillMoveAfterConnection=c.parent!=null;f.endpointWillMoveTo=c.parent?g():null;f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0;s=function(){nt&&(nt=!1,h.deleteEndpoint(f))};h.registerListener(f.canvas,"mouseup",s);h.registerListener(v,"mouseup",s);l.trigger(f.canvas,"mousedown",t)}};h.registerListener(v,"mousedown",tt);si[y]=tt;c.filter&&jsPlumbUtil.isString(c.filter)&&l.setDragFilter(v,c.filter)};for(u=ri(u),y=u.length&&u.constructor!=String?u:[u],v=0,g=y.length;v<g;v++)nt(a(y[v]));return h};this.unmakeSource=function(n,t){var i=a(n),r=si[i.id];return r&&h.unregisterListener(i.el,"mousedown",r),t||(delete gt[i.id],delete ni[i.id],delete d[i.id],delete si[i.id],delete ti[i.id]),h};this.unmakeEverySource=function(){for(var n in d)h.unmakeSource(n,!0);gt={};ni={};d={};si={}};this.unmakeEveryTarget=function(){for(var n in g)h.unmakeTarget(n,!0);return bt={},dt={},lt={},g={},h};ii=function(n,i,r,u){var f=n=="source"?d:g,e,s,o;if(i=ri(i),t.isString(i))f[i]=u?!f[i]:r;else if(i.length)for(e=0,s=i.length;e<s;e++)o=a(i[e]),f[o.id]=u?!f[o.id]:r;return h};this.toggleSourceEnabled=function(n){return ii("source",n,null,!0),h.isSourceEnabled(n)};this.setSourceEnabled=function(n,t){return ii("source",n,t)};this.isSource=function(n){return d[a(n).id]!=null};this.isSourceEnabled=function(n){return d[a(n).id]===!0};this.toggleTargetEnabled=function(n){return ii("target",n,null,!0),h.isTargetEnabled(n)};this.isTarget=function(n){return g[a(n).id]!=null};this.isTargetEnabled=function(n){return g[a(n).id]===!0};this.setTargetEnabled=function(n,t){return ii("target",n,t)};this.ready=function(n){h.bind("ready",n)};this.repaint=function(n,t,i){if(typeof n=="object"&&n.length)for(var r=0,u=n.length;r<u;r++)st(n[r],t,i);else st(n,t,i);return h};this.repaintEverything=function(){var n=u();for(var t in c)st(t,null,n);return h};this.removeAllEndpoints=function(n,t){var i=function(n){var u=a(n),e=c[u.id],r,f;if(e)for(r=0,f=e.length;r<f;r++)h.deleteEndpoint(e[r]);if(delete c[u.id],t&&u.el&&u.el.nodeType!=3&&u.el.nodeType!=8)for(r=0,f=u.el.childNodes.length;r<f;r++)i(u.el.childNodes[r])};return i(n),h};this.remove=function(t,i){var r=a(t);h.doWhileSuspended(function(){h.removeAllEndpoints(r.id,!0);h.dragManager.elementRemoved(r.id);delete ai[r.id];h.anchorManager.clearFor(r.id);h.anchorManager.removeFloatingConnection(r.id)},i===!1);r.el&&n.CurrentLibrary.removeElement(r.el)};ft={};ar=function(){var r,t,u,i;for(r in ft)for(t=0,u=ft[r].length;t<u;t++)i=ft[r][t],n.CurrentLibrary.unbind(i.el,i.event,i.listener);ft={}};this.registerListener=function(t,i,r){n.CurrentLibrary.bind(t,i,r);jsPlumbUtil.addToList(ft,i,{el:t,event:i,listener:r})};this.unregisterListener=function(t,i,r){n.CurrentLibrary.unbind(t,i,r);jsPlumbUtil.removeWithFunction(ft,function(n){return n.type==i&&n.listener==r})};this.reset=function(){h.deleteEveryEndpoint();h.unbind();bt={};kt={};dt={};lt={};gt={};nr={};ni={};ti={};b.splice(0);ar();h.anchorManager.reset();jsPlumbAdapter.headless||h.dragManager.reset()};this.setDefaultScope=function(n){return vi=n,h};this.setDraggable=br;this.setId=function(n,t,i){var u,o,s,f,l,e;for(jsPlumbUtil.isString(n)?u=n:(n=r(n),u=h.getId(n)),o=h.getConnections({source:u,scope:"*"},!0),s=h.getConnections({target:u,scope:"*"},!0),t=""+t,i?n=r(t):(n=r(u),jsPlumbAdapter.setAttribute(n,"id",t)),c[t]=c[u]||[],f=0,l=c[t].length;f<l;f++)c[t][f].setElementId(t),c[t][f].setReferenceElement(n);delete c[u];h.anchorManager.changeId(u,t);jsPlumbAdapter.headless||h.dragManager.changeId(u,t);e=function(i,r,u){for(var f=0,e=i.length;f<e;f++)i[f].endpoints[r].setElementId(t),i[f].endpoints[r].setReferenceElement(n),i[f][u+"Id"]=t,i[f][u]=n};e(o,0,"source");e(s,1,"target");h.repaint(t)};this.setDebugLog=function(n){ur=n};this.setSuspendDrawing=function(n,t){var i=nt;return nt=n,tt=n?(new Date).getTime():null,t&&h.repaintEverything(),i};this.isSuspendDrawing=function(){return nt};this.getSuspendedAt=function(){return tt};this.doWhileSuspended=function(n,i){var r=h.isSuspendDrawing();r||h.setSuspendDrawing(!0);try{n()}catch(u){t.log("Function run while suspended failed",u)}r||h.setSuspendDrawing(!1,!i)};this.updateOffset=k;this.getOffset=function(n){return l[n]};this.getSize=function(n){return p[n]};this.getCachedData=gr;this.timestamp=u;this.setRenderMode=function(t){var i,u,r;return at=jsPlumbAdapter.setRenderMode(t),at==n.CANVAS&&(r=function(t){n.CurrentLibrary.bind(document,t,function(r){var e,o,f;if(!h.currentlyDragging&&at==n.CANVAS){for(i=0,u=b.length;i<u;i++)if(e=b[i].getConnector()[t](r),e)return;for(o in c)for(f=c[o],i=0,u=f.length;i<u;i++)if(f[i].endpoint[t]&&f[i].endpoint[t](r))return}})},r("click"),r("dblclick"),r("mousemove"),r("mousedown"),r("mouseup"),r("contextmenu")),at};this.getRenderMode=function(){return at};this.show=function(n,t){return sr(n,"block",t),h};this.getTestHarness=function(){return{endpointsByElement:c,endpointCount:function(n){var t=c[n];return t?t.length:0},connectionCount:function(n){n=n||vi;var t=h.getConnections({scope:n});return t?t.length:0},getId:w,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}};this.toggleVisible=dr;this.toggleDraggable=kr;this.addListener=this.bind;this.adjustForParentOffsetAndScroll=function(n,t){var i=null,r=n,u,f;return t.tagName.toLowerCase()==="svg"&&t.parentNode?i=t.parentNode:t.offsetParent&&(i=t.offsetParent),i!=null&&(u=i.tagName.toLowerCase()==="body"?{left:0,top:0}:o(i,h),f=i.tagName.toLowerCase()==="body"?{left:0,top:0}:{left:i.scrollLeft,top:i.scrollTop},r[0]=n[0]-u.left+f.left,r[1]=n[1]-u.top+f.top),r};jsPlumbAdapter.headless||(h.dragManager=jsPlumbAdapter.getDragManager(h),h.recalculateOffsets=h.dragManager.updateOffsets)};jsPlumbUtil.extend(a,jsPlumbUtil.EventGenerator,{setAttribute:function(n,t,i){jsPlumbAdapter.setAttribute(n,t,i)},getAttribute:function(t,i){return jsPlumbAdapter.getAttribute(n.CurrentLibrary.getDOMElement(t),i)},registerConnectionType:function(t,i){this._connectionTypes[t]=n.extend({},i)},registerConnectionTypes:function(t){for(var i in t)this._connectionTypes[i]=n.extend({},t[i])},registerEndpointType:function(t,i){this._endpointTypes[t]=n.extend({},i)},registerEndpointTypes:function(t){for(var i in t)this._endpointTypes[i]=n.extend({},t[i])},getType:function(n,t){return t==="connection"?this._connectionTypes[n]:this._endpointTypes[n]},setIdChanged:function(n,t){this.setId(n,t,!0)},setParent:function(t,i){var r=n.CurrentLibrary,f=r.getElementObject(t),u=r.getDOMElement(f),s=this.getId(u),e=r.getElementObject(i),o=r.getDOMElement(e),h=this.getId(o);u.parentNode.removeChild(u);o.appendChild(u);this.dragManager.setParent(f,s,e,h)}});n=new a;typeof window!="undefined"&&(window.jsPlumb=n);n.getInstance=function(n){var t=new a(n);return t.init(),t};typeof define=="function"&&(define("jsplumb",[],function(){return n}),define("jsplumbinstance",[],function(){return n.getInstance()}));typeof exports!="undefined"&&(exports.jsPlumb=n)}(),function(){var i=function(n,t){var i=!1;return{drag:function(){if(i)return i=!1,!0;var r=jsPlumb.CurrentLibrary.getUIPosition(arguments,t.getZoom());n.element&&(jsPlumb.CurrentLibrary.setOffset(n.element,r),t.repaint(n.element,r))},stopDrag:function(){i=!0}}},r=function(n,t,i){var r=document.createElement("div"),f,u;r.style.position="absolute";f=jsPlumb.CurrentLibrary.getElementObject(r);jsPlumb.CurrentLibrary.appendElement(r,t);u=i.getId(r);i.updateOffset({elId:u});n.id=u;n.element=r},u=function(n,t,i,r,u,f,e){var o=new jsPlumb.FloatingAnchor({reference:t,referenceCanvas:r,jsPlumbInstance:f});return e({paintStyle:n,endpoint:i,anchor:o,source:u,scope:"__floating"})},n=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],f=function(n,t){var r=0,i;if(t!=null)for(i=0;i<n.connections.length;i++)if(n.connections[i].sourceId==t||n.connections[i].targetId==t){r=i;break}return n.connections[r]},t=function(n,t){return jsPlumbUtil.findWithFunction(t.connections,function(t){return t.id==n.id})};jsPlumb.Endpoint=function(e){var o=e._jsPlumb,s=jsPlumb.CurrentLibrary,it=jsPlumbAdapter.getAttribute,l=s.getElementObject,w=s.getDOMElement,h=jsPlumbUtil,g=e.newConnection,b=e.newEndpoint,nt=e.finaliseConnection,rt=e.fireDetachEvent,tt=e.fireMoveEvent,a=e.floatingConnections,c,v,k,d,y,p;return this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=e.parent,OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector,connectorTooltip:e.connectorTooltip}},this._jsPlumb.enabled=!(e.enabled===!1),this._jsPlumb.visible=!0,this.element=w(e.source),this._jsPlumb.uuid=e.uuid,this._jsPlumb.floatingEndpoint=null,c=null,this._jsPlumb.uuid&&(e.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=e.elementId,this._jsPlumb.connectionCost=e.connectionCost,this._jsPlumb.connectionsDirected=e.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={},v=function(){s.removeClass(this.element,o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this.removeClass(o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();this.addClass(o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);s.addClass(this.element,o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass)}.bind(this),this.setAnchor=function(n,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(n,this.elementId,o),v(),this.anchor.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n});v()}.bind(this)),t||this._jsPlumb.instance.repaint(this.elementId),this},k=e.anchor?e.anchor:e.anchors?e.anchors:o.Defaults.Anchor||"Top",this.setAnchor(k,!0),d=function(n){this.connections.length>0?this.connections[0].setHover(n,!1):this.setHover(n)}.bind(this),e._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(n){var i,t,r;this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy());i=function(n,t){var i=o.getRenderMode();if(jsPlumb.Endpoints[i][n])return new jsPlumb.Endpoints[i][n](t);if(!o.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+n+"'"};};t={_jsPlumb:this._jsPlumb.instance,cssClass:e.cssClass,parent:e.parent,container:e.container,tooltip:e.tooltip,connectorTooltip:e.connectorTooltip,endpoint:this};h.isString(n)?this.endpoint=i(n,t):h.isArray(n)?(t=h.merge(n[1],t),this.endpoint=i(n[0],t)):this.endpoint=n.clone();r=jsPlumb.extend({},t);this.endpoint.clone=function(){return h.isString(n)?i(n,t):h.isArray(n)?(t=h.merge(n[1],t),i(n[0],t)):void 0}.bind(this);this.type=this.endpoint.type;this.bindListeners(this.endpoint,this,d)},this.setEndpoint(e.endpoint||o.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(e.paintStyle||e.style||o.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(e.hoverPaintStyle||o.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),h.copyValues(n,e,this),this.isSource=e.isSource||!1,this.isTarget=e.isTarget||!1,this._jsPlumb.maxConnections=e.maxConnections||o.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.addClass(o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),s.addClass(this.element,o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=e.connections||[],this.connectorPointerEvents=e["connector-pointer-events"],this.scope=e.scope||o.getDefaultScope(),this.timestamp=null,this.reattachConnections=e.reattach||o.Defaults.ReattachConnections,this.connectionsDetachable=o.Defaults.ConnectionsDetachable,(e.connectionsDetachable===!1||e.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=e.dragAllowedWhenFull||!0,e.onMaxConnections&&this.bind("maxConnections",e.onMaxConnections),this.addConnection=function(n){this.connections.push(n);this[(this.connections.length>0?"add":"remove")+"Class"](o.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](o.endpointFullClass)},this.detachFromConnection=function(n,i){i=i==null?t(n,this):i;i>=0&&(this.connections.splice(i,1),this[(this.connections.length>0?"add":"remove")+"Class"](o.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](o.endpointFullClass))},this.detach=function(n,i,r,u,f,e,s){var c=s==null?t(n,this):s,h=!1;return u=u!==!1,c>=0&&(r||n._forceDetach||n.isDetachable()&&n.isDetachAllowed(n)&&this.isDetachAllowed(n))&&(o.deleteObject({connection:n,fireEvent:!i&&u,originalEvent:f}),h=!0),h},this.detachAll=function(n,t){while(this.connections.length>0)this.detach(this.connections[0],!1,!0,n!==!1,t,this,0);return this},this.detachFrom=function(n,t,i){for(var u,f=[],r=0;r<this.connections.length;r++)(this.connections[r].endpoints[1]==n||this.connections[r].endpoints[0]==n)&&f.push(this.connections[r]);for(u=0;u<f.length;u++)this.detach(f[u],!1,!0,t,i);return this},this.getElement=function(){return this.element},this.setElement=function(n){var t=this._jsPlumb.instance.getId(n),i=this.elementId;return h.removeWithFunction(e.endpointsByElement[this.elementId],function(n){return n.id==this.id}.bind(this)),this.element=w(n),this.elementId=o.getId(this.element),o.anchorManager.rehomeEndpoint(this,i,this.element),o.dragManager.endpointAdded(this.element),h.addToList(e.endpointsByElement,t,this),this},this.makeInPlaceCopy=function(){var n=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),i=this.anchor.getCssClass(),r={bind:function(){},compute:function(){return[n[0],n[1]]},getCurrentLocation:function(){return[n[0],n[1]]},getOrientation:function(){return t},getCssClass:function(){return i}};return b({anchor:r,source:this.element,paintStyle:this.getPaintStyle(),endpoint:e.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.isFloating=function(){return this.anchor!=null&&this.anchor.isFloating},this.connectorSelector=function(){var n=this.connections[0];return this.isTarget&&n?n:this.connections.length<this._jsPlumb.maxConnections||this._jsPlumb.maxConnections==-1?null:n},this.setStyle=this.setPaintStyle,this.paint=function(n){var t,l,c,u,e,a,v,r,i,h;if(n=n||{},t=n.timestamp,l=!(n.recalc===!1),(!t||this.timestamp!==t)&&(c=o.updateOffset({elId:this.elementId,timestamp:t}),u=n.offset?n.offset.o:c.o,u!=null)){if(e=n.anchorPoint,a=n.connectorPaintStyle,e==null){if(v=n.dimensions||c.s,r={xy:[u.left,u.top],wh:v,element:this,timestamp:t},l&&this.anchor.isDynamic&&this.connections.length>0){var s=f(this,n.elementWithPrecedence),y=s.endpoints[0]==this?1:0,b=y===0?s.sourceId:s.targetId,p=o.getCachedData(b),w=p.o,k=p.s;r.txy=[w.left,w.top];r.twh=k;r.tElement=s.endpoints[y]}e=this.anchor.compute(r)}for(this.endpoint.compute(e,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,a||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=t,i=0;i<this._jsPlumb.overlays.length;i++)h=this._jsPlumb.overlays[i],h.isVisible()&&(this._jsPlumb.overlayPlacements[i]=h.draw(this.endpoint,this._jsPlumb.paintStyleInUse),h.paint(this._jsPlumb.overlayPlacements[i]))}},this.repaint=this.paint,y=!1,this.initDraggable=function(){var it;if(!y&&s.isDragSupported(this.element)){var t={id:null,element:null},n=null,w=!1,v=null,k=i(t,o),rt=function(){var f,d,i,nt,ut;if(n=this.connectorSelector(),f=!0,this.isEnabled()||(f=!1),n!=null||this.isSource||(f=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(f=!1),n==null||n.isDetachable()||(f=!1),f===!1)return s.stopDrag&&s.stopDrag(),k.stopDrag(),!1;for(d=0;d<this.connections.length;d++)this.connections[d].setHover(!1);this.addClass("endpointDrag");o.setConnectionBeingDragged(!0);n&&!this.isFull()&&this.isSource&&(n=null);o.updateOffset({elId:this.elementId});c=this.makeInPlaceCopy();c.referenceEndpoint=this;c.paint();r(t,this.parent,o);var tt=l(c.canvas),it=jsPlumb.CurrentLibrary.getOffset(tt,o),rt=o.adjustForParentOffsetAndScroll([it.left,it.top],c.canvas),y=l(this.canvas);s.setOffset(t.element,{left:rt[0],top:rt[1]});this.parentAnchor&&(this.anchor=o.makeAnchor(this.parentAnchor,this.elementId,o));o.setAttribute(this.canvas,"dragId",t.id);o.setAttribute(this.canvas,"elId",this.elementId);this._jsPlumb.floatingEndpoint=u(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,t.element,o,b);this.canvas.style.visibility="hidden";n==null?(this.anchor.locked=!0,this.setHover(!1,!1),n=g({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:t.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:e.connectorStyle,hoverPaintStyle:e.connectorHoverStyle,connector:e.connector,overlays:e.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),n.pending=!0,n.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.addClass(o.draggingClass),o.fire("connectionDrag",n)):(w=!0,n.setHover(!1),p(tt,!1,!0),i=n.endpoints[0].id==this.id?0:1,n.floatingAnchorIndex=i,this.detachFromConnection(n),nt=jsPlumb.CurrentLibrary.getDragScope(y),o.setAttribute(this.canvas,"originalScope",nt),ut=s.getDropScope(y),s.setDragScope(y,ut),o.fire("connectionDrag",n),i===0?(v=[n.source,n.sourceId,y,nt],n.source=t.element,n.sourceId=t.id):(v=[n.target,n.targetId,y,nt],n.target=t.element,n.targetId=t.id),n.endpoints[i===0?1:0].anchor.locked=!0,n.suspendedEndpoint=n.endpoints[i],n.suspendedElement=n.endpoints[i].getElement(),n.suspendedElementId=n.endpoints[i].elementId,n.suspendedElementType=i===0?"source":"target",n.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=n.suspendedEndpoint,n.endpoints[i]=this._jsPlumb.floatingEndpoint,n.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.addClass(o.draggingClass));a[t.id]=n;o.anchorManager.addFloatingConnection(t.id,n);h.addToList(e.endpointsByElement,t.id,this._jsPlumb.floatingEndpoint);o.currentlyDragging=!0}.bind(this),f=e.dragOptions||{},ut=jsPlumb.extend({},s.defaultDragOptions),d=s.dragEvents.start,nt=s.dragEvents.stop,tt=s.dragEvents.drag;f=jsPlumb.extend(ut,f);f.scope=f.scope||this.scope;f[d]=h.wrap(f[d],rt,!1);f[tt]=h.wrap(f[tt],k.drag);f[nt]=h.wrap(f[nt],function(){if(o.setConnectionBeingDragged(!1),n.endpoints!=null){var r=s.getDropEvent(arguments),i=n.floatingAnchorIndex==null?1:n.floatingAnchorIndex;n.endpoints[i===0?1:0].anchor.locked=!1;n.removeClass(o.draggingClass);n.endpoints[i]==this._jsPlumb.floatingEndpoint&&w&&n.suspendedEndpoint&&(i===0?(n.source=v[0],n.sourceId=v[1]):(n.target=v[0],n.targetId=v[1]),s.setDragScope(v[2],v[3]),n.endpoints[i]=n.suspendedEndpoint,(n.isReattach()||n._forceReattach||n._forceDetach||!n.endpoints[i===0?1:0].detach(n,!1,!1,!0,r))&&(n.setHover(!1),n.floatingAnchorIndex=null,n._forceDetach=null,n._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(n),n.suspendedEndpoint.addConnection(n),o.repaint(v[1])))}o.remove(t.element,!1);o.remove(c.canvas,!1);this.deleteAfterDragStop?o.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1}));o.fire("connectionDragStop",n,r);o.currentlyDragging=!1;n=null}.bind(this));it=l(this.canvas);s.initDraggable(it,f,!0,o);y=!0}},(this.isSource||this.isTarget)&&this.initDraggable(),p=function(n,t,i,r){var u;if((this.isTarget||t)&&s.isDropSupported(this.element)){u=e.dropOptions||o.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;u=jsPlumb.extend({},u);u.scope=u.scope||this.scope;var f=s.dragEvents.drop,c=s.dragEvents.over,v=s.dragEvents.out,y=function(){var t,p,h,i;this.removeClass(o.endpointDropAllowedClass);this.removeClass(o.endpointDropForbiddenClass);var f=s.getDropEvent(arguments),u=l(s.getDragObject(arguments)),v=o.getAttribute(u,"dragId"),k=o.getAttribute(u,"elId"),e=o.getAttribute(u,"originalScope"),n=a[v],y=n.suspendedEndpoint&&(n.suspendedEndpoint.id==this.id||this.referenceEndpoint&&n.suspendedEndpoint.id==this.referenceEndpoint.id);if(y){n._forceReattach=!0;return}if(n!=null){if(t=n.floatingAnchorIndex==null?1:n.floatingAnchorIndex,p=t===0?1:0,e&&jsPlumb.CurrentLibrary.setDragScope(u,e),h=r!=null?r.isEnabled():!0,this.isFull()&&this.fire("maxConnections",{endpoint:this,connection:n,maxConnections:this._jsPlumb.maxConnections},f),!this.isFull()&&!(t===0&&!this.isSource)&&!(t==1&&!this.isTarget)&&h){i=!0;n.suspendedEndpoint&&n.suspendedEndpoint.id!=this.id&&(t===0?(n.source=n.suspendedEndpoint.element,n.sourceId=n.suspendedEndpoint.elementId):(n.target=n.suspendedEndpoint.element,n.targetId=n.suspendedEndpoint.elementId),n.isDetachAllowed(n)&&n.endpoints[t].isDetachAllowed(n)&&n.suspendedEndpoint.isDetachAllowed(n)&&o.checkCondition("beforeDetach",n)||(i=!1));t===0?(n.source=this.element,n.sourceId=this.elementId):(n.target=this.element,n.targetId=this.elementId);var c=function(){n.floatingAnchorIndex=null},w=function(){var i,r,e,u;n.pending=!1;n.endpoints[t].detachFromConnection(n);n.suspendedEndpoint&&n.suspendedEndpoint.detachFromConnection(n);n.endpoints[t]=this;this.addConnection(n);i=this.getParameters();for(r in i)n.setParameter(r,i[r]);n.suspendedEndpoint?(e=n.suspendedEndpoint.getElement(),u=n.suspendedEndpoint.elementId,tt({index:t,originalSourceId:t===0?u:n.sourceId,newSourceId:t===0?this.elementId:n.sourceId,originalTargetId:t==1?u:n.targetId,newTargetId:t==1?this.elementId:n.targetId,originalSourceEndpoint:t===0?n.suspendedEndpoint:n.endpoints[0],newSourceEndpoint:t===0?this:n.endpoints[0],originalTargetEndpoint:t==1?n.suspendedEndpoint:n.endpoints[1],newTargetEndpoint:t==1?this:n.endpoints[1],connection:n},f)):i.draggable&&jsPlumb.CurrentLibrary.initDraggable(this.element,dragOptions,!0,o);t==1?o.anchorManager.updateOtherEndpoint(n.sourceId,n.suspendedElementId,n.targetId,n):o.anchorManager.sourceChanged(n.suspendedEndpoint.elementId,n.sourceId,n);nt(n,null,f);c()}.bind(this),b=function(){n.suspendedEndpoint&&(n.endpoints[t]=n.suspendedEndpoint,n.setHover(!1),n._forceDetach=!0,t===0?(n.source=n.suspendedEndpoint.element,n.sourceId=n.suspendedEndpoint.elementId):(n.target=n.suspendedEndpoint.element,n.targetId=n.suspendedEndpoint.elementId),n.suspendedEndpoint.addConnection(n),n.endpoints[0].repaint(),n.repaint(),o.repaint(n.sourceId),n._forceDetach=!1);c()};i=i&&this.isDropAllowed(n.sourceId,n.targetId,n.scope,n,this);i?w():b()}o.currentlyDragging=!1}}.bind(this);u[f]=h.wrap(u[f],y);u[c]=h.wrap(u[c],function(){var u=s.getDragObject(arguments),f=o.getAttribute(u,"dragId"),n=a[f],t,r,i;n!=null&&(t=n.floatingAnchorIndex==null?1:n.floatingAnchorIndex,r=this.isTarget&&n.floatingAnchorIndex!==0||n.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==n.suspendedEndpoint.id,r&&(i=o.checkCondition("checkDropAllowed",{sourceEndpoint:n.endpoints[t],targetEndpoint:this,connection:n}),this[(i?"add":"remove")+"Class"](o.endpointDropAllowedClass),this[(i?"remove":"add")+"Class"](o.endpointDropForbiddenClass),n.endpoints[t].anchor.over(this.anchor,this)))}.bind(this));u[v]=h.wrap(u[v],function(){var r=s.getDragObject(arguments),u=o.getAttribute(r,"dragId"),n=a[u],t,i;n!=null&&(t=n.floatingAnchorIndex==null?1:n.floatingAnchorIndex,i=this.isTarget&&n.floatingAnchorIndex!==0||n.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==n.suspendedEndpoint.id,i&&(this.removeClass(o.endpointDropAllowedClass),this.removeClass(o.endpointDropForbiddenClass),n.endpoints[t].anchor.out()))}.bind(this));s.initDroppable(n,u,!0,i)}}.bind(this),p(l(this.canvas),!0,!(e._transient||this.anchor.isFloating),this),e.type&&this.addType(e.type,e.data,o.isSuspendDrawing()),this};jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n,t,i){var r,u;if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!t)for(r=0;r<this.connections.length;r++)this.connections[r].setVisible(n),i||(u=this===this.connections[r].endpoints[0]?1:0,this.connections[r].endpoints[u].connections.length==1&&this.connections[r].endpoints[u].setVisible(n,!0,!0))},getAttachedElements:function(){return this.connections},applyType:function(t){t.maxConnections!=null&&(this._jsPlumb.maxConnections=t.maxConnections);t.scope&&(this.scope=t.scope);jsPlumbUtil.copyValues(n,t,this);t.anchor&&(this.anchor=this._jsPlumb.instance.makeAnchor(t.anchor))},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(n){this._jsPlumb.enabled=n},cleanup:function(){jsPlumb.CurrentLibrary.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this.anchor=null;this.endpoint.cleanup();this.endpoint.destroy();this.endpoint=null;var n=jsPlumb.CurrentLibrary.getElementObject(this.canvas);jsPlumb.CurrentLibrary.destroyDraggable(n);jsPlumb.CurrentLibrary.destroyDroppable(n)},setHover:function(n){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(n)},isFull:function(){return!(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(n){this._jsPlumb.connectionCost=n},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(n){this._jsPlumb.connectionsDirected=n},setElementId:function(n){this.elementId=n;this.anchor.elementId=n},setReferenceElement:function(n){this.element=jsPlumb.CurrentLibrary.getDOMElement(n)},setDragAllowedWhenFull:function(n){this.dragAllowedWhenFull=n},equals:function(n){return this.anchor.equals(n.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(n){return this.anchor.compute(n)}})}(),function(){var t=function(n,t,i,r){if(!n.Defaults.DoNotThrowErrors&&jsPlumb.Connectors[t][i]==null)throw{msg:"jsPlumb: unknown connector type '"+i+"'"};return new jsPlumb.Connectors[t][i](r)},n=function(n,t,i){return n?i.makeAnchor(n,t,i):null},i=function(t,i,r,u,f,e,o,s,h,c){var v,y,l,a,p,w;return u?(r.endpoints[f]=u,u.addConnection(r)):(e.endpoints||(e.endpoints=[null,null]),y=e.endpoints[f]||e.endpoint||t.Defaults.Endpoints[f]||jsPlumb.Defaults.Endpoints[f]||t.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,e.endpointStyles||(e.endpointStyles=[null,null]),e.endpointHoverStyles||(e.endpointHoverStyles=[null,null]),l=e.endpointStyles[f]||e.endpointStyle||t.Defaults.EndpointStyles[f]||jsPlumb.Defaults.EndpointStyles[f]||t.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,l.fillStyle==null&&h!=null&&(l.fillStyle=h.strokeStyle),l.outlineColor==null&&h!=null&&(l.outlineColor=h.outlineColor),l.outlineWidth==null&&h!=null&&(l.outlineWidth=h.outlineWidth),a=e.endpointHoverStyles[f]||e.endpointHoverStyle||t.Defaults.EndpointHoverStyles[f]||jsPlumb.Defaults.EndpointHoverStyles[f]||t.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,c!=null&&(a==null&&(a={}),a.fillStyle==null&&(a.fillStyle=c.strokeStyle)),p=e.anchors?e.anchors[f]:e.anchor?e.anchor:n(t.Defaults.Anchors[f],s,t)||n(jsPlumb.Defaults.Anchors[f],s,t)||n(t.Defaults.Anchor,s,t)||n(jsPlumb.Defaults.Anchor,s,t),w=e.uuids?e.uuids[f]:null,v=i({paintStyle:l,hoverPaintStyle:a,endpoint:y,connections:[r],uuid:w,anchor:p,source:o,scope:e.scope,container:e.container,reattach:e.reattach||t.Defaults.ReattachConnections,detachable:e.detachable||t.Defaults.ConnectionsDetachable}),r.endpoints[f]=v,e.drawEndpoints===!1&&v.setVisible(!1,!0,!0)),v};jsPlumb.Connection=function(n){var g=n.newConnection,v=n.newEndpoint,r=jsPlumb.CurrentLibrary,nt=r.getAttribute,tt=r.getElementObject,y=r.getDOMElement,p=jsPlumbUtil,it=r.getOffset,t,h,c,u,s,a;if(this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=n.parent,this.previousConnection=n.previousConnection,this.source=y(n.source),this.target=y(n.target),n.sourceEndpoint&&(this.source=n.sourceEndpoint.endpointWillMoveTo||n.sourceEndpoint.getElement()),n.targetEndpoint&&(this.target=n.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=n.scope,this.endpoints=[],this.endpointStyles=[],t=this._jsPlumb.instance,this._jsPlumb.visible=!0,this._jsPlumb.editable=n.editable===!0,this._jsPlumb.params={parent:n.parent,cssClass:n.cssClass,container:n.container,"pointer-events":n["pointer-events"],editorParams:n.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}},h=i(t,v,this,n.sourceEndpoint,0,n,this.source,this.sourceId,n.paintStyle,n.hoverPaintStyle),h&&p.addToList(n.endpointsByElement,this.sourceId,h),c=i(t,v,this,n.targetEndpoint,1,n,this.target,this.targetId,n.paintStyle,n.hoverPaintStyle),c&&p.addToList(n.endpointsByElement,this.targetId,c),this.scope||(this.scope=this.endpoints[0].scope),n.deleteEndpointsOnDetach!=null?(this.endpoints[0]._deleteOnDetach=n.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=n.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||n.connector||t.Defaults.Connector||jsPlumb.Defaults.Connector,!0),n.path&&this.connector.setPath(n.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||n.paintStyle||t.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||n.hoverPaintStyle||t.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),u=t.getSuspendedAt(),t.updateOffset({elId:this.sourceId,timestamp:u}),t.updateOffset({elId:this.targetId,timestamp:u}),!t.isSuspendDrawing()){var w=t.getCachedData(this.sourceId),f=w.o,b=w.s,k=t.getCachedData(this.targetId),e=k.o,d=k.s,o=u||t.timestamp(),l=this.endpoints[0].anchor.compute({xy:[f.left,f.top],wh:b,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[e.left,e.top],twh:d,tElement:this.endpoints[1],timestamp:o});this.endpoints[0].paint({anchorLoc:l,timestamp:o});l=this.endpoints[1].anchor.compute({xy:[e.left,e.top],wh:d,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[f.left,f.top],twh:b,tElement:this.endpoints[0],timestamp:o});this.endpoints[1].paint({anchorLoc:l,timestamp:o})}this._jsPlumb.detachable=t.Defaults.ConnectionsDetachable;n.detachable===!1&&(this._jsPlumb.detachable=!1);this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1);this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1);this._jsPlumb.reattach=n.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||t.Defaults.ReattachConnections;this._jsPlumb.cost=n.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=n.directed;n.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());s=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(s,this.endpoints[0].getParameters());jsPlumb.extend(s,this.getParameters());this.setParameters(s);a=n.type||this.endpoints[0].connectionType||this.endpoints[1].connectionType;a&&this.addType(a,n.data,!0)};jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(n,t){n.detachable!=null&&this.setDetachable(n.detachable);n.reattach!=null&&this.setReattach(n.reattach);n.scope&&(this.scope=n.scope);this.setConnector(n.connector,t)},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(n,t){t&&(this.endpoints[0].addClass(n),this.endpoints[1].addClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(n));this.connector&&this.connector.addClass(n)},removeClass:function(n,t){t&&(this.endpoints[0].removeClass(n),this.endpoints[1].removeClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(n));this.connector&&this.connector.removeClass(n)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n){this._jsPlumb.visible=n;this.connector&&this.connector.setVisible(n);this.repaint()},cleanup:function(){this.endpoints=null;this.source=null;this.target=null;this.connector!=null&&(this.connector.cleanup(),this.connector.destroy());this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(n){this._jsPlumb.detachable=n===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(n){this._jsPlumb.reattach=n===!0},setHover:function(n){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(n),jsPlumb.CurrentLibrary[n?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumb.CurrentLibrary[n?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(n){this._jsPlumb.cost=n},isDirected:function(){return this._jsPlumb.directed===!0},moveParent:function(n){var i=jsPlumb.CurrentLibrary,r=i.getParent(this.connector.canvas),t;for(this.connector.bgCanvas&&(i.removeElement(this.connector.bgCanvas),i.appendElement(this.connector.bgCanvas,n)),i.removeElement(this.connector.canvas),i.appendElement(this.connector.canvas,n),t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].isAppendedAtTopLevel&&(i.removeElement(this._jsPlumb.overlays[t].canvas),i.appendElement(this._jsPlumb.overlays[t].canvas,n),this._jsPlumb.overlays[t].reattachListeners&&this._jsPlumb.overlays[t].reattachListeners(this.connector));this.connector.reattachListeners&&this.connector.reattachListeners()},getConnector:function(){return this.connector},setConnector:function(n,i){var f=jsPlumbUtil,r,u;this.connector!=null&&(this.connector.cleanup(),this.connector.destroy());r={_jsPlumb:this._jsPlumb.instance,parent:this._jsPlumb.params.parent,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]};u=this._jsPlumb.instance.getRenderMode();f.isString(n)?this.connector=t(this._jsPlumb.instance,u,n,r):f.isArray(n)&&(this.connector=n.length==1?t(this._jsPlumb.instance,u,n[0],r):t(this._jsPlumb.instance,u,n[0],f.merge(n[1],r)));this.bindListeners(this.connector,this,function(n){this.setHover(n,!1)}.bind(this));this.canvas=this.connector.canvas;this._jsPlumb.editable&&jsPlumb.ConnectorEditors!=null&&jsPlumb.ConnectorEditors[this.connector.type]&&this.connector.isEditable()?new jsPlumb.ConnectorEditors[this.connector.type]({connector:this.connector,connection:this,params:this._jsPlumb.params.editorParams||{}}):this._jsPlumb.editable=!1;i||this.repaint()},paint:function(n){var w,b,t,i,s,e,v;if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){n=n||{};var it=n.elId,d=n.ui,g=n.recalc,r=n.timestamp,o=!1,nt=o?this.sourceId:this.targetId,tt=o?this.targetId:this.sourceId,y=o?0:1,p=o?1:0;if(r==null||r!=this._jsPlumb.lastPaintedAt){var u=this._jsPlumb.instance.updateOffset({elId:tt,offset:d,recalc:g,timestamp:r}).o,f=this._jsPlumb.instance.updateOffset({elId:nt,timestamp:r}).o,l=this.endpoints[p],a=this.endpoints[y];for(n.clearEdits&&(this._jsPlumb.overlayPositions=null,l.anchor.clearUserDefinedLocation(),a.anchor.clearUserDefinedLocation(),this.connector.setEdited(!1)),w=l.anchor.getCurrentLocation({xy:[u.left,u.top],wh:[u.width,u.height],element:l,timestamp:r}),b=a.anchor.getCurrentLocation({xy:[f.left,f.top],wh:[f.width,f.height],element:a,timestamp:r}),this.connector.resetBounds(),this.connector.compute({sourcePos:w,targetPos:b,sourceEndpoint:this.endpoints[p],targetEndpoint:this.endpoints[y],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:u,targetInfo:f,clearEdits:n.clearEdits===!0}),t={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity},i=0;i<this._jsPlumb.overlays.length;i++)s=this._jsPlumb.overlays[i],s.isVisible()&&(this._jsPlumb.overlayPlacements[i]=s.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(s)),t.minX=Math.min(t.minX,this._jsPlumb.overlayPlacements[i].minX),t.maxX=Math.max(t.maxX,this._jsPlumb.overlayPlacements[i].maxX),t.minY=Math.min(t.minY,this._jsPlumb.overlayPlacements[i].minY),t.maxY=Math.max(t.maxY,this._jsPlumb.overlayPlacements[i].maxY));var h=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,c=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),k={xmin:Math.min(this.connector.bounds.minX-(h+c),t.minX),ymin:Math.min(this.connector.bounds.minY-(h+c),t.minY),xmax:Math.max(this.connector.bounds.maxX+(h+c),t.maxX),ymax:Math.max(this.connector.bounds.maxY+(h+c),t.maxY)};for(this.connector.paint(this._jsPlumb.paintStyleInUse,null,k),e=0;e<this._jsPlumb.overlays.length;e++)v=this._jsPlumb.overlays[e],v.isVisible()&&v.paint(this._jsPlumb.overlayPlacements[e],k)}this._jsPlumb.lastPaintedAt=r}},repaint:function(n){n=n||{};this.paint({elId:this.sourceId,recalc:!(n.recalc===!1),timestamp:n.timestamp,clearEdits:n.clearEdits})}})}(),function(){var i,n,t;jsPlumb.AnchorManager=function(n){var u={},c={},l={},o={},v={},s={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},t={},f=this,i={},r=n.jsPlumbInstance,w=jsPlumb.CurrentLibrary,a={},b=function(n,t,i,r,u,f){if(n===t)return{orientation:s.IDENTITY,a:["top","top"]};var h=Math.atan2(r.centery-i.centery,r.centerx-i.centerx),c=Math.atan2(i.centery-r.centery,i.centerx-r.centerx),o=i.left<=r.left&&i.right>=r.left||i.left<=r.right&&i.right>=r.right||i.left<=r.left&&i.right>=r.right||r.left<=i.left&&r.right>=i.right,l=i.top<=r.top&&i.bottom>=r.top||i.top<=r.bottom&&i.bottom>=r.bottom||i.top<=r.top&&i.bottom>=r.bottom||r.top<=i.top&&r.bottom>=i.bottom,a=function(n){return[u.isContinuous?u.verifyEdge(n[0]):n[0],f.isContinuous?f.verifyEdge(n[1]):n[1]]},e={orientation:s.DIAGONAL,theta:h,theta2:c};return o||l?o?(e.orientation=s.HORIZONTAL,e.a=i.top<r.top?["bottom","top"]:["top","bottom"]):(e.orientation=s.VERTICAL,e.a=i.left<r.left?["right","left"]:["left","right"]):r.left>i.left&&r.top>i.top?e.a=["right","top"]:r.left>i.left&&i.top>r.top?e.a=["top","left"]:r.left<i.left&&r.top<i.top?e.a=["top","right"]:r.left<i.left&&r.top>i.top&&(e.a=["left","top"]),e.a=a(e.a),e},k=function(n,t,i,r,u,f,e){for(var s,h,c=[],v=t[u?0:1]/(r.length+1),o=0;o<r.length;o++){s=(o+1)*v;h=f*t[u?1:0];e&&(s=t[u?0:1]-s);var l=u?s:h,y=i[0]+l,p=l/t[0],a=u?h:s,w=i[1]+a,b=a/t[1];c.push([y,w,p,b,r[o][1],r[o][2]])}return c},y=function(n){return function(t,i){var r=!0;return r=n?t[0][0]<i[0][0]:t[0][0]>i[0][0],r===!1?-1:1}},d=function(n,t){var i=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0],r=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return i>r?1:n[0][1]>t[0][1]?1:-1},g={top:function(n,t){return n[0]>t[0]?1:-1},right:y(!0),bottom:y(!0),left:d},nt=function(n,t){return n.sort(t)},tt=function(n,t){var e=r.getCachedData(n),u=e.s,i=e.o,f=function(t,i,u,f,e,o,s){var h;if(f.length>0){var p=nt(f,g[t]),w=t==="right"||t==="top",c=k(t,i,u,p,e,o,w),y=function(n,t){var i=r.adjustForParentOffsetAndScroll([t[0],t[1]],n.canvas);l[n.id]=[i[0],i[1],t[2],t[3]];v[n.id]=s};for(h=0;h<c.length;h++){var a=c[h][4],b=a.endpoints[0].elementId===n,d=a.endpoints[1].elementId===n;b?y(a.endpoints[0],c[h]):d&&y(a.endpoints[1],c[h])}}};f("bottom",u,[i.left,i.top],t.bottom,!0,1,[0,1]);f("top",u,[i.left,i.top],t.top,!0,0,[0,-1]);f("left",u,[i.left,i.top],t.left,!1,0,[-1,0]);f("right",u,[i.left,i.top],t.right,!1,1,[1,0])},h,e,p;this.reset=function(){u={};t={};i={}};this.addFloatingConnection=function(n,t){a[n]=t};this.removeFloatingConnection=function(n){delete a[n]};this.newConnection=function(n){var r=n.sourceId,u=n.targetId,i=n.endpoints,f=!0,e=function(n,e,o,s,h){r==u&&o.isContinuous&&(w.removeElement(i[1].canvas),f=!1);jsPlumbUtil.addToList(t,s,[h,e,o.constructor==jsPlumb.DynamicAnchor])};e(0,i[0],i[0].anchor,u,n);f&&e(1,i[1],i[1].anchor,r,n)};h=function(n){(function(n,t){if(n){var i=function(n){return n[4]==t};jsPlumbUtil.removeWithFunction(n.top,i);jsPlumbUtil.removeWithFunction(n.left,i);jsPlumbUtil.removeWithFunction(n.bottom,i);jsPlumbUtil.removeWithFunction(n.right,i)}})(i[n.elementId],n.id)};this.connectionDetached=function(n){var i=n.connection||n,e=n.sourceId,o=n.targetId,r=i.endpoints,u=function(n,i,r,u,f){r!=null&&r.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(t[u],function(n){return n[0].id==f.id})};u(1,r[1],r[1].anchor,e,i);u(0,r[0],r[0].anchor,o,i);h(i.endpoints[0]);h(i.endpoints[1]);f.redraw(i.sourceId);f.redraw(i.targetId)};this.add=function(n,t){jsPlumbUtil.addToList(u,t,n)};this.changeId=function(n,i){t[i]=t[n];u[i]=u[n];delete t[n];delete u[n]};this.getConnectionsFor=function(n){return t[n]||[]};this.getEndpointsFor=function(n){return u[n]||[]};this.deleteEndpoint=function(n){jsPlumbUtil.removeWithFunction(u[n.elementId],function(t){return t.id==n.id});h(n)};this.clearFor=function(n){delete u[n];u[n]=[]};e=function(t,i,r,u,f,e,o,s,h,c,l,a){var g=-1,w=-1,b=u.endpoints[o],nt=b.id,k=[1,0][o],tt=[[i,r],u,f,e,nt],y=t[h],p=b._continuousAnchorEdge?t[b._continuousAnchorEdge]:null,d,v,it;if(p&&(d=jsPlumbUtil.findWithFunction(p,function(n){return n[4]==nt}),d!=-1))for(p.splice(d,1),v=0;v<p.length;v++)jsPlumbUtil.addWithFunction(l,p[v][1],function(n){return n.id==p[v][1].id}),jsPlumbUtil.addWithFunction(a,p[v][1].endpoints[o],function(n){return n.id==p[v][1].endpoints[o].id}),jsPlumbUtil.addWithFunction(a,p[v][1].endpoints[k],function(n){return n.id==p[v][1].endpoints[k].id});for(v=0;v<y.length;v++)n.idx==1&&y[v][3]===e&&w==-1&&(w=v),jsPlumbUtil.addWithFunction(l,y[v][1],function(n){return n.id==y[v][1].id}),jsPlumbUtil.addWithFunction(a,y[v][1].endpoints[o],function(n){return n.id==y[v][1].endpoints[o].id}),jsPlumbUtil.addWithFunction(a,y[v][1].endpoints[k],function(n){return n.id==y[v][1].endpoints[k].id});g!=-1?y[g]=tt:(it=s?w!=-1?w:0:y.length,y.splice(it,0,tt));b._continuousAnchorEdge=h};this.updateOtherEndpoint=function(n,i,r,u){var f=jsPlumbUtil.findWithFunction(t[n],function(n){return n[0].id===u.id}),e=jsPlumbUtil.findWithFunction(t[i],function(n){return n[0].id===u.id});f!=-1&&(t[n][f][0]=u,t[n][f][1]=u.endpoints[1],t[n][f][2]=u.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor);e>-1&&(t[i].splice(e,1),jsPlumbUtil.addToList(t,r,[u,u.endpoints[0],u.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))};this.sourceChanged=function(n,i,r){jsPlumbUtil.removeWithFunction(t[n],function(n){return n[0].id===r.id});var u=jsPlumbUtil.findWithFunction(t[r.targetId],function(n){return n[0].id===r.id});u>-1&&(t[r.targetId][u][0]=r,t[r.targetId][u][1]=r.endpoints[0],t[r.targetId][u][2]=r.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor);jsPlumbUtil.addToList(t,i,[r,r.endpoints[1],r.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])};this.rehomeEndpoint=function(n,t,i){var s=u[t]||[],h=r.getId(i),o,c,e;for(h!==t&&(o=jsPlumbUtil.indexOf(s,n),o>-1&&(c=s.splice(o,1)[0],f.add(c,h))),e=0;e<n.connections.length;e++)n.connections[e].sourceId==t?(n.connections[e].sourceId=n.elementId,n.connections[e].source=n.element,f.sourceChanged(t,n.elementId,n.connections[e])):n.connections[e].targetId==t&&(n.connections[e].targetId=n.elementId,n.connections[e].target=n.element,f.updateOtherEndpoint(n.connections[e].sourceId,t,n.elementId,n.connections[e]))};this.redraw=function(n,f,o,s,h,c){var st,ht,l,vt,yt,ct,g,et,lt,pt;if(!r.isSuspendDrawing()){var nt=u[n]||[],k=t[n]||[],w=[],d=[],rt=[];for(o=o||r.timestamp(),s=s||{left:0,top:0},f&&(f={left:f.left+s.left,top:f.top+s.top}),st=r.updateOffset({elId:n,offset:f,recalc:!1,timestamp:o}),ht={},l=0;l<k.length;l++){var p=k[l][0],v=p.sourceId,y=p.targetId,ut=p.endpoints[0].anchor.isContinuous,ft=p.endpoints[1].anchor.isContinuous;if(ut||ft){var at=v+"_"+y,wt=y+"_"+v,it=ht[at],ot=p.sourceId==n?1:0;ut&&!i[v]&&(i[v]={top:[],right:[],bottom:[],left:[]});ft&&!i[y]&&(i[y]={top:[],right:[],bottom:[],left:[]});n!=y&&r.updateOffset({elId:y,timestamp:o});n!=v&&r.updateOffset({elId:v,timestamp:o});vt=r.getCachedData(y);yt=r.getCachedData(v);y==v&&(ut||ft)?e(i[v],-Math.PI/2,0,p,!1,y,0,!1,"top",v,w,d):(it||(it=b(v,y,yt.o,vt.o,p.endpoints[0].anchor,p.endpoints[1].anchor),ht[at]=it),ut&&e(i[v],it.theta,0,p,!1,y,0,!1,it.a[0],v,w,d),ft&&e(i[y],it.theta2,-1,p,!0,v,1,!0,it.a[1],y,w,d));ut&&jsPlumbUtil.addWithFunction(rt,v,function(n){return n===v});ft&&jsPlumbUtil.addWithFunction(rt,y,function(n){return n===y});jsPlumbUtil.addWithFunction(w,p,function(n){return n.id==p.id});(ut&&ot===0||ft&&ot===1)&&jsPlumbUtil.addWithFunction(d,p.endpoints[ot],function(n){return n.id==p.endpoints[ot].id})}}for(l=0;l<nt.length;l++)nt[l].connections.length===0&&nt[l].anchor.isContinuous&&(i[n]||(i[n]={top:[],right:[],bottom:[],left:[]}),e(i[n],-Math.PI/2,0,{endpoints:[nt[l],nt[l]],paint:function(){}},!1,n,0,!1,"top",n,w,d),jsPlumbUtil.addWithFunction(rt,n,function(t){return t===n}));for(l=0;l<rt.length;l++)tt(rt[l],i[rt[l]]);for(l=0;l<nt.length;l++)nt[l].paint({timestamp:o,offset:st,dimensions:st.s,recalc:c!==!0});for(l=0;l<d.length;l++)ct=r.getCachedData(d[l].elementId),d[l].paint({timestamp:o,offset:ct,dimensions:ct.s});for(l=0;l<k.length;l++)if(g=k[l][1],g.anchor.constructor==jsPlumb.DynamicAnchor)for(g.paint({elementWithPrecedence:n,timestamp:o}),jsPlumbUtil.addWithFunction(w,k[l][0],function(n){return n.id==k[l][0].id}),et=0;et<g.connections.length;et++)g.connections[et]!==k[l][0]&&jsPlumbUtil.addWithFunction(w,g.connections[et],function(n){return n.id==g.connections[et].id});else g.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(w,k[l][0],function(n){return n.id==k[l][0].id});for(lt=a[n],lt&&lt.paint({timestamp:o,recalc:!1,elId:n}),l=0;l<w.length;l++)pt=o,w[l].paint({elId:n,timestamp:pt,recalc:!1,clearEdits:h})}};p=function(n){var i;jsPlumbUtil.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=!0;this.isContinuous=!0;var r=n.faces||["top","right","bottom","left"],u=!(n.clockwise===!1),t={},f={top:"bottom",right:"left",left:"right",bottom:"top"},e={top:"right",right:"bottom",left:"top",bottom:"left"},s={top:"left",right:"top",left:"bottom",bottom:"right"},h=u?e:s,c=u?s:e,a=n.cssClass||"";for(i=0;i<r.length;i++)t[r[i]]=!0;this.verifyEdge=function(n){return t[n]?n:t[f[n]]?f[n]:t[h[n]]?h[n]:t[c[n]]?c[n]:n};this.compute=function(n){return o[n.element.id]||l[n.element.id]||[0,0]};this.getCurrentLocation=function(n){return o[n.element.id]||l[n.element.id]||[0,0]};this.getOrientation=function(n){return v[n.id]||[0,0]};this.clearUserDefinedLocation=function(){delete o[n.elementId]};this.setUserDefinedLocation=function(t){o[n.elementId]=t};this.getCssClass=function(){return a};this.setCssClass=function(n){a=n}};r.continuousAnchorFactory={get:function(n){var t=c[n.elementId];return t||(t=new p(n),c[n.elementId]=t),t},clear:function(n){delete c[n]}}};jsPlumb.Anchor=function(n){this.x=n.x||0;this.y=n.y||0;this.elementId=n.elementId;this.cssClass=n.cssClass||"";this.userDefinedLocation=null;this.orientation=n.orientation||[0,0];jsPlumbUtil.EventGenerator.apply(this);var t=n.jsPlumbInstance;this.lastReturnValue=null;this.offsets=n.offsets||[0,0];this.timestamp=null;this.compute=function(n){var r=n.xy,u=n.wh,f=n.element,i=n.timestamp;return(n.clearUserDefinedLocation&&(this.userDefinedLocation=null),i&&i===self.timestamp)?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:(this.lastReturnValue=[r[0]+this.x*u[0]+this.offsets[0],r[1]+this.y*u[1]+this.offsets[1]],this.lastReturnValue=t.adjustForParentOffsetAndScroll(this.lastReturnValue,f.canvas)),this.timestamp=i,this.lastReturnValue)};this.getCurrentLocation=function(n){return this.lastReturnValue==null||n.timestamp!=null&&this.timestamp!=n.timestamp?this.compute(n):this.lastReturnValue}};jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(n){if(!n)return!1;var t=n.getOrientation(),i=this.getOrientation();return this.x==n.x&&this.y==n.y&&this.offsets[0]==n.offsets[0]&&this.offsets[1]==n.offsets[1]&&i[0]==t[0]&&i[1]==t[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(n){this.userDefinedLocation=n},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});jsPlumb.FloatingAnchor=function(n){jsPlumb.Anchor.apply(this,arguments);var f=n.reference,r=jsPlumb.CurrentLibrary,e=n.jsPlumbInstance,o=n.referenceCanvas,u=r.getSize(r.getElementObject(o)),s=0,h=0,t=null,i=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=!0;this.compute=function(n){var r=n.xy,f=n.element,t=[r[0]+u[0]/2,r[1]+u[1]/2];return t=e.adjustForParentOffsetAndScroll(t,f.canvas),i=t,t};this.getOrientation=function(n){if(t)return t;var i=f.getOrientation(n);return[Math.abs(i[0])*s*-1,Math.abs(i[1])*h*-1]};this.over=function(n,i){t=n.getOrientation(i)};this.out=function(){t=null};this.getCurrentLocation=function(n){return i==null?this.compute(n):i}};jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);i=function(n,t,i){return n.constructor==jsPlumb.Anchor?n:t.makeAnchor(n,i,t)};jsPlumb.DynamicAnchor=function(n){var r;for(jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance,r=0;r<n.anchors.length;r++)this.anchors[r]=i(n.anchors[r],this.jsPlumbInstance,this.elementId);this.addAnchor=function(n){this.anchors.push(i(n,this.jsPlumbInstance,this.elementId))};this.getAnchors=function(){return this.anchors};this.locked=!1;var t=this.anchors.length>0?this.anchors[0]:null,s=this.anchors.length>0?0:-1,u=t,f=this,e=function(n,t,i,r,u){var f=r[0]+n.x*u[0],e=r[1]+n.y*u[1],o=r[0]+u[0]/2,s=r[1]+u[1]/2;return Math.sqrt(Math.pow(t-f,2)+Math.pow(i-e,2))+Math.sqrt(Math.pow(o-f,2)+Math.pow(s-e,2))},o=n.selector||function(n,t,i,r,u){for(var o,c=i[0]+r[0]/2,l=i[1]+r[1]/2,s=-1,h=Infinity,f=0;f<u.length;f++)o=e(u[f],c,l,n,t),o<h&&(s=f+0,h=o);return u[s]};this.compute=function(n){var s=n.xy,h=n.wh,c=n.timestamp,r=n.txy,e=n.twh,i;return(n.clearUserDefinedLocation&&(userDefinedLocation=null),this.timestamp=c,i=f.getUserDefinedLocation(),i!=null)?i:this.locked||r==null||e==null?t.compute(n):(n.timestamp=null,t=o(s,h,r,e,this.anchors),this.x=t.x,this.y=t.y,t!=u&&this.fire("anchorChanged",t),u=t,t.compute(n))};this.getCurrentLocation=function(n){return this.getUserDefinedLocation()||(t!=null?t.getCurrentLocation(n):null)};this.getOrientation=function(n){return t!=null?t.getOrientation(n):[0,0]};this.over=function(n,i){t!=null&&t.over(n,i)};this.out=function(){t!=null&&t.out()};this.getCssClass=function(){return t&&t.getCssClass()||""}};jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);n=function(n,t,i,r,u,f){jsPlumb.Anchors[u]=function(e){var o=e.jsPlumbInstance.makeAnchor([n,t,i,r,0,0],e.elementId,e.jsPlumbInstance);return o.type=u,f&&f(o,e),o}};n(.5,0,0,-1,"TopCenter");n(.5,1,0,1,"BottomCenter");n(0,.5,-1,0,"LeftMiddle");n(1,.5,1,0,"RightMiddle");n(.5,0,0,-1,"Top");n(.5,1,0,1,"Bottom");n(0,.5,-1,0,"Left");n(1,.5,1,0,"Right");n(.5,.5,0,0,"Center");n(1,0,0,-1,"TopRight");n(1,1,0,1,"BottomRight");n(0,0,0,-1,"TopLeft");n(0,1,0,1,"BottomLeft");jsPlumb.Defaults.DynamicAnchors=function(n){return n.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],n.elementId,n.jsPlumbInstance)};jsPlumb.Anchors.AutoDefault=function(n){var t=n.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(n));return t.type="AutoDefault",t};t=function(n,t){jsPlumb.Anchors[n]=function(i){var r=i.jsPlumbInstance.makeAnchor(["Continuous",{faces:t}],i.elementId,i.jsPlumbInstance);return r.type=n,r}};jsPlumb.Anchors.Continuous=function(n){return n.jsPlumbInstance.continuousAnchorFactory.get(n)};t("ContinuousLeft",["left"]);t("ContinuousTop",["top"]);t("ContinuousBottom",["bottom"]);t("ContinuousRight",["right"]);n(0,0,0,0,"Assign",function(n,t){var i=t.position||"Fixed";n.positionFinder=i.constructor==String?t.jsPlumbInstance.AnchorPositionFinders[i]:i;n.constructorParams=t});jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(n,t,i){return[(n.left-t.left)/i[0],(n.top-t.top)/i[1]]},Grid:function(n,t,i,r){var e=n.left-t.left,o=n.top-t.top,u=i[0]/r.grid[0],f=i[1]/r.grid[1],s=Math.floor(e/u),h=Math.floor(o/f);return[(s*u+u/2)/i[0],(h*f+f/2)/i[1]]}};jsPlumb.Anchors.Perimeter=function(n){var t,i,r,f;if(n=n||{},t=n.anchorCount||60,i=n.shape,!i)throw new Error("no shape supplied to Perimeter Anchor type");var e=function(){for(var f,e,n=.5,o=Math.PI*2/t,i=0,r=[],u=0;u<t;u++)f=n+n*Math.sin(i),e=n+n*Math.cos(i),r.push([f,e,0,0]),i+=o;return r},o=function(n){for(var i=t/n.length,u=[],f=function(n,r,f,e,o){var h,c,s;for(i=t*o,h=(f-n)/i,c=(e-r)/i,s=0;s<i;s++)u.push([n+h*s,r+c*s,0,0])},r=0;r<n.length;r++)f.apply(null,n[r]);return u},u=function(n){for(var i=[],t=0;t<n.length;t++)i.push([n[t][0],n[t][1],n[t][2],n[t][3],1/n.length]);return o(i)},s=function(){return u([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},h={Circle:e,Ellipse:e,Diamond:function(){return u([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return u([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(n){for(var f,u,i=n.points,r=[],e=0,t=0;t<i.length-1;t++)f=Math.sqrt(Math.pow(i[t][2]-i[t][0])+Math.pow(i[t][3]-i[t][1])),e+=f,r.push([i[t][0],i[t][1],i[t+1][0],i[t+1][1],f]);for(u=0;u<r.length;u++)r[u][4]=r[u][4]/e;return o(r)}},c=function(n,t){for(var u,f,e=[],r=t/180*Math.PI,i=0;i<n.length;i++)u=n[i][0]-.5,f=n[i][1]-.5,e.push([.5+(u*Math.cos(r)-f*Math.sin(r)),.5+(u*Math.sin(r)+f*Math.cos(r)),n[i][2],n[i][3]]);return e};if(!h[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");return r=h[i](n),n.rotation&&(r=c(r,n.rotation)),f=n.jsPlumbInstance.makeDynamicAnchor(r),f.type="Perimeter",f}}(),function(){var i,e,u,t,n,f,r;jsPlumb.DOMElementComponent=jsPlumbUtil.extend(jsPlumb.jsPlumbUIComponent,function(){this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(){}});jsPlumb.Segments={AbstractSegment:function(n){this.params=n;this.findClosestPointOnPath=function(){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}}},Straight:function(n){var l=jsPlumb.Segments.AbstractSegment.apply(this,arguments),e,f,h,t,r,i,u,c=function(){e=Math.sqrt(Math.pow(r-t,2)+Math.pow(u-i,2));f=jsPlumbGeom.gradient({x:t,y:i},{x:r,y:u});h=-1/f},o,s;this.type="Straight";this.getLength=function(){return e};this.getGradient=function(){return f};this.getCoordinates=function(){return{x1:t,y1:i,x2:r,y2:u}};this.setCoordinates=function(n){t=n.x1;i=n.y1;r=n.x2;u=n.y2;c()};this.setCoordinates({x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2});this.getBounds=function(){return{minX:Math.min(t,r),minY:Math.min(i,u),maxX:Math.max(t,r),maxY:Math.max(i,u)}};this.pointOnPath=function(n,f){if(n!==0||f){if(n!=1||f){var o=f?n>0?n:e+n:n*e;return jsPlumbGeom.pointOnLine({x:t,y:i},{x:r,y:u},o)}return{x:r,y:u}}return{x:t,y:i}};this.gradientAtPoint=function(){return f};this.pointAlongPathFrom=function(n,f,e){var o=this.pointOnPath(n,e),s=f<=0?{x:t,y:i}:{x:r,y:u};return f<=0&&Math.abs(f)>1&&(f*=-1),jsPlumbGeom.pointOnLine(o,s,f)};o=function(n,t,i){return i>=Math.min(n,t)&&i<=Math.max(n,t)};s=function(n,t,i){return Math.abs(i-n)<Math.abs(i-t)?n:t};this.findClosestPointOnPath=function(n,c){var l={d:Infinity,x:null,y:null,l:null,x1:t,x2:r,y1:i,y2:u},p;if(f===0)l.y=i,l.x=o(t,r,n)?n:s(t,r,n);else if(f==Infinity||f==-Infinity)l.x=t,l.y=o(i,u,c)?c:s(i,u,c);else{var y=i-f*t,w=c-h*n,a=(w-y)/(f-h),v=f*a+y;l.x=o(t,r,a)?a:s(t,r,a);l.y=o(i,u,v)?v:s(i,u,v)}return p=jsPlumbGeom.lineLength([l.x,l.y],[t,i]),l.d=jsPlumbGeom.lineLength([n,c],[l.x,l.y]),l.l=p/e,l}},Arc:function(n){var c=jsPlumb.Segments.AbstractSegment.apply(this,arguments),u=function(t,i){return jsPlumbGeom.theta([n.cx,n.cy],[t,i])},s=function(n,i){var r,u,f,e;return n.anticlockwise?(r=n.startAngle<n.endAngle?n.startAngle+t:n.startAngle,u=Math.abs(r-n.endAngle),r-u*i):(f=n.endAngle<n.startAngle?n.endAngle+t:n.endAngle,e=Math.abs(f-n.startAngle),n.startAngle+e*i)},t=2*Math.PI,f,i,r;this.radius=n.r;this.anticlockwise=n.ac;this.type="Arc";n.startAngle&&n.endAngle?(this.startAngle=n.startAngle,this.endAngle=n.endAngle,this.x1=n.cx+this.radius*Math.cos(n.startAngle),this.y1=n.cy+this.radius*Math.sin(n.startAngle),this.x2=n.cx+this.radius*Math.cos(n.endAngle),this.y2=n.cy+this.radius*Math.sin(n.endAngle)):(this.startAngle=u(n.x1,n.y1),this.endAngle=u(n.x2,n.y2),this.x1=n.x1,this.y1=n.y1,this.x2=n.x2,this.y2=n.y2);this.endAngle<0&&(this.endAngle+=t);this.startAngle<0&&(this.startAngle+=t);this.segment=jsPlumbGeom.quadrant([this.x1,this.y1],[this.x2,this.y2]);f=this.endAngle<this.startAngle?this.endAngle+t:this.endAngle;this.sweep=Math.abs(f-this.startAngle);this.anticlockwise&&(this.sweep=t-this.sweep);var e=2*Math.PI*this.radius,h=this.sweep/t,o=e*h;this.getLength=function(){return o};this.getBounds=function(){return{minX:n.cx-n.r,maxX:n.cx+n.r,minY:n.cy-n.r,maxY:n.cy+n.r}};i=1e-10;r=function(n){var t=Math.floor(n),r=Math.ceil(n);return n-t<i?t:r-n<i?r:n};this.pointOnPath=function(t,i){if(t===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(t==1)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(t=t/o);var u=s(this,t),f=n.cx+n.r*Math.cos(u),e=n.cy+n.r*Math.sin(u);return{x:r(f),y:r(e),theta:u}};this.gradientAtPoint=function(t,i){var u=this.pointOnPath(t,i),r=jsPlumbGeom.normal([n.cx,n.cy],[u.x,u.y]);return this.anticlockwise||r!=Infinity&&r!=-Infinity||(r*=-1),r};this.pointAlongPathFrom=function(t,i,r){var f=this.pointOnPath(t,r),o=i/e*2*Math.PI,s=this.anticlockwise?-1:1,u=f.theta+s*o,h=n.cx+this.radius*Math.cos(u),c=n.cy+this.radius*Math.sin(u);return{x:h,y:c}}},Bezier:function(n){var u=jsPlumb.Segments.AbstractSegment.apply(this,arguments),t=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}],r={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)},i;this.type="Bezier";i=function(n,t,i){return i&&(t=jsBezier.locationAlongCurveFrom(n,t>0?0:1,t)),t};this.pointOnPath=function(n,r){return n=i(t,n,r),jsBezier.pointOnCurve(t,n)};this.gradientAtPoint=function(n,r){return n=i(t,n,r),jsBezier.gradientAtPoint(t,n)};this.pointAlongPathFrom=function(n,r,u){return n=i(t,n,u),jsBezier.pointAlongCurveFrom(t,n,r)};this.getLength=function(){return jsBezier.getLength(t)};this.getBounds=function(){return r}}};i=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(n){var y,g;i.apply(this,arguments);var t=[],r=0,u=[],a=[],e=n.stub||0,o=jsPlumbUtil.isArray(e)?e[0]:e,s=jsPlumbUtil.isArray(e)?e[1]:e,h=n.gap||0,c=jsPlumbUtil.isArray(h)?h[0]:h,l=jsPlumbUtil.isArray(h)?h[1]:h,p=null,w=!1,f=null;this.isEditable=function(){return!1};this.setEdited=function(n){w=n};this.getPath=function(){};this.setPath=function(){};this.findSegmentForPoint=function(n,i){for(var u,r={d:Infinity,s:null,x:null,y:null,l:null},f=0;f<t.length;f++)u=t[f].findClosestPointOnPath(n,i),u.d<r.d&&(r.d=u.d,r.l=u.l,r.x=u.x,r.y=u.y,r.s=t[f],r.x1=u.x1,r.x2=u.x2,r.y1=u.y1,r.y2=u.y2,r.index=f);return r};var b=function(){for(var i,f=0,n=0;n<t.length;n++)i=t[n].getLength(),a[n]=i/r,u[n]=[f,f+=i/r]},v=function(n,i){var e,o,f;for(i&&(n=n>0?n/r:(r+n)/r),e=u.length-1,o=1,f=0;f<u.length;f++)if(u[f][1]>=n){e=f;o=n==1?1:n===0?0:(n-u[f][0])/a[f];break}return{segment:t[e],proportion:o,index:e}},k=function(n,i,u){if(u.x1!=u.x2||u.y1!=u.y2){var f=new jsPlumb.Segments[i](u);t.push(f);r+=f.getLength();n.updateBounds(f)}},d=function(){r=0;t.splice(0,t.length);u.splice(0,u.length);a.splice(0,a.length)};return this.setSegments=function(n){p=[];r=0;for(var t=0;t<n.length;t++)p.push(n[t]),r+=n[t].getLength()},y=function(n){var r,b;this.lineWidth=n.lineWidth;var nt=jsPlumbGeom.quadrant(n.sourcePos,n.targetPos),p=n.targetPos[0]<n.sourcePos[0],w=n.targetPos[1]<n.sourcePos[1],tt=n.lineWidth||1,t=n.sourceEndpoint.anchor.getOrientation(n.sourceEndpoint),i=n.targetEndpoint.anchor.getOrientation(n.targetEndpoint),d=p?n.targetPos[0]:n.sourcePos[0],g=w?n.targetPos[1]:n.sourcePos[1],a=Math.abs(n.targetPos[0]-n.sourcePos[0]),v=Math.abs(n.targetPos[1]-n.sourcePos[1]);(t[0]===0&&t[1]===0||i[0]===0&&i[1]===0)&&(r=a>v?0:1,b=[1,0][r],t=[],i=[],t[r]=n.sourcePos[r]>n.targetPos[r]?-1:1,i[r]=n.sourcePos[r]>n.targetPos[r]?1:-1,t[b]=0,i[b]=0);var u=p?a+c*t[0]:c*t[0],f=w?v+c*t[1]:c*t[1],e=p?l*i[0]:a+l*i[0],h=w?l*i[1]:v+l*i[1],k=t[0]*i[0]+t[1]*i[1],y={sx:u,sy:f,tx:e,ty:h,lw:tt,xSpan:Math.abs(e-u),ySpan:Math.abs(h-f),mx:(u+e)/2,my:(f+h)/2,so:t,to:i,x:d,y:g,w:a,h:v,segment:nt,startStubX:u+t[0]*o,startStubY:f+t[1]*o,endStubX:e+i[0]*s,endStubY:h+i[1]*s,isXGreaterThanStubTimes2:Math.abs(u-e)>o+s,isYGreaterThanStubTimes2:Math.abs(f-h)>o+s,opposite:k==-1,perpendicular:k===0,orthogonal:k==1,sourceAxis:t[0]===0?"y":"x",points:[d,g,a,v,u,f,e,h]};return y.anchorOrientation=y.opposite?"opposite":y.orthogonal?"orthogonal":"perpendicular",y},this.getSegments=function(){return t},this.updateBounds=function(n){var t=n.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX);this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX);this.bounds.minY=Math.min(this.bounds.minY,t.minY);this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)},g=function(){console.log("SEGMENTS:");for(var n=0;n<t.length;n++)console.log(t[n].type,t[n].getLength(),u[n])},this.pointOnPath=function(n,t){var i=v(n,t);return i.segment&&i.segment.pointOnPath(i.proportion,t)||[0,0]},this.gradientAtPoint=function(n){var t=v(n,absolute);return t.segment&&t.segment.gradientAtPoint(t.proportion,absolute)||0},this.pointAlongPathFrom=function(n,t,i){var r=v(n,i);return r.segment&&r.segment.pointAlongPathFrom(r.proportion,t,!1)||[0,0]},this.compute=function(n){w||(f=y.call(this,n));d();this._compute(f,n);this.x=f.points[0];this.y=f.points[1];this.w=f.points[2];this.h=f.points[3];this.segment=f.segment;b()},{addSegment:k,prepareCompute:y,sourceStub:o,targetStub:s,maxStub:Math.max(o,s),sourceGap:c,targetGap:l,maxGap:Math.max(c,l)}};jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,i);e=jsPlumb.Connectors.Straight=function(){this.type="Straight";var n=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t){n.addSegment(this,"Straight",{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY});n.addSegment(this,"Straight",{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY});n.addSegment(this,"Straight",{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(e,"Straight");u=function(n){n=n||{};var r=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),u=n.stub||50,i=n.curviness||150,t=10;this.type="Bezier";this.getCurviness=function(){return i};this._findControlPoint=function(n,r,u,f,e){var s=f.anchor.getOrientation(f),h=e.anchor.getOrientation(e),c=s[0]!=h[0]||s[1]==h[1],o=[];return c?(h[0]===0?o.push(u[0]<r[0]?n[0]+t:n[0]-t):o.push(n[0]+i*h[0]),h[1]===0?o.push(u[1]<r[1]?n[1]+t:n[1]-t):o.push(n[1]+i*s[1])):(s[0]===0?o.push(r[0]<u[0]?n[0]+t:n[0]-t):o.push(n[0]-i*s[0]),s[1]===0?o.push(r[1]<u[1]?n[1]+t:n[1]-t):o.push(n[1]+i*h[1])),o};this._compute=function(n,t){var i=t.sourcePos,u=t.targetPos,f=Math.abs(i[0]-u[0]),e=Math.abs(i[1]-u[1]),o=i[0]<u[0]?f:0,s=i[1]<u[1]?e:0,h=i[0]<u[0]?0:f,c=i[1]<u[1]?0:e,l=this._findControlPoint([o,s],i,u,t.sourceEndpoint,t.targetEndpoint),a=this._findControlPoint([h,c],u,i,t.targetEndpoint,t.sourceEndpoint);r.addSegment(this,"Bezier",{x1:o,y1:s,x2:h,y2:c,cp1x:l[0],cp1y:l[1],cp2x:a[0],cp2y:a[1]})}};jsPlumbUtil.extend(u,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(u,"Bezier");jsPlumb.Endpoints.AbstractEndpoint=function(n){i.apply(this,arguments);var t=this.compute=function(){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:t,cssClass:n.cssClass}};jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,i);jsPlumb.Endpoints.Dot=function(n){this.type="Dot";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);n=n||{};this.radius=n.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(n,t,i){var r;this.radius=i.radius||this.radius;var u=n[0]-this.radius,f=n[1]-this.radius,e=this.radius*2,o=this.radius*2;return i.strokeStyle&&(r=i.lineWidth||1,u-=r,f-=r,e+=r*2,o+=r*2),[u,f,e,o,this.radius]}};jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint);jsPlumb.Endpoints.Rectangle=function(n){this.type="Rectangle";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);n=n||{};this.width=n.width||20;this.height=n.height||20;this._compute=function(n,t,i){var r=i.width||this.width,u=i.height||this.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);t=function(){jsPlumb.DOMElementComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(t,jsPlumb.DOMElementComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(n){this._jsPlumb.displayElements.push(n)}});jsPlumb.Endpoints.Image=function(n){this.type="Image";t.apply(this,arguments);jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var i=n.onload,r=n.src||n.url,u=n.parent,f=n.cssClass?" "+n.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=!1;this._jsPlumb.initialized=!1;this._jsPlumb.deleted=!1;this._jsPlumb.widthToUse=n.width;this._jsPlumb.heightToUse=n.height;this._jsPlumb.endpoint=n.endpoint;this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,i&&i(this))}.bind(this);this._jsPlumb.endpoint.setImage=function(n,t){var r=n.constructor==String?n:n.src;i=t;this._jsPlumb.img.src=r;this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this);this._jsPlumb.endpoint.setImage(r,i);this._compute=function(n){return this.anchorPoint=n,this._jsPlumb.ready?[n[0]-this._jsPlumb.widthToUse/2,n[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]};this.canvas=document.createElement("img");this.canvas.style.margin=0;this.canvas.style.padding=0;this.canvas.style.outline=0;this.canvas.style.position="absolute";this.canvas.className=this._jsPlumb.instance.endpointClass+f;this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse);this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse);this._jsPlumb.instance.appendElement(this.canvas,u);this.attachListeners(this.canvas,this);this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var n=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,t=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,n,t,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(n,t){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(n,t):window.setTimeout(function(){this.paint(n,t)}.bind(this),200))}};jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[t,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0;jsPlumbUtil.removeElement(this.canvas);this.canvas=null}});jsPlumb.Endpoints.Blank=function(n){var i=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";t.apply(this,arguments);this._compute=function(n){return[n[0],n[1],10,0]};this.canvas=document.createElement("div");this.canvas.style.display="block";this.canvas.style.width="1px";this.canvas.style.height="1px";this.canvas.style.background="transparent";this.canvas.style.position="absolute";this.canvas.className=this._jsPlumb.endpointClass;jsPlumb.appendElement(this.canvas,n.parent);this.paint=function(){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,t],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}});jsPlumb.Endpoints.Triangle=function(n){this.type="Triangle";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);n=n||{};n.width=n.width||55;n.height=n.height||55;this.width=n.width;this.height=n.height;this._compute=function(n,t,i){var r=i.width||self.width,u=i.height||self.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};n=jsPlumb.Overlays.AbstractOverlay=function(n){this.visible=!0;this.isAppendedAtTopLevel=!0;this.component=n.component;this.loc=n.location==null?.5:n.location;this.endpointLoc=n.endpointLocation==null?[.5,.5]:n.endpointLocation};n.prototype={cleanup:function(){this.component=null;this.canvas=null;this.endpointLoc=null},setVisible:function(n){this.visible=n},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(n){this.loc+=n;this.component.repaint()},setLocation:function(n){this.loc=n;this.component.repaint()},getLocation:function(){return this.loc}};jsPlumb.Overlays.Arrow=function(t){var f,i;this.type="Arrow";n.apply(this,arguments);this.isAppendedAtTopLevel=!1;t=t||{};f=jsPlumbUtil;i=jsPlumbGeom;this.length=t.length||20;this.width=t.width||20;this.id=t.id;var r=(t.direction||1)<0?-1:1,u=t.paintStyle||{lineWidth:1},e=t.foldback||.623;this.computeMaxSize=function(){return self.width*1.5};this.draw=function(n,t){var o,c,s,h,v,l,a,y,p;if(n.pointAlongPathFrom){f.isString(this.loc)||this.loc>1||this.loc<0?(l=parseInt(this.loc,10),a=this.loc<0?1:0,o=n.pointAlongPathFrom(a,l,!1),c=n.pointAlongPathFrom(a,l-r*this.length/2,!1),s=i.pointOnLine(o,c,this.length)):this.loc==1?(o=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,-this.length),s=i.pointOnLine(o,c,this.length),r==-1&&(y=s,s=o,o=y)):this.loc===0?(s=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,this.length),o=i.pointOnLine(s,c,this.length),r==-1&&(p=s,s=o,o=p)):(o=n.pointAlongPathFrom(this.loc,r*this.length/2),c=n.pointOnPath(this.loc),s=i.pointOnLine(o,c,this.length));h=i.perpendicularLineTo(o,s,this.width);v=i.pointOnLine(o,s,e*this.length);var w={hxy:o,tail:h,cxy:v},b=u.strokeStyle||t.strokeStyle,k=u.fillStyle||t.strokeStyle,d=u.lineWidth||t.lineWidth;return{component:n,d:w,lineWidth:d,strokeStyle:b,fillStyle:k,minX:Math.min(o.x,h[0].x,h[1].x),maxX:Math.max(o.x,h[0].x,h[1].x),minY:Math.min(o.y,h[0].y,h[1].y),maxY:Math.max(o.y,h[0].y,h[1].y)}}return{component:n,minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,n);jsPlumb.Overlays.PlainArrow=function(n){n=n||{};var t=jsPlumb.extend(n,{foldback:1});jsPlumb.Overlays.Arrow.call(this,t);this.type="PlainArrow"};jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow);jsPlumb.Overlays.Diamond=function(n){n=n||{};var t=n.length||40,i=jsPlumb.extend(n,{length:t/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,i);this.type="Diamond"};jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);f=function(n){return n._jsPlumb.cachedDimensions==null&&(n._jsPlumb.cachedDimensions=n.getDimensions()),n._jsPlumb.cachedDimensions};r=function(t){jsPlumb.DOMElementComponent.apply(this,arguments);n.apply(this,arguments);var i=jsPlumb.CurrentLibrary;this.id=t.id;this._jsPlumb.div=null;this._jsPlumb.initialised=!1;this._jsPlumb.component=t.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=t.create;this.getElement=function(){var n,r;return this._jsPlumb.div==null&&(n=this._jsPlumb.div=i.getDOMElement(this._jsPlumb.create(this._jsPlumb.component)),n.style.position="absolute",r=t._jsPlumb.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:""),n.className=r,this._jsPlumb.instance.appendElement(n,this._jsPlumb.component.parent),this._jsPlumb.instance.getId(n),this.attachListeners(n,this),this.canvas=n),this._jsPlumb.div};this.draw=function(n,t,i){var r=f(this),u,s,h,c,e,o;return r!=null&&r.length==2?(u={x:0,y:0},i?u={x:i[0],y:i[1]}:n.pointOnPath?(s=this.loc,h=!1,(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)&&(s=parseInt(this.loc,10),h=!0),u=n.pointOnPath(s,h)):(c=this.loc.constructor==Array?this.loc:this.endpointLoc,u={x:c[0]*n.w,y:c[1]*n.h}),e=u.x-r[0]/2,o=u.y-r[1]/2,{component:n,d:{minx:e,miny:o,td:r,cxy:u},minX:e,maxX:e+r[0],minY:o,maxY:o+r[1]}):{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(r,[jsPlumb.DOMElementComponent,n],{getDimensions:function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(this.getElement()))},setVisible:function(n){this._jsPlumb.div.style.display=n?"block":"none"},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){this._jsPlumb.div!=null&&jsPlumb.CurrentLibrary.removeElement(this._jsPlumb.div)},computeMaxSize:function(){var n=f(this);return Math.max(n[0],n[1])},reattachListeners:function(n){this._jsPlumb.div&&this.reattachListenersForElement(this._jsPlumb.div,this,n)},paint:function(n){this._jsPlumb.initialised||(this.getElement(),n.component.appendDisplayElement(this._jsPlumb.div),this.attachListeners(this._jsPlumb.div,n.component),this._jsPlumb.initialised=!0);this._jsPlumb.div.style.left=n.component.x+n.d.minx+"px";this._jsPlumb.div.style.top=n.component.y+n.d.miny+"px"}});jsPlumb.Overlays.Custom=function(){this.type="Custom";r.apply(this,arguments)};jsPlumbUtil.extend(jsPlumb.Overlays.Custom,r);jsPlumb.Overlays.GuideLines=function(){var t=this;t.length=50;t.lineWidth=5;this.type="GuideLines";n.apply(this,arguments);jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.draw=function(n){var r=n.pointAlongPathFrom(t.loc,t.length/2),f=n.pointOnPath(t.loc),u=jsPlumbGeom.pointOnLine(r,f,t.length),e=jsPlumbGeom.perpendicularLineTo(r,u,40),i=jsPlumbGeom.perpendicularLineTo(u,r,20);return{connector:n,head:r,tail:u,headLine:i,tailLine:e,minX:Math.min(r.x,u.x,i[0].x,i[1].x),minY:Math.min(r.y,u.y,i[0].y,i[1].y),maxX:Math.max(r.x,u.x,i[0].x,i[1].x),maxY:Math.max(r.y,u.y,i[0].y,i[1].y)}}};jsPlumb.Overlays.Label=function(n){var i,t,r;this.labelStyle=n.labelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;i=jsPlumb.extend({create:function(){return document.createElement("div")}},n);jsPlumb.Overlays.Custom.call(this,i);this.type="Label";this.label=n.label||"";this.labelText=null;this.labelStyle&&(t=this.getElement(),this.labelStyle.font=this.labelStyle.font||"12px sans-serif",t.style.font=this.labelStyle.font,t.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(t.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0&&(r=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black",t.style.border=this.labelStyle.borderWidth+"px solid "+r),this.labelStyle.padding&&(t.style.padding=this.labelStyle.padding))};jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null;this.label=null;this.labelText=null;this.cssClass=null;this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(n){this.label=n;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){return this.update(),r.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var n=this.label(this);this.getElement().innerHTML=n.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}})}(),function(){var n=function(n){this.type="Flowchart";n=n||{};n.stub=n.stub==null?30:n.stub;var t=this,u=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),h=n.midpoint==null?.5:n.midpoint,i=[],w=n.grid,y=n.alwaysRespectStubs,r=null,f=null,e=null,p,c=n.cornerRadius!=null?n.cornerRadius:0,o=function(n){return n<0?-1:n===0?0:1},s=function(n,t,i,r){if(f!=t||e!=i){var u=f==null?r.sx:f,s=e==null?r.sy:e,h=u==t?"v":"h",c=o(t-u),l=o(i-s);f=t;e=i;n.push([u,s,t,i,h,c,l])}},l=function(n){return Math.sqrt(Math.pow(n[0]-n[2],2)+Math.pow(n[1]-n[3],2))},a=function(n){var t=[];return t.push.apply(t,n),t},b=function(n){t.bounds.minX=Math.min(t.bounds.minX,n[2]);t.bounds.maxX=Math.max(t.bounds.maxX,n[2]);t.bounds.minY=Math.min(t.bounds.minY,n[3]);t.bounds.maxY=Math.max(t.bounds.maxY,n[3])},v=function(n,t,i){for(var e,v,y,r,f,s=0;s<t.length-1;s++){if(r=r||a(t[s]),f=a(t[s+1]),c>0&&r[4]!=f[4]){e=Math.min(c,l(r),l(f));r[2]-=r[5]*e;r[3]-=r[6]*e;f[0]+=f[5]*e;f[1]+=f[6]*e;var o=r[6]==f[5]&&f[5]==1||r[6]==f[5]&&f[5]===0&&r[5]!=f[6]||r[6]==f[5]&&f[5]==-1,p=f[1]>r[3]?1:-1,w=f[0]>r[2]?1:-1,h=p==w,b=h&&o||!h&&!o?f[0]:r[2],k=h&&o||!h&&!o?r[3]:f[1];u.addSegment(n,"Straight",{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});u.addSegment(n,"Arc",{r:e,x1:r[2],y1:r[3],x2:f[0],y2:f[1],cx:b,cy:k,ac:o})}else v=r[2]==r[0]?0:r[2]>r[0]?i.lw/2:-(i.lw/2),y=r[3]==r[1]?0:r[3]>r[1]?i.lw/2:-(i.lw/2),u.addSegment(n,"Straight",{x1:r[0]-v,y1:r[1]-y,x2:r[2]+v,y2:r[3]+y});r=f}u.addSegment(n,"Straight",{x1:f[0],y1:f[1],x2:f[2],y2:f[3]})};this.setSegments=function(n){r=n};this.isEditable=function(){return!0};this.getOriginalSegments=function(){return r||i};this._compute=function(n,t){var w,b;if(t.clearEdits&&(r=null),r!=null){v(this,r,n);return}i=[];f=null;e=null;p=null;var o=n.startStubX+(n.endStubX-n.startStubX)*h,c=n.startStubY+(n.endStubY-n.startStubY)*h,et=function(n,t,i,r){return n+(t*(1-i)*r+u.maxStub)},k={x:[0,1],y:[1,0]},d=function(){return[n.startStubX,n.startStubY,n.endStubX,n.endStubY]},nt={perpendicular:d,orthogonal:d,opposite:function(t){var i=n,r=t=="x"?0:1,u={x:function(){return i.so[r]==1&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||i.so[r]==-1&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return i.so[r]==1&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||i.so[r]==-1&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!y&&u[t]()?{x:[(n.sx+n.tx)/2,n.startStubY,(n.sx+n.tx)/2,n.endStubY],y:[n.startStubX,(n.sy+n.ty)/2,n.endStubX,(n.sy+n.ty)/2]}[t]:[n.startStubX,n.startStubY,n.endStubX,n.endStubY]}},tt={perpendicular:function(t){var i=n,h={x:[[i.startStubX,i.endStubX],null,[i.endStubX,i.startStubX]],y:[[i.startStubY,i.endStubY],null,[i.endStubY,i.startStubY]]},v={x:[[o,i.startStubY],[o,i.endStubY]],y:[[i.startStubX,c],[i.endStubX,c]]},y={x:[[i.endStubX,i.startStubY]],y:[[i.startStubX,i.endStubY]]},p={x:[[i.startStubX,i.endStubY],[i.endStubX,i.endStubY]],y:[[i.endStubX,i.startStubY],[i.endStubX,i.endStubY]]},w={x:[[i.startStubX,c],[i.endStubX,c],[i.endStubX,i.endStubY]],y:[[o,i.startStubY],[o,i.endStubY],[i.endStubX,i.endStubY]]},u={x:[i.startStubY,i.endStubY],y:[i.startStubX,i.endStubX]},b=k[t][0],f=k[t][1],e=i.so[b]+1,d=i.to[f]+1,s=i.to[f]==-1&&u[t][1]<u[t][0]||i.to[f]==1&&u[t][1]>u[t][0],l=h[t][e][0],a=h[t][e][1],r={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[t][e][d];return i.segment==r[3]||i.segment==r[2]&&s?v[t]:i.segment==r[2]&&a<l?y[t]:i.segment==r[2]&&a>=l||i.segment==r[1]&&!s?w[t]:i.segment==r[0]||i.segment==r[1]&&s?p[t]:void 0},orthogonal:function(t,i,r,u,f){var o=n,e={x:o.so[0]==-1?Math.min(i,u):Math.max(i,u),y:o.so[1]==-1?Math.min(i,u):Math.max(i,u)}[t];return{x:[[e,r],[e,f],[u,f]],y:[[r,e],[f,e],[f,u]]}[t]},opposite:function(i,r,f,e){var s=n,l={x:"y",y:"x"}[i],v={x:"height",y:"width"}[i],y=s["is"+i.toUpperCase()+"GreaterThanStubTimes2"],h;return t.sourceEndpoint.elementId==t.targetEndpoint.elementId?(h=f+(1-t.sourceEndpoint.anchor[l])*t.sourceInfo[v]+u.maxStub,{x:[[r,h],[e,h]],y:[[h,r],[h,e]]}[i]):!y||s.so[a]==1&&r>e||s.so[a]==-1&&r<e?{x:[[r,c],[e,c]],y:[[o,r],[o,e]]}[i]:s.so[a]==1&&r<e||s.so[a]==-1&&r>e?{x:[[o,s.sy],[o,s.ty]],y:[[s.sx,c],[s.tx,c]]}[i]:void 0}},l=nt[n.anchorOrientation](n.sourceAxis),a=n.sourceAxis=="x"?0:1,g=n.sourceAxis=="x"?1:0,it=l[a],rt=l[g],ut=l[a+2],ft=l[g+2];if(s(i,l[0],l[1],n),w=tt[n.anchorOrientation](n.sourceAxis,it,rt,ut,ft),w)for(b=0;b<w.length;b++)s(i,w[b][0],w[b][1],n);s(i,l[2],l[3],n);s(i,n.tx,n.ty,n);v(this,i,n)};this.getPath=function(){for(var t=null,f=null,e=[],o=r||i,u=0;u<o.length;u++){var n=o[u],s=n[4],h=s=="v"?3:2;t!=null&&f===s?t[h]=n[h]:(n[0]!=n[2]||n[1]!=n[3])&&(e.push({start:[n[0],n[1]],end:[n[2],n[3]]}),t=n,f=n[4])}return e};this.setPath=function(n){var t;for(r=[],t=0;t<n.length;t++){var i=n[t].start[0],f=n[t].start[1],u=n[t].end[0],e=n[t].end[1],s=i==u?"v":"h",h=o(u-i),c=o(e-f);r.push([i,f,u,e,s,h,c])}}};jsPlumbUtil.extend(n,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(n,"Flowchart")}(),function(){var c=null,l=function(n,t){return jsPlumb.CurrentLibrary.hasClass(r(n),t)},r=function(n){return jsPlumb.CurrentLibrary.getElementObject(n)},o=function(n){return jsPlumb.CurrentLibrary.getOffset(r(n))},s=function(n){return jsPlumb.CurrentLibrary.getPageXY(n)},a=function(n){return jsPlumb.CurrentLibrary.getClientXY(n)},f=window.CanvasMouseAdapter=function(){var n=this;this.overlayPlacements=[];jsPlumb.jsPlumbUIComponent.apply(this,arguments);jsPlumbUtil.EventGenerator.apply(this,arguments);this._over=function(t){var c=o(r(n.canvas)),l=s(t),u=l[0]-c.left,f=l[1]-c.top,h,i,e;if(u>0&&f>0&&u<n.canvas.width&&f<n.canvas.height){for(h=0;h<n.overlayPlacements.length;h++)if(i=n.overlayPlacements[h],i&&i[0]<=u&&i[1]>=u&&i[2]<=f&&i[3]>=f)return!0;return e=n.canvas.getContext("2d").getImageData(parseInt(u,10),parseInt(f,10),1,1),e.data[0]!==0||e.data[1]!==0||e.data[2]!==0||e.data[3]!==0}return!1};var t=!1,u=!1,e=null,i=!1,f=function(n,t){return n!==null&&l(n,t)};this.mousemove=function(i){var h=s(i),u=a(i),r=document.elementFromPoint(u[0],u[1]),o=f(r,"_jsPlumb_overlay"),e=c===null&&(f(r,"_jsPlumb_endpoint")||f(r,"_jsPlumb_connector"));if(!t&&e&&n._over(i))return t=!0,n.fire("mouseenter",n,i),!0;!t||n._over(i)&&e||o||(t=!1,n.fire("mouseexit",n,i));n.fire("mousemove",n,i)};this.click=function(r){t&&n._over(r)&&!i&&n.fire("click",n,r);i=!1};this.dblclick=function(r){t&&n._over(r)&&!i&&n.fire("dblclick",n,r);i=!1};this.mousedown=function(t){n._over(t)&&!u&&(u=!0,e=o(r(n.canvas)),n.fire("mousedown",n,t))};this.mouseup=function(t){u=!1;n.fire("mouseup",n,t)};this.contextmenu=function(r){t&&n._over(r)&&!i&&n.fire("contextmenu",n,r);i=!1}},e,t,n,i,u;jsPlumbUtil.extend(f,[jsPlumb.jsPlumbUIComponent,jsPlumbUtil.EventGenerator]);e=function(n){var t=document.createElement("canvas");return n._jsPlumb.instance.appendElement(t,n.parent),t.style.position="absolute",n["class"]&&(t.className=n["class"]),n._jsPlumb.instance.getId(t,n.uuid),n.tooltip&&t.setAttribute("title",n.tooltip),t};t=window.CanvasComponent=function(){f.apply(this,arguments);var n=[];this.getDisplayElements=function(){return n};this.appendDisplayElement=function(t){n.push(t)}};jsPlumbUtil.extend(t,f,{setVisible:function(n){this.canvas.style.display=n?"block":"none"}});var v=[null,[1,-1],[1,1],[-1,1],[-1,-1]],h=function(n,t,i){var u,r;if(t.gradient){for(u=i(),r=0;r<t.gradient.stops.length;r++)u.addColorStop(t.gradient.stops[r][0],t.gradient.stops[r][1]);n.strokeStyle=u}},y=function(n,t,i,r,u){({Straight:function(n,t,i,r,u){var f=n.params,s,a;if(t.save(),h(t,i,function(){return t.createLinearGradient(f.x1,f.y1,f.x2,f.y2)}),t.beginPath(),t.translate(r,u),i.dashstyle&&i.dashstyle.split(" ").length===2){s=i.dashstyle.split(" ");s.length!==2&&(s=[2,2]);var o=[s[0]*i.lineWidth,s[1]*i.lineWidth],y=(f.x2-f.x1)/(f.y2-f.y1),p=jsPlumbUtil.segment([f.x1,f.y1],[f.x2,f.y2]),c=v[p],l=Math.atan(y),w=Math.sqrt(Math.pow(f.x2-f.x1,2)+Math.pow(f.y2-f.y1,2)),b=Math.floor(w/(o[0]+o[1])),e=[f.x1,f.y1];for(a=0;a<b;a++){t.moveTo(e[0],e[1]);var k=e[0]+Math.abs(Math.sin(l)*o[0])*c[0],d=e[1]+Math.abs(Math.cos(l)*o[0])*c[1],g=e[0]+Math.abs(Math.sin(l)*(o[0]+o[1]))*c[0],nt=e[1]+Math.abs(Math.cos(l)*(o[0]+o[1]))*c[1];t.lineTo(k,d);e=[g,nt]}t.moveTo(e[0],e[1]);t.lineTo(f.x2,f.y2)}else t.moveTo(f.x1,f.y1),t.lineTo(f.x2,f.y2);t.stroke();t.restore()},Bezier:function(n,t,i,r,u){var f=n.params;t.save();h(t,i,function(){return t.createLinearGradient(f.x2+r,f.y2+u,f.x1+r,f.y1+u)});t.beginPath();t.translate(r,u);t.moveTo(f.x1,f.y1);t.bezierCurveTo(f.cp1x,f.cp1y,f.cp2x,f.cp2y,f.x2,f.y2);t.stroke();t.restore()},Arc:function(n,t,i,r,u){var f=n.params;t.save();t.beginPath();t.translate(r,u);t.arc(f.cx,f.cy,f.r,n.startAngle,n.endAngle,f.ac);t.stroke();t.restore()}})[n.type](n,t,i,r,u)},p=jsPlumb.ConnectorRenderers.canvas=function(n){t.apply(this,arguments);var i=function(n,t,i){var u,r;for(this.ctx.save(),jsPlumb.extend(this.ctx,n),u=this.getSegments(),r=0;r<u.length;r++)y(u[r],this.ctx,n,t,i);this.ctx.restore()}.bind(this),r=this._jsPlumb.instance.connectorClass+" "+(n.cssClass||"");this.canvas=e({"class":r,_jsPlumb:this._jsPlumb,parent:n.parent});this.ctx=this.canvas.getContext("2d");this.appendDisplayElement(this.canvas);this.paint=function(n,t,r){if(n!=null){var u=[this.x,this.y],f=[this.w,this.h],e=0,o=0;if(r!=null&&(r.xmin<0&&(u[0]+=r.xmin,e=-r.xmin),r.ymin<0&&(u[1]+=r.ymin,o=-r.ymin),f[0]=r.xmax+(r.xmin<0?-r.xmin:0),f[1]=r.ymax+(r.ymin<0?-r.ymin:0)),this.translateX=e,this.translateY=o,jsPlumbUtil.sizeElement(this.canvas,u[0],u[1],f[0],f[1]),n.outlineColor!=null){var s=n.outlineWidth||1,h=n.lineWidth+2*s,c={strokeStyle:n.outlineColor,lineWidth:h};i(c,e,o)}i(n,e,o)}}};jsPlumbUtil.extend(p,t);n=function(n){t.apply(this,arguments);var i=this._jsPlumb.instance.endpointClass+" "+(n.cssClass||""),r={"class":i,_jsPlumb:this._jsPlumb,parent:n.parent,tooltip:self.tooltip};this.canvas=e(r);this.ctx=this.canvas.getContext("2d");this.appendDisplayElement(this.canvas);this.paint=function(n){if(jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),n.outlineColor!=null)var t=n.outlineWidth||1,i=n.lineWidth+2*t,r={strokeStyle:n.outlineColor,lineWidth:i};this._paint.apply(this,arguments)}};jsPlumbUtil.extend(n,t);jsPlumb.Endpoints.canvas.Dot=function(t){jsPlumb.Endpoints.Dot.apply(this,arguments);n.apply(this,arguments);var i=this,r=function(n){try{return parseInt(n,10)}catch(t){if(n.substring(n.length-1)=="%")return parseInt(n.substring(0,n-1),10)}},u=function(n){var t=i.defaultOffset,u=i.defaultInnerRadius;return n.offset&&(t=r(n.offset)),n.innerRadius&&(u=r(n.innerRadius)),[t,u]};this._paint=function(n){var r,o,e;if(n!=null){if(r=i.canvas.getContext("2d"),o=t.endpoint.anchor.getOrientation(t.endpoint),jsPlumb.extend(r,n),n.gradient){var f=u(n.gradient),h=o[1]==1?f[0]*-1:f[0],c=o[0]==1?f[0]*-1:f[0],s=r.createRadialGradient(i.radius,i.radius,i.radius,i.radius+c,i.radius+h,f[1]);for(e=0;e<n.gradient.stops.length;e++)s.addColorStop(n.gradient.stops[e][0],n.gradient.stops[e][1]);r.fillStyle=s}r.beginPath();r.arc(i.radius,i.radius,i.radius,0,Math.PI*2,!0);r.closePath();(n.fillStyle||n.gradient)&&r.fill();n.strokeStyle&&r.stroke()}}};jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Dot,[jsPlumb.Endpoints.Dot,n]);jsPlumb.Endpoints.canvas.Rectangle=function(t){var i=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments);n.apply(this,arguments);this._paint=function(n){var r=i.canvas.getContext("2d"),u=t.endpoint.anchor.getOrientation(t.endpoint),f;if(jsPlumb.extend(r,n),n.gradient){var o=u[1]==1?i.h:u[1]===0?i.h/2:0,s=u[1]==-1?i.h:u[1]===0?i.h/2:0,h=u[0]==1?i.w:u[0]===0?i.w/2:0,c=u[0]==-1?i.w:u[0]===0?i.w/2:0,e=r.createLinearGradient(h,o,c,s);for(f=0;f<n.gradient.stops.length;f++)e.addColorStop(n.gradient.stops[f][0],n.gradient.stops[f][1]);r.fillStyle=e}r.beginPath();r.rect(0,0,i.w,i.h);r.closePath();(n.fillStyle||n.gradient)&&r.fill();n.strokeStyle&&r.stroke()}};jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Rectangle,[jsPlumb.Endpoints.Rectangle,n]);jsPlumb.Endpoints.canvas.Triangle=function(t){var i=this;jsPlumb.Endpoints.Triangle.apply(this,arguments);n.apply(this,arguments);this._paint=function(n){var r=i.canvas.getContext("2d"),f=0,e=0,u=0,o=t.endpoint.anchor.getOrientation(t.endpoint);o[0]==1&&(f=i.width,e=i.height,u=180);o[1]==-1&&(f=i.width,u=90);o[1]==1&&(e=i.height,u=-90);r.fillStyle=n.fillStyle;r.translate(f,e);r.rotate(u*Math.PI/180);r.beginPath();r.moveTo(0,0);r.lineTo(i.width/2,i.height/2);r.lineTo(0,i.height);r.closePath();(n.fillStyle||n.gradient)&&r.fill();n.strokeStyle&&r.stroke()}};jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Triangle,[jsPlumb.Endpoints.Triangle,n]);jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;i=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};jsPlumbUtil.extend(i,jsPlumb.jsPlumbUIComponent,{setVisible:function(n){this.visible=n;this.component.repaint()}});u=function(n,t){n.apply(this,t);i.apply(this,t);this.paint=function(n){var t=n.component.ctx,i=n.d;i&&(t.save(),t.lineWidth=n.lineWidth,t.beginPath(),t.translate(n.component.translateX,n.component.translateY),t.moveTo(i.hxy.x,i.hxy.y),t.lineTo(i.tail[0].x,i.tail[0].y),t.lineTo(i.cxy.x,i.cxy.y),t.lineTo(i.tail[1].x,i.tail[1].y),t.lineTo(i.hxy.x,i.hxy.y),t.closePath(),n.strokeStyle&&(t.strokeStyle=n.strokeStyle,t.stroke()),n.fillStyle&&(t.fillStyle=n.fillStyle,t.fill()),t.restore())}};jsPlumb.Overlays.canvas.Arrow=function(){u.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Arrow,[jsPlumb.Overlays.Arrow,i]);jsPlumb.Overlays.canvas.PlainArrow=function(){u.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.canvas.PlainArrow,[jsPlumb.Overlays.PlainArrow,i]);jsPlumb.Overlays.canvas.Diamond=function(){u.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Diamond,[jsPlumb.Overlays.Diamond,i])}(),function(){var h={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},f="stroke-dasharray",o="dashstyle",c="linearGradient",l="radialGradient",a="fill",g="stop",v="stroke",nt="stroke-width",y="style",p="none",tt="jsplumb_gradient_",it="lineWidth",w={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},t=function(n,t){for(var i in t)n.setAttribute(i,""+t[i])},n=function(n,i){var r=document.createElementNS(w.svg,n);return i=i||{},i.version="1.1",i.xmlns=w.xhtml,t(r,i),r},e=function(n){return"position:absolute;left:"+n[0]+"px;top:"+n[1]+"px"},b=function(n){for(var t=0;t<n.childNodes.length;t++)(n.childNodes[t].tagName==c||n.childNodes[t].tagName==l)&&n.removeChild(n.childNodes[t])},rt=function(t,i,r,u,f){var o=tt+f._jsPlumb.instance.idstamp(),s,e,h;for(b(t),s=r.gradient.offset?n(l,{id:o}):n(c,{id:o,gradientUnits:"userSpaceOnUse"}),t.appendChild(s),e=0;e<r.gradient.stops.length;e++){var p=f.segment==1||f.segment==2?e:r.gradient.stops.length-1-e,w=jsPlumbUtil.convertStyle(r.gradient.stops[p][1],!0),k=n(g,{offset:Math.floor(r.gradient.stops[e][0]*100)+"%","stop-color":w});s.appendChild(k)}h=r.strokeStyle?v:a;i.setAttribute(y,h+":url("+document.location.toString()+"#"+o+")")},s=function(n,t,i,r,u){var e;if(i.gradient?rt(n,t,i,r,u):(b(n),t.setAttribute(y,"")),t.setAttribute(a,i.fillStyle?jsPlumbUtil.convertStyle(i.fillStyle,!0):p),t.setAttribute(v,i.strokeStyle?jsPlumbUtil.convertStyle(i.strokeStyle,!0):p),i.lineWidth&&t.setAttribute(nt,i.lineWidth),i[o]&&i[it]&&!i[f]){var s=i[o].indexOf(",")==-1?" ":",",l=i[o].split(s),c="";l.forEach(function(n){c+=Math.floor(n*i.lineWidth)+s});t.setAttribute(f,c)}else i[f]&&t.setAttribute(f,i[f]);for(e in h)i[e]&&t.setAttribute(h[e],i[e])},ot=function(n){var t=n.match(/([0-9].)(p[xt])\s(.*)/);return{size:t[1]+t[2],font:t[3]}},k=function(n,t,i){for(var e,f=i.split(" "),o=n.className,r=o.baseVal.split(" "),u=0;u<f.length;u++)t?r.indexOf(f[u])==-1&&r.push(f[u]):(e=r.indexOf(f[u]),e!=-1&&r.splice(e,1));n.className.baseVal=r.join(" ")},ut=function(n,t){k(n,!0,t)},ft=function(n,t){k(n,!1,t)},d=function(n,t,i){n.childNodes.length>i?n.insertBefore(t,n.childNodes[i]):n.appendChild(t)},r,et,u,i;jsPlumbUtil.svg={addClass:ut,removeClass:ft,node:n,attr:t,pos:e};r=function(i){var s=i.pointerEventsSpec||"all",f={},r,o,u;return jsPlumb.jsPlumbUIComponent.apply(this,i.originalArgs),this.canvas=null,this.path=null,this.svg=null,r=i.cssClass+" "+(i.originalArgs[0].cssClass||""),o={style:"",width:0,height:0,"pointer-events":s,position:"absolute"},this.svg=n("svg",o),i.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=r):(t(this.svg,{"class":r}),this.canvas=this.svg),i._jsPlumb.appendElement(this.canvas,i.originalArgs[0].parent),i.useDivWrapper&&this.canvas.appendChild(this.svg),u=[this.canvas],this.getDisplayElements=function(){return u},this.appendDisplayElement=function(n){u.push(n)},this.paint=function(n,r,u){if(n!=null){var o=[this.x,this.y],s=[this.w,this.h],h;u!=null&&(u.xmin<0&&(o[0]+=u.xmin),u.ymin<0&&(o[1]+=u.ymin),s[0]=u.xmax+(u.xmin<0?-u.xmin:0),s[1]=u.ymax+(u.ymin<0?-u.ymin:0));i.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,o[0],o[1],s[0],s[1]),o[0]=0,o[1]=0,h=e([0,0])):h=e([o[0],o[1]]);f.paint.apply(this,arguments);t(this.svg,{style:h,width:s[0],height:s[1]})}},{renderer:f}};jsPlumbUtil.extend(r,jsPlumb.jsPlumbUIComponent,{cleanup:function(){jsPlumbUtil.removeElement(this.canvas);this.svg=null;this.canvas=null;this.path=null},setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none");this.bgCanvas&&(this.bgCanvas.style.display=n?"block":"none")}});et=jsPlumb.ConnectorRenderers.svg=function(i){var u=this,f=r.apply(this,[{cssClass:i._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:i._jsPlumb}]);f.renderer.paint=function(r,f,e){var v=u.getSegments(),a="",o=[0,0],h,p,w;for(e.xmin<0&&(o[0]=-e.xmin),e.ymin<0&&(o[1]=-e.ymin),h=0;h<v.length;h++)a+=jsPlumb.Segments.svg.SegmentRenderer.getPath(v[h]),a+=" ";var c={d:a,transform:"translate("+o[0]+","+o[1]+")","pointer-events":i["pointer-events"]||"visibleStroke"},l=null,y=[u.x,u.y,u.w,u.h];r.outlineColor&&(p=r.outlineWidth||1,w=r.lineWidth+2*p,l=jsPlumb.CurrentLibrary.extend({},r),l.strokeStyle=jsPlumbUtil.convertStyle(r.outlineColor),l.lineWidth=w,u.bgPath==null?(u.bgPath=n("path",c),d(u.svg,u.bgPath,0),u.attachListeners(u.bgPath,u)):t(u.bgPath,c),s(u.svg,u.bgPath,l,y,u));u.path==null?(u.path=n("path",c),d(u.svg,u.path,r.outlineColor?1:0),u.attachListeners(u.path,u)):t(u.path,c);s(u.svg,u.path,r,y,u)};this.reattachListeners=function(){this.bgPath&&this.reattachListenersForElement(this.bgPath,this);this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,r);jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(n){return{Straight:function(){var t=n.getCoordinates();return"M "+t.x1+" "+t.y1+" L "+t.x2+" "+t.y2},Bezier:function(){var t=n.params;return"M "+t.x1+" "+t.y1+" C "+t.cp1x+" "+t.cp1y+" "+t.cp2x+" "+t.cp2y+" "+t.x2+" "+t.y2},Arc:function(){var t=n.params,i=n.sweep>Math.PI?1:0,r=n.anticlockwise?0:1;return"M"+n.x1+" "+n.y1+" A "+n.radius+" "+t.r+" 0 "+i+","+r+" "+n.x2+" "+n.y2}}[n.type]()}}};u=window.SvgEndpoint=function(n){var t=r.apply(this,[{cssClass:n._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:n._jsPlumb}]);t.renderer.paint=function(n){var t=jsPlumb.extend({},n);t.outlineColor&&(t.strokeWidth=t.outlineWidth,t.strokeStyle=jsPlumbUtil.convertStyle(t.outlineColor,!0));this.node==null?(this.node=this.makeNode(t),this.svg.appendChild(this.node),this.attachListeners(this.node,this)):this.updateNode!=null&&this.updateNode(this.node);s(this.svg,this.node,t,[this.x,this.y,this.w,this.h],this);e(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(u,r,{reattachListeners:function(){this.node&&this.reattachListenersForElement(this.node,this)}});jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);u.apply(this,arguments);this.makeNode=function(){return n("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(n){t(n,{cx:this.w/2,cy:this.h/2,r:this.radius})}};jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,u]);jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);u.apply(this,arguments);this.makeNode=function(){return n("rect",{width:this.w,height:this.h})};this.updateNode=function(n){t(n,{width:this.w,height:this.h})}};jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,u]);jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;i=function(i,r){var f,u;i.apply(this,r);jsPlumb.jsPlumbUIComponent.apply(this,r);this.isAppendedAtTopLevel=!1;f=this;this.path=null;this.paint=function(i,f){if(i.component.svg&&f){this.path==null&&(this.path=n("path",{"pointer-events":"all"}),i.component.svg.appendChild(this.path),this.attachListeners(this.path,i.component),this.attachListeners(this.path,this));var o=r&&r.length==1?r[0].cssClass||"":"",e=[0,0];f.xmin<0&&(e[0]=-f.xmin);f.ymin<0&&(e[1]=-f.ymin);t(this.path,{d:u(i.d),"class":o,stroke:i.strokeStyle?i.strokeStyle:null,fill:i.fillStyle?i.fillStyle:null,transform:"translate("+e[0]+","+e[1]+")"})}};u=function(n){return"M"+n.hxy.x+","+n.hxy.y+" L"+n.tail[0].x+","+n.tail[0].y+" L"+n.cxy.x+","+n.cxy.y+" L"+n.tail[1].x+","+n.tail[1].y+" L"+n.hxy.x+","+n.hxy.y};this.reattachListeners=function(){this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(i,[jsPlumb.jsPlumbUIComponent,jsPlumb.Overlays.AbstractOverlay],{cleanup:function(){this.path!=null&&jsPlumb.CurrentLibrary.removeElement(this.path)},setVisible:function(n){this.path!=null&&(this.path.style.display=n?"block":"none")}});jsPlumb.Overlays.svg.Arrow=function(){i.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,i]);jsPlumb.Overlays.svg.PlainArrow=function(){i.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,i]);jsPlumb.Overlays.svg.Diamond=function(){i.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,i]);jsPlumb.Overlays.svg.GuideLines=function(){var r=null,i=this,u,f,e;jsPlumb.Overlays.GuideLines.apply(this,arguments);this.paint=function(o,s){r==null&&(r=n("path"),o.connector.svg.appendChild(r),i.attachListeners(r,o.connector),i.attachListeners(r,i),u=n("path"),o.connector.svg.appendChild(u),i.attachListeners(u,o.connector),i.attachListeners(u,i),f=n("path"),o.connector.svg.appendChild(f),i.attachListeners(f,o.connector),i.attachListeners(f,i));var h=[0,0];s.xmin<0&&(h[0]=-s.xmin);s.ymin<0&&(h[1]=-s.ymin);t(r,{d:e(o.head,o.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"});t(u,{d:e(o.tailLine[0],o.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+h[1]+")"});t(f,{d:e(o.headLine[0],o.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};e=function(n,t){return"M "+n.x+","+n.y+" L"+t.x+","+t.y}};jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}(),function(){var w={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},l=null,h,a,s,p,o,r;if(document.createStyleSheet&&document.namespaces){for(h=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],a="behavior:url(#default#VML);position:absolute;",l=document.createStyleSheet(),s=0;s<h.length;s++)l.addRule(h[s],a);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var t=1e3,v={},b=function(n,r){var f=jsPlumb.getId(n),u=v[f];return u||(u=i("group",[0,0,t,t],{"class":r}),u.style.backgroundColor="red",v[f]=u),u},f=function(n,t){for(var i in t)n[i]=t[i]},i=function(n,t,i,r,u,o){i=i||{};var s=document.createElement("jsplumb:"+n);return o?u.appendElement(s,r):jsPlumb.CurrentLibrary.appendElement(s,r),s.className=(i["class"]?i["class"]+" ":"")+"jsplumb_vml",e(s,t),f(s,i),s},e=function(n,t,i){n.style.left=t[0]+"px";n.style.top=t[1]+"px";n.style.width=t[2]+"px";n.style.height=t[3]+"px";n.style.position="absolute";i&&(n.style.zIndex=i)},n=jsPlumb.vml.convertValue=function(n){return Math.floor(n*t)},y=function(n,t,i,r){"transparent"===t?r.setOpacity(i,"0.0"):r.setOpacity(i,"1.0")},c=function(n,t,r,u){var e={},s,h,o;if(t.strokeStyle?(e.stroked="true",s=jsPlumbUtil.convertStyle(t.strokeStyle,!0),e.strokecolor=s,y(e,s,"stroke",r),e.strokeweight=t.lineWidth+"px"):e.stroked="false",t.fillStyle?(e.filled="true",h=jsPlumbUtil.convertStyle(t.fillStyle,!0),e.fillcolor=h,y(e,h,"fill",r)):e.filled="false",t.dashstyle)r.strokeNode==null?r.strokeNode=i("stroke",[0,0,0,0],{dashstyle:t.dashstyle},n,u):r.strokeNode.dashstyle=t.dashstyle;else if(t["stroke-dasharray"]&&t.lineWidth){var l=t["stroke-dasharray"].indexOf(",")==-1?" ":",",a=t["stroke-dasharray"].split(l),c="";for(o=0;o<a.length;o++)c+=Math.floor(a[o]/t.lineWidth)+l;r.strokeNode==null?r.strokeNode=i("stroke",[0,0,0,0],{dashstyle:c},n,u):r.strokeNode.dashstyle=c}f(n,e)},u=function(){var n=this,t;jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(t){n.opacityNodes.stroke=i("stroke",[0,0,1,1],{opacity:"0.0"},t,n._jsPlumb.instance);n.opacityNodes.fill=i("fill",[0,0,1,1],{opacity:"0.0"},t,n._jsPlumb.instance)};this.setOpacity=function(t,i){var r=n.opacityNodes[t];r&&(r.opacity=""+i)};t=[];this.getDisplayElements=function(){return t};this.appendDisplayElement=function(i,r){r||n.canvas.parentNode.appendChild(i);t.push(i)}};jsPlumbUtil.extend(u,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&jsPlumbUtil.removeElement(this.bgCanvas);jsPlumbUtil.removeElement(this.canvas)}});p=jsPlumb.ConnectorRenderers.vml=function(n){this.strokeNode=null;this.canvas=null;u.apply(this,arguments);var r=this._jsPlumb.instance.connectorClass+(n.cssClass?" "+n.cssClass:"");this.paint=function(u){var h,l;if(u!==null){this.w=Math.max(this.w,1);this.h=Math.max(this.h,1);var a=this.getSegments(),s={path:""},o=[this.x,this.y,this.w,this.h];for(h=0;h<a.length;h++)s.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(a[h]),s.path+=" ";if(u.outlineColor){var y=u.outlineWidth||1,p=u.lineWidth+2*y,v={strokeStyle:jsPlumbUtil.convertStyle(u.outlineColor),lineWidth:p};for(l in w)v[l]=u[l];this.bgCanvas==null?(s["class"]=r,s.coordsize=o[2]*t+","+o[3]*t,this.bgCanvas=i("shape",o,s,n.parent,this._jsPlumb.instance,!0),e(this.bgCanvas,o),this.appendDisplayElement(this.bgCanvas,!0),this.attachListeners(this.bgCanvas,this),this.initOpacityNodes(this.bgCanvas,["stroke"])):(s.coordsize=o[2]*t+","+o[3]*t,e(this.bgCanvas,o),f(this.bgCanvas,s));c(this.bgCanvas,v,this)}this.canvas==null?(s["class"]=r,s.coordsize=o[2]*t+","+o[3]*t,this.canvas=i("shape",o,s,n.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.attachListeners(this.canvas,this),this.initOpacityNodes(this.canvas,["stroke"])):(s.coordsize=o[2]*t+","+o[3]*t,e(this.canvas,o),f(this.canvas,s));c(this.canvas,u,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(p,u,{reattachListeners:function(){this.canvas&&this.reattachListenersForElement(this.canvas,this)},setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none");this.bgCanvas&&(this.bgCanvas.style.display=n?"block":"none")}});o=window.VmlEndpoint=function(n){u.apply(this,arguments);this._jsPlumb.vml=null;this.canvas=document.createElement("div");this.canvas.style.position="absolute";this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(n.cssClass?" "+n.cssClass:"");n._jsPlumb.appendElement(this.canvas,n.parent);this.paint=function(n,t){var r={},i=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h);this._jsPlumb.vml==null?(r["class"]=this._jsPlumb.clazz,i=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],r,t,this.canvas,this._jsPlumb.instance),this.attachListeners(i,this),this.appendDisplayElement(i,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(i,["fill"])):(e(i,[0,0,this.w,this.h]),f(i,r));c(i,n,this)}};jsPlumbUtil.extend(o,u,{reattachListeners:function(){this._jsPlumb.vml&&this.reattachListenersForElement(this._jsPlumb.vml,this)}});jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var i=t.params;return"m"+n(i.x1)+","+n(i.y1)+" l"+n(i.x2)+","+n(i.y2)+" e"},Bezier:function(t){var i=t.params;return"m"+n(i.x1)+","+n(i.y1)+" c"+n(i.cp1x)+","+n(i.cp1y)+","+n(i.cp2x)+","+n(i.cp2y)+","+n(i.x2)+","+n(i.y2)+" e"},Arc:function(t){var i=t.params,r=Math.min(i.x1,i.x2),s=Math.max(i.x1,i.x2),u=Math.min(i.y1,i.y2),h=Math.max(i.y1,i.y2),f=t.anticlockwise?1:0,e=t.anticlockwise?"at ":"wa ",o=function(){if(i.loopback)return"0,0,"+n(2*i.r)+","+n(2*i.r);var e=[null,[function(){return[r,u]},function(){return[r-i.r,u-i.r]}],[function(){return[r-i.r,u]},function(){return[r,u-i.r]}],[function(){return[r-i.r,u-i.r]},function(){return[r,u]}],[function(){return[r,u-i.r]},function(){return[r-i.r,u]}]][t.segment][f]();return n(e[0])+","+n(e[1])+","+n(e[0]+2*i.r)+","+n(e[1]+2*i.r)};return e+" "+o()+","+n(i.x1)+","+n(i.y1)+","+n(i.x2)+","+n(i.y2)+" e"}}[t.type](t)}}};jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);o.apply(this,arguments);this.getVml=function(n,t,r,u,f){return i("oval",n,t,u,f)}};jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,o);jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);o.apply(this,arguments);this.getVml=function(n,t,r,u,f){return i("rect",n,t,u,f)}};jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,o);jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;r=function(r,o){var s,c,h;r.apply(this,o);u.apply(this,o);s=this;c=null;s.canvas=null;s.isAppendedAtTopLevel=!0;h=function(t){return"m "+n(t.hxy.x)+","+n(t.hxy.y)+" l "+n(t.tail[0].x)+","+n(t.tail[0].y)+" "+n(t.cxy.x)+","+n(t.cxy.y)+" "+n(t.tail[1].x)+","+n(t.tail[1].y)+" x e"};this.paint=function(n,r){var p,w;if(n.component.canvas&&r){var l={},u=n.d,c=n.component;n.strokeStyle&&(l.stroked="true",l.strokecolor=jsPlumbUtil.convertStyle(n.strokeStyle,!0));n.lineWidth&&(l.strokeweight=n.lineWidth+"px");n.fillStyle&&(l.filled="true",l.fillcolor=n.fillStyle);var v=Math.min(u.hxy.x,u.tail[0].x,u.tail[1].x,u.cxy.x),y=Math.min(u.hxy.y,u.tail[0].y,u.tail[1].y,u.cxy.y),b=Math.max(u.hxy.x,u.tail[0].x,u.tail[1].x,u.cxy.x),k=Math.max(u.hxy.y,u.tail[0].y,u.tail[1].y,u.cxy.y),d=Math.abs(b-v),g=Math.abs(k-y),a=[v,y,d,g];l.path=h(u);l.coordsize=c.w*t+","+c.h*t;a[0]=c.x;a[1]=c.y;a[2]=c.w;a[3]=c.h;s.canvas==null?(p=c._jsPlumb.overlayClass||"",w=o&&o.length==1?o[0].cssClass||"":"",l["class"]=w+" "+p,s.canvas=i("shape",a,l,c.canvas.parentNode,c._jsPlumb.instance,!0),c.appendDisplayElement(s.canvas,!0),s.attachListeners(s.canvas,c),s.attachListeners(s.canvas,s)):(e(s.canvas,a),f(s.canvas,l))}};this.reattachListeners=function(){s.canvas&&s.reattachListenersForElement(s.canvas,s)};this.cleanup=function(){s.canvas!=null&&jsPlumb.CurrentLibrary.removeElement(s.canvas)}};jsPlumbUtil.extend(r,[u,jsPlumb.Overlays.AbstractOverlay],{setVisible:function(n){this.canvas.style.display=n?"block":"none"}});jsPlumb.Overlays.vml.Arrow=function(){r.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,r]);jsPlumb.Overlays.vml.PlainArrow=function(){r.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,r]);jsPlumb.Overlays.vml.Diamond=function(){r.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,r])}(),function(n){var t=function(t){return typeof t=="string"?n("#"+t):n(t)};jsPlumb.CurrentLibrary={addClass:function(n,i){n=t(n);try{n[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(n[0],i)}catch(r){}try{n.addClass(i)}catch(r){}},animate:function(n,t,i){n.animate(t,i)},appendElement:function(n,i){t(i).append(n)},ajax:function(t){t=t||{};t.type=t.type||"get";n.ajax(t)},bind:function(n,i,r){n=t(n);n.bind(i,r)},destroyDraggable:function(t){n(t).data("draggable")&&n(t).draggable("destroy")},destroyDroppable:function(t){n(t).data("droppable")&&n(t).droppable("destroy")},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(t,i){return n.extend(t,i)},getClientXY:function(n){return[n.clientX,n.clientY]},getDragObject:function(n){return n[1].draggable||n[1].helper},getDragScope:function(t){return n(t).draggable("option","scope")},getDropEvent:function(n){return n[0]},getDropScope:function(t){return n(t).droppable("option","scope")},getDOMElement:function(n){return n==null?null:typeof n=="string"?document.getElementById(n):n.context||n.length!=null?n[0]:n},getElementObject:t,getOffset:function(n){return n.offset()},getOriginalEvent:function(n){return n.originalEvent},getPageXY:function(n){return[n.pageX,n.pageY]},getParent:function(n){return t(n).parent()},getScrollLeft:function(n){return n.scrollLeft()},getScrollTop:function(n){return n.scrollTop()},getSelector:function(i,r){return arguments.length==2?t(i).find(r):n(i)},getSize:function(t){return t=n(t),[t.outerWidth(),t.outerHeight()]},getTagName:function(n){var i=t(n);return i.length>0?i[0].tagName:null},getUIPosition:function(n,t){if(t=t||1,n.length==1)ret={left:n[0].pageX,top:n[0].pageY};else{var i=n[1],r=i.offset;ret=r||i.absolutePosition;i.position.left/=t;i.position.top/=t}return{left:ret.left/t,top:ret.top/t}},hasClass:function(n,t){return n.hasClass(t)},initDraggable:function(t,i,r,u){i=i||{};t=n(t);i.start=jsPlumbUtil.wrap(i.start,function(){n("body").addClass(u.dragSelectClass)},!1);i.stop=jsPlumbUtil.wrap(i.stop,function(){n("body").removeClass(u.dragSelectClass)});i.doNotRemoveHelper||(i.helper=null);r&&(i.scope=i.scope||jsPlumb.Defaults.Scope);t.draggable(i)},initDroppable:function(t,i){i.scope=i.scope||jsPlumb.Defaults.Scope;n(t).droppable(i)},isAlreadyDraggable:function(t){return n(t).hasClass("ui-draggable")},isDragSupported:function(t){return n(t).draggable},isDropSupported:function(t){return n(t).droppable},removeClass:function(n,i){n=t(n);try{if(n[0].className.constructor==SVGAnimatedString){jsPlumbUtil.svg.removeClass(n[0],i);return}}catch(r){}n.removeClass(i)},removeElement:function(n){t(n).remove()},setDragFilter:function(n,t){jsPlumb.CurrentLibrary.isAlreadyDraggable(n)&&n.draggable("option","cancel",t)},setDraggable:function(n,t){n.draggable("option","disabled",!t)},setDragScope:function(n,t){n.draggable("option","scope",t)},setOffset:function(n,i){t(n).offset(i)},trigger:function(n,i,r){var u=jQuery._data(t(n)[0],"handle");u(r)},unbind:function(n,i,r){n=t(n);n.unbind(i,r)}};n(document).ready(jsPlumb.init)}(jQuery),function(){"use strict";var f=this,n=typeof exports!="undefined"?exports:f.jsPlumbGeom={};var r=function(n){return Object.prototype.toString.call(n)==="[object Array]"},t=function(n,t,i){return n=r(n)?n:[n.x,n.y],t=r(t)?t:[t.x,t.y],i(n,t)},i=n.gradient=function(n,i){return t(n,i,function(n,t){return t[0]==n[0]?t[1]>n[1]?Infinity:-Infinity:t[1]==n[1]?t[0]>n[0]?0:-0:(t[1]-n[1])/(t[0]-n[0])})},s=n.normal=function(n,t){return-1/i(n,t)},h=n.lineLength=function(n,i){return t(n,i,function(n,t){return Math.sqrt(Math.pow(t[1]-n[1],2)+Math.pow(t[0]-n[0],2))})},u=n.quadrant=function(n,i){return t(n,i,function(n,t){return t[0]>n[0]?t[1]>n[1]?2:1:t[0]==n[0]?t[1]>n[1]?2:1:t[1]>n[1]?3:4})},c=n.theta=function(n,r){return t(n,r,function(n,t){var e=i(n,t),r=Math.atan(e),f=u(n,t);return(f==4||f==3)&&(r+=Math.PI),r<0&&(r+=2*Math.PI),r})},l=n.intersects=function(n,t){var i=n.x,s=n.x+n.w,u=n.y,f=n.y+n.h,r=t.x,h=t.x+t.w,e=t.y,o=t.y+t.h;return i<=r&&r<=s&&u<=e&&e<=f||i<=h&&h<=s&&u<=e&&e<=f||i<=r&&r<=s&&u<=o&&o<=f||i<=h&&r<=s&&u<=o&&o<=f||r<=i&&i<=h&&e<=u&&u<=o||r<=s&&s<=h&&e<=u&&u<=o||r<=i&&i<=h&&e<=f&&f<=o||r<=s&&i<=h&&e<=f&&f<=o},e=[null,[1,-1],[1,1],[-1,1],[-1,-1]],o=[null,[-1,-1],[-1,1],[1,1],[1,-1]],a=n.pointOnLine=function(n,t,r){var c=i(n,t),f=u(n,t),s=r>0?e[f]:o[f],h=Math.atan(c),l=Math.abs(r*Math.sin(h))*s[1],a=Math.abs(r*Math.cos(h))*s[0];return{x:n.x+a,y:n.y+l}},v=n.perpendicularLineTo=function(n,t,r){var o=i(n,t),u=Math.atan(-1/o),f=r/2*Math.sin(u),e=r/2*Math.cos(u);return[{x:t.x+e,y:t.y+f},{x:t.x-e,y:t.y-f}]}}.call(this),function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(n){return 0==n?0:0<n?1:-1});var n={subtract:function(n,t){return{x:n.x-t.x,y:n.y-t.y}},dotProduct:function(n,t){return n.x*t.x+n.y*t.y},square:function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},scale:function(n,t){return{x:n.x*t,y:n.y*t}}},c=Math.pow(2,-65),e=function(t,i){for(var v,y=[],o=i.length-1,e=2*o-1,h=[],l=[],s=[],c=[],a=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],f=0;f<=o;f++)h[f]=n.subtract(i[f],t);for(f=0;f<=o-1;f++)l[f]=n.subtract(i[f+1],i[f]),l[f]=n.scale(l[f],3);for(f=0;f<=o-1;f++)for(v=0;v<=o;v++)s[f]||(s[f]=[]),s[f][v]=n.dotProduct(l[f],h[v]);for(f=0;f<=e;f++)c[f]||(c[f]=[]),c[f].y=0,c[f].x=parseFloat(f)/e;for(e=o-1,h=0;h<=o+e;h++)for(f=Math.max(0,h-e),l=Math.min(h,o);f<=l;f++)j=h-f,c[f+j].y+=s[j][f]*a[j][f];for(o=i.length-1,c=r(c,2*o-1,y,0),e=n.subtract(t,i[0]),s=n.square(e),f=a=0;f<c;f++)e=n.subtract(t,u(i,o,y[f],null,null)),e=n.square(e),e<s&&(s=e,a=y[f]);return e=n.subtract(t,i[o]),e=n.square(e),e<s&&(s=e,a=1),{location:a,distance:s}},r=function(n,t,i,f){for(var p=[],w=[],v=[],y=[],h=0,s,l,o,e=Math.sgn(n[0].y),a=1;a<=t;a++)s=Math.sgn(n[a].y),s!=e&&h++,e=s;switch(h){case 0:return 0;case 1:if(64<=f)return i[0]=(n[0].x+n[t].x)/2,1;for(h=n[0].y-n[t].y,e=n[t].x-n[0].x,a=n[0].x*n[t].y-n[t].x*n[0].y,s=max_distance_below=0,l=1;l<t;l++)o=h*n[l].x+e*n[l].y+a,o>s?s=o:o<max_distance_below&&(max_distance_below=o);if(o=e,l=0*o-1*h,s=(1*(a-s)-0*o)*(1/l),o=e,e=a-max_distance_below,l=0*o-1*h,h=(1*e-0*o)*(1/l),e=Math.min(s,h),Math.max(s,h)-e<c)return v=n[t].x-n[0].x,y=n[t].y-n[0].y,i[0]=0+1*(v*(n[0].y-0)-y*(n[0].x-0))*(1/(0*v-1*y)),1}for(u(n,t,.5,p,w),n=r(p,t,v,f+1),t=r(w,t,y,f+1),f=0;f<n;f++)i[f]=v[f];for(f=0;f<t;f++)i[f+n]=y[f];return n+t},u=function(n,t,i,r,u){for(var e=[[]],f=0;f<=t;f++)e[0][f]=n[f];for(n=1;n<=t;n++)for(f=0;f<=t-n;f++)e[n]||(e[n]=[]),e[n][f]||(e[n][f]={}),e[n][f].x=(1-i)*e[n-1][f].x+i*e[n-1][f+1].x,e[n][f].y=(1-i)*e[n-1][f].y+i*e[n-1][f+1].y;if(null!=r)for(f=0;f<=t;f++)r[f]=e[f][0];if(null!=u)for(f=0;f<=t;f++)u[f]=e[t-f][f];return e[t][0]},o={},t=function(n,t){var i,u=n.length-1,e,c,f;if(i=o[u],!i){i=[];var s=function(n){return function(){return n}},h=function(){return function(n){return n}},r=function(){return function(n){return 1-n}},l=function(n){return function(t){for(var r=1,i=0;i<n.length;i++)r*=n[i](t);return r}};for(i.push(new function(){return function(n){return Math.pow(n,u)}}),e=1;e<u;e++){for(c=[new s(u)],f=0;f<u-e;f++)c.push(new h);for(f=0;f<e;f++)c.push(new r);i.push(new l(c))}i.push(new function(){return function(n){return Math.pow(1-n,u)}});o[u]=i}for(r=h=s=0;r<n.length;r++)s+=n[r].x*i[r](t),h+=n[r].y*i[r](t);return{x:s,y:h}},s=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},h=function(n){return n[0].x==n[1].x&&n[0].y==n[1].y},i=function(n,i,r){if(h(n))return{point:n[0],location:i};for(var f=t(n,i),e=0,o=0<r?1:-1,u=null;e<Math.abs(r);)i+=.005*o,u=t(n,i),e+=s(u,f),f=u;return{point:u,location:i}},f=function(n,i){var r=t(n,i),u=t(n.slice(0,n.length-1),i),f=u.y-r.y,r=u.x-r.x;return 0==f?Infinity:Math.atan(f/r)};window.jsBezier={distanceFromCurve:e,gradientAtPoint:f,gradientAtPointAlongCurveFrom:function(n,t,r){return t=i(n,t,r),1<t.location&&(t.location=1),0>t.location&&(t.location=0),f(n,t.location)},nearestPointOnCurve:function(n,t){var i=e(n,t);return{point:u(t,t.length-1,i.location,null,null),location:i.location}},pointOnCurve:t,pointAlongCurveFrom:function(n,t,r){return i(n,t,r).point},perpendicularToCurveAt:function(n,t,r,u){return t=i(n,t,null==u?0:u),n=f(n,t.location),u=Math.atan(-1/n),n=r/2*Math.sin(u),r=r/2*Math.cos(u),[{x:t.point.x+r,y:t.point.y+n},{x:t.point.x-r,y:t.point.y-n}]},locationAlongCurveFrom:function(n,t,r){return i(n,t,r).location},getLength:function(n){if(h(n))return 0;for(var u=t(n,0),f=0,i=0,r=null;1>i;)i+=.005,r=t(n,i),f+=s(r,u),u=r;return f}}}();
/*
//# sourceMappingURL=bundle.min.js.map
*/