{"version":3,"sources":["string.js","_pager.js","_ko.workflow.js","_ko.entity.js","_ko.kendo.js","_ko.bootstrap.js","_function.prototypes.js","_constants.js","_uiready.js","_utils.js","_task.js","_theme.js","_references.js"],"names":["window","$type","String","__typeName","__class","$prototype","prototype","endsWith","suffix","substr","length","startsWith","prefix","trim","replace","trimEnd","trimStart","format","args","_toFormattedString","arguments","useLocale","result","i","open","indexOf","close","slice","charAt","Error","brace","substring","colonIndex","argNumber","parseInt","isNaN","argFormat","arg","toFormattedString","localeFormat","toString","bespoke","utils","ServerPager","options","element","count","sizes","defaultSize","changed","console","log","self2","rows","_","range","pagerDataSource","kendo","data","DataSource","pageSize","hidden","pager","kendoPager","dataSource","pageSizes","page","bind","update","count2","j","setTimeout","destroy","empty","size","pg","dropdownlist","$","find","value","e","ko","bindingHandlers","workflowFormPathIntellisense","init","valueAccessor","allBindingsAccessor","schema","unwrap","allBindings","input","div","css","hide","before","c","completely","fontSize","color","fontFamily","ix","setText","hasOwnProperty","push","sort","currentObject","onChange","text","lastIndexOf","props","split","each","v","startFrom","repaint","attr","blur","val","parent","prop","activityClass","act","fullName","name","exec","addClass","checkedItems","item","dataFor","list","change","checked","is","remove","typeahead","id","members","Bloodhound","datumTokenizer","d","tokenizers","whitespace","Path","queryTokenizer","nonword","prefetch","initialize","highlight","displayKey","source","ttAdapter","on","typeaheadExceptions","exceptions","activityPopover","wd","pop","popover","title","Name","html","content","WebId","document","preventDefault","app","require","objectbuilders","link","hasClass","showMessage","done","removeActivity","editActivity","setStartActivity","comboBoxLookupOptions","$select","lookup","caption","context","displayPath","valuePath","setup","query","promise","getListAsync","entity","getTuplesAsync","field","field2","add","Option","Item1","Item2","subscribe","tree","memberNameSubscription","memberAllowMultipleSubscription","memberIsNullableSubscription","memberTypeNameSubscription","system","searchbox","member","selected","jsTreeData","state","opened","getNodeMemberType","type","TypeName","recurseChildMember","node","children","MemberCollection","map","setNodePropertyForChildOfValueObject","tag","isObservable","childOfValueMember","observable","ref","jstree","parents","n","get_node","valueMember","setAllowMultipleAndNullableIcons","schemaTree1","mbr","IsNullable","after","AllowMultiple","dispose","allowFilter","cm","mb1","edit","rename_node","set_type","oldParent","old_parent","oldCollections","collection","splice","position","forEach","ev","mb","operation","nodeParent","nodePosition","more","target","$node","sel","get_selected","simpleMenu","label","action","child","sph","domain","SimpleMember","guid","create_node","valueObjectMenu","ValueObjectMember","complexChildMenu","ComplexMember","removeMenu","p","parentMember","child2","delete_node","items","schemaTree","index","li","to","keyup","clearTimeout","search","help","href","click","substringMatcher","strs","q","cb","matches","substringRegex","RegExp","str","test","typeaheadUrl","types","url","suggestions","obj","limit","remote","tt1","filter","entityTypeaheadPath","datacontext","config","idOrName","typeaheadEntity","eid","camel","match","p1","p2","offset","toUpperCase","toLowerCase","ed","toJS","applicationName","hideDropDown","loadOneAsync","edf","Id","cssTypeahead","extractor","paths","path","s","local","minLength","updater","$element","matcher","tquery","chart","Entity","JSON","parse","Query","Type","tcs","Deferred","searchAsync","buckets","aggregations","category","key_as_string","key","doc_count","categories","kendoChart","theme","chartArea","background","legend","seriesDefaults","labels","visible","template","series","categoryAxis","majorGridLines","tooltip","resolve","getScalarAsync","EntityViewId","viewName","refresh","iconPicker","$input","$picker","append","dialog","app2","showDialog","icon","observableArray","getSingletonObservableArray","$link","stopPropagation","virtualElements","allowedBindings","lookupText","setTextContent","ele","textContent","unwrapObservable","innerTextNode","firstChild","nodeType","nextSibling","setDomNodeChildren","ownerDocument","createTextNode","readonly","ro","kendoEditor","$editor","updating","editor","update2","ke","kendoDropDownListValue","currentModelValue","dd","nv","modelValue","kendoComboBox","decimal","money","textbox","initBinding","parseFloat","fm","toFixed","a","tagName","tv","date","dv","defaultFormat","inputFormat","moment","invalid","year","dateString","kendoUpload","logger","extensions","async","saveUrl","removeUrl","autoUpload","multiple","error","logError","select","files","extension","join","success","info","storeId","response","uploaded","removed","oldFile","post","stringify","then","kendoDate","currentValue","picker","kendoDatePicker","enable","toDate","kendoDateTime","kendoDateTimePicker","slideVisible","toggle","slideDown","slideUp","kendoEnable","removeClass","removeAttr","command","viewModel","$button","inputValue","isvisible","show","$spinner","$warning","form","checkValidity","fail","err","o","message","button","status","statusText","responseJSON","responseMessage","Message","details","Details","responseText","unwrapClick","property","accessor","fieldImage","img","ft","stringArrayAutoComplete","kendoAutoComplete","placeholder","separator","pathAutoComplete","get","json","chain","t","dataTextField","which","filtered","commandWithParameter","callback","parameter","commandParameter","responseJson","bindingAccessor","$filterInput","$serverLoadButton","$form","pagedSearch","searchPaging","customSearch","submit","filterAndSearch","previousFilter","dofilter","$rows","$tr","throttled","throttle","siblings","serverPaging","enableReload","hasCommands","toolbar","commands","pagerHidden","$pagerPanel","startLoad","fadeTo","endLoad","setItemsSource","loadAsync","includeTotal","lo","itemCollection","commandId","reloadCommand","x","executedQuery","initialQuery","searchButton","cultures","pageChanged","tcs1","pagerOptions","originalQuery","toJSON","fullTextQuery","bool","must","messages","FORM_IS_NOT_VALID","bootstrapDropDown","valueAccesor","anchor","one","optionOrText","placement","tooltipPlacement","bootstrapPopover","bootstrapTooltip","cssAutoComplete","bootstrap","styleSheets","rules","r","selectorText","autocomplete","va","ttl","scroll","Function","partial","fn","Array","call","apply","ServerOperationStatus","OK","ERROR","messagesText","SAVE_SUCCESS","_uiready","view","getElementById","dir","jQuery","Task","fromResult","returnValue","delay","bindingContext","valueUnwrapped","Theme"],"mappings":"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","file":"__core.min.js","sourcesContent":["// String.js - liberated from MicrosoftAjax.js on 03/28/10 by Sky Sanders \r\n\r\n/*\r\n    Copyright (c) 2009, CodePlex Foundation\r\n    All rights reserved.\r\n\r\n    Redistribution and use in source and binary forms, with or without modification, are permitted \r\n    provided that the following conditions are met:\r\n\r\n    *   Redistributions of source code must retain the above copyright notice, this list of conditions \r\n        and the following disclaimer.\r\n\r\n    *   Redistributions in binary form must reproduce the above copyright notice, this list of conditions \r\n        and the following disclaimer in the documentation and/or other materials provided with the distribution.\r\n\r\n    *   Neither the name of CodePlex Foundation nor the names of its contributors may be used to endorse or \r\n        promote products derived from this software without specific prior written permission.\r\n\r\n    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED \r\n    WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR \r\n    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE \r\n    FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT \r\n    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS \r\n    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, \r\n    OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN \r\n    IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</textarea>\r\n*/\r\n\r\n(function (window) {\r\n\r\n    $type = String;\r\n    $type.__typeName = 'String';\r\n    $type.__class = true;\r\n\r\n    $prototype = $type.prototype;\r\n    $prototype.endsWith = function String$endsWith(suffix) {\r\n        /// <summary>Determines whether the end of this instance matches the specified string.</summary>\r\n        /// <param name=\"suffix\" type=\"String\">A string to compare to.</param>\r\n        /// <returns type=\"Boolean\">true if suffix matches the end of this instance; otherwise, false.</returns>\r\n        return (this.substr(this.length - suffix.length) === suffix);\r\n    };\r\n\r\n    $prototype.startsWith = function String$startsWith(prefix) {\r\n        /// <summary >Determines whether the beginning of this instance matches the specified string.</summary>\r\n        /// <param name=\"prefix\" type=\"String\">The String to compare.</param>\r\n        /// <returns type=\"Boolean\">true if prefix matches the beginning of this string; otherwise, false.</returns>\r\n        return (this.substr(0, prefix.length) === prefix);\r\n    };\r\n\r\n    $prototype.trim = function String$trim() {\r\n        /// <summary >Removes all leading and trailing white-space characters from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the start and end of the current String object.</returns>\r\n        return this.replace(/^\\s+|\\s+$/g, '');\r\n    };\r\n\r\n    $prototype.trimEnd = function String$trimEnd() {\r\n        /// <summary >Removes all trailing white spaces from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the end of the current String object.</returns>\r\n        return this.replace(/\\s+$/, '');\r\n    };\r\n\r\n    $prototype.trimStart = function String$trimStart() {\r\n        /// <summary >Removes all leading white spaces from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the start of the current String object.</returns>\r\n        return this.replace(/^\\s+/, '');\r\n    }\r\n\r\n    $type.format = function String$format(format, args) {\r\n        /// <summary>Replaces the format items in a specified String with the text equivalents of the values of   corresponding object instances. The invariant culture will be used to format dates and numbers.</summary>\r\n        /// <param name=\"format\" type=\"String\">A format string.</param>\r\n        /// <param name=\"args\" parameterArray=\"true\" mayBeNull=\"true\">The objects to format.</param>\r\n        /// <returns type=\"String\">A copy of format in which the format items have been replaced by the   string equivalent of the corresponding instances of object arguments.</returns>\r\n        return String._toFormattedString(false, arguments);\r\n    };\r\n\r\n    $type._toFormattedString = function String$_toFormattedString(useLocale, args) {\r\n        var result = '';\r\n        var format = args[0];\r\n\r\n        for (var i = 0;;) {\r\n            // Find the next opening or closing brace\r\n            var open = format.indexOf('{', i);\r\n            var close = format.indexOf('}', i);\r\n            if ((open < 0) && (close < 0)) {\r\n                // Not found: copy the end of the string and break\r\n                result += format.slice(i);\r\n                break;\r\n            }\r\n            if ((close > 0) && ((close < open) || (open < 0))) {\r\n\r\n                if (format.charAt(close + 1) !== '}') {\r\n                    throw new Error('format stringFormatBraceMismatch');\r\n                }\r\n\r\n                result += format.slice(i, close + 1);\r\n                i = close + 2;\r\n                continue;\r\n            }\r\n\r\n            // Copy the string before the brace\r\n            result += format.slice(i, open);\r\n            i = open + 1;\r\n\r\n            // Check for double braces (which display as one and are not arguments)\r\n            if (format.charAt(i) === '{') {\r\n                result += '{';\r\n                i++;\r\n                continue;\r\n            }\r\n\r\n            if (close < 0) throw new Error('format stringFormatBraceMismatch');\r\n\r\n\r\n            // Find the closing brace\r\n\r\n            // Get the string between the braces, and split it around the ':' (if any)\r\n            var brace = format.substring(i, close);\r\n            var colonIndex = brace.indexOf(':');\r\n            var argNumber = parseInt((colonIndex < 0) ? brace : brace.substring(0, colonIndex), 10) + 1;\r\n\r\n            if (isNaN(argNumber)) throw new Error('format stringFormatInvalid');\r\n\r\n            var argFormat = (colonIndex < 0) ? '' : brace.substring(colonIndex + 1);\r\n\r\n            var arg = args[argNumber];\r\n            if (typeof(arg) === \"undefined\" || arg === null) {\r\n                arg = '';\r\n            }\r\n\r\n            // If it has a toFormattedString method, call it.  Otherwise, call toString()\r\n            if (arg.toFormattedString) {\r\n                result += arg.toFormattedString(argFormat);\r\n            } else if (useLocale && arg.localeFormat) {\r\n                result += arg.localeFormat(argFormat);\r\n            } else if (arg.format) {\r\n                result += arg.format(argFormat);\r\n            } else\r\n                result += arg.toString();\r\n\r\n            i = close + 1;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n})(window);","/// <reference path=\"toastr.js\" />\r\n/// <reference path=\"_ko.kendo.js\" />\r\n/// <reference path=\"../kendo/js/kendo.pager.js\" />\r\n/// <reference path=\"../kendo/js/kendo.all.js\" />\r\n\r\n\r\n\r\n\r\nvar bespoke = bespoke || {};\r\nbespoke.utils = {};\r\n\r\nbespoke.utils.ServerPager = function (options) {\r\n    options = options || {};\r\n    var element = options.element,\r\n        count = options.count || 0,\r\n        sizes = options.sizes || [10, 20, 50],\r\n        defaultSize = options.defaultSize || 20,\r\n        changed = options.changed || function () {\r\n            console.log(\"no change event\");\r\n        },\r\n        self2 = this,\r\n        rows = _.range(count),\r\n        pagerDataSource = new kendo.data.DataSource({\r\n            data: rows,\r\n            pageSize: defaultSize\r\n        });\r\n    if (options.hidden) {\r\n        return self2;\r\n    }\r\n\r\n    var pager = element.kendoPager({\r\n        dataSource: pagerDataSource,\r\n        pageSizes: sizes\r\n    }).data(\"kendoPager\");\r\n    pager.page(1);\r\n    pager.bind(\"change\", function () {\r\n        if (changed) {\r\n            changed(pager.page(), pager.pageSize());\r\n        }\r\n    });\r\n\r\n    self2.update = function (count2) {\r\n        rows = [];\r\n        for (var j = 0; j < count2 ; j++) {\r\n            rows[j] = j;\r\n        }\r\n        setTimeout(function () {\r\n            pagerDataSource.data(rows);\r\n        }, 500);\r\n    };\r\n    self2.destroy = function () {\r\n        pager.destroy();\r\n        element.empty();\r\n    };\r\n\r\n    self2.pageSize = function (size) {\r\n        if (size) {\r\n            pager.pageSize(size);\r\n        }\r\n        return pager.pageSize();\r\n    };\r\n    self2.page = function (pg) {\r\n        if (pg) {\r\n            pager.page(pg);\r\n        }\r\n        return pager.page();\r\n    };\r\n\r\n    var dropdownlist = $(element).find(\"select\").data(\"kendoDropDownList\");\r\n    if (dropdownlist) {\r\n        dropdownlist.bind(\"change\", function () {\r\n            try {\r\n                changed(1, parseInt(this.value()));\r\n            } catch (e) {\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    return self2;\r\n\r\n};","/// <reference path=\"jstree.min.js\" />\r\n/// <reference path=\"typeahead.bundle.js\" />\r\n/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n/// <reference path=\"knockout.mapping-latest.debug.js\" />\r\n/// <reference path=\"../App/services/datacontext.js\" />\r\n/// <reference path=\"../SphApp/objectbuilders.js\" />\r\n/// <reference path=\"../SphApp/schemas/trigger.workflow.g.js\" />\r\n/// <reference path=\"../SphApp/partial/WorkflowDefinition.js\" />\r\n/// <reference path=\"../App/durandal/amd/text.js\" />\r\n/// <reference path=\"jquery-2.2.0.intellisense.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"require.js\" />\r\n/// <reference path=\"complete.ly.1.0.1.js\" />\r\n\r\n\r\nko.bindingHandlers.workflowFormPathIntellisense = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            schema = ko.unwrap(value.schema),\r\n            allBindings = allBindingsAccessor(),\r\n            setup = function () {\r\n                var input = $(element),\r\n                         div = $(\"<div></div>\").css({\r\n                             'height': \"28px\"\r\n                         });\r\n                input.hide().before(div);\r\n\r\n                var c = completely(div[0], {\r\n                    fontSize: \"12px\",\r\n                    color: \"#555;\",\r\n                    fontFamily: \"\\\"Open Sans\\\", Arial, Helvetica, sans-serif\"\r\n                });\r\n\r\n                c.setText(ko.unwrap(allBindings.value));\r\n                for (var ix in schema) {\r\n                    if (schema.hasOwnProperty(ix)) {\r\n                        if (ix === \"$type\") continue;\r\n                        if (ix === \"addChildItem\") continue;\r\n                        if (ix === \"removeChildItem\") continue;\r\n                        if (ix === \"Empty\") continue;\r\n                        if (ix === \"WebId\") continue;\r\n                        c.options.push(\"\" + ix);\r\n                    }\r\n                }\r\n                c.options.sort();\r\n\r\n                var currentObject = schema;\r\n                c.onChange = function (text) {\r\n                    if (text.lastIndexOf(\".\") === text.length - 1) {\r\n                        c.options = [];\r\n                        var props = text.split(\".\");\r\n\r\n                        currentObject = schema;\r\n                        _(props).each(function (v) {\r\n                            if (v === \"\") { return; }\r\n                            currentObject = currentObject[v];\r\n                        });\r\n                        console.log(\"currentObject\", currentObject);\r\n                        for (var i in currentObject) {\r\n                            if (currentObject.hasOwnProperty(i)) {\r\n                                if (i === \"$type\") continue;\r\n                                if (i === \"addChildItem\") continue;\r\n                                if (i === \"removeChildItem\") continue;\r\n                                if (i === \"Empty\") continue;\r\n                                if (i === \"WebId\") continue;\r\n                                c.options.push(\"\" + i);\r\n                            }\r\n                        }\r\n                        c.options.sort();\r\n                        c.startFrom = text.lastIndexOf(\".\") + 1;\r\n                    }\r\n                    c.repaint();\r\n                };\r\n\r\n                c.repaint();\r\n                $(c.input)\r\n                    .attr(\"autocomplete\", \"off\")\r\n                    .blur(function () {\r\n                        allBindings.value($(this).val());\r\n                    }).parent().find(\"input\")\r\n                    .css({ \"padding\": \"6px 12px\", \"height\": \"28px\" });\r\n\r\n                if ($(element).prop(\"required\")) {\r\n                    $(c.input).prop(\"required\", true);\r\n                }\r\n\r\n\r\n            };\r\n\r\n\r\n        setup();\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.activityClass = {\r\n    init: function (element, valueAccessor) {\r\n\r\n        var div = $(element),\r\n            act = ko.unwrap(valueAccessor()),\r\n        fullName = typeof act.$type === \"function\" ? act.$type() : act.$type,\r\n        name = /Bespoke\\.Sph\\.Domain\\.(.*?),/.exec(fullName)[1];\r\n\r\n        div.addClass(\"activity32\").addClass(\"activity32-\" + name);\r\n    }\r\n};\r\n\r\nko.bindingHandlers.checkedItems = {\r\n    init: function (element, valueAccessor) {\r\n        var item = ko.dataFor(element),\r\n            list = valueAccessor();\r\n\r\n        $(element).change(function () {\r\n            var checked = $(this).is(':checked');\r\n            if (checked) {\r\n                list.push(item);\r\n            } else {\r\n                list.remove(item);\r\n            }\r\n        });\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.typeahead = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var id = ko.unwrap(valueAccessor()),\r\n            allBindings = allBindingsAccessor();\r\n\r\n        if (typeof id === \"undefined\") {\r\n            return;\r\n        }\r\n        var members = new Bloodhound({\r\n            datumTokenizer: function (d) { return Bloodhound.tokenizers.whitespace(d.Path); },\r\n            queryTokenizer: Bloodhound.tokenizers.nonword,\r\n            prefetch: \"/api/workflow-definitions/\" + id + \"/variable-path\"\r\n\r\n        });\r\n        members.initialize();\r\n        $(element).typeahead({ highlight: true }, {\r\n            name: \"schema_paths\" + id,\r\n            displayKey: \"Path\",\r\n            source: members.ttAdapter()\r\n        })\r\n            .on(\"typeahead:closed\", function () {\r\n                allBindings.value($(this).val());\r\n            });\r\n    }\r\n};\r\nko.bindingHandlers.typeaheadExceptions = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n\r\n\r\n        var allBindings = allBindingsAccessor();\r\n\r\n        var exceptions = new Bloodhound({\r\n            datumTokenizer: Bloodhound.tokenizers.whitespace,\r\n            queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n            prefetch: \"/api/assemblies/types/exceptions\"\r\n        });\r\n        \r\n        $(element).typeahead(null, {\r\n            name: \"exceptions\",\r\n            source: exceptions\r\n        }).on(\"typeahead:closed\", function () {\r\n            allBindings.value($(this).val());\r\n        });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.activityPopover = {\r\n    init: function (element, valueAccessor) {\r\n\r\n        var div = $(element),\r\n            act = ko.unwrap(valueAccessor()),\r\n            fullName = typeof act.$type === \"function\" ? act.$type() : act.$type,\r\n            name = /Bespoke\\.Sph\\.Domain\\.(.*?),/.exec(fullName)[1],\r\n            wd = ko.dataFor(div.parent()[0]).wd(),\r\n            pop = div.popover({\r\n                title: name + ' : ' + act.Name(),\r\n                html: true,\r\n                content: function () {\r\n                    $(\"a.edit-activity\").popover(\"hide\");\r\n                    div.find(\"a.edit-activity\").addClass(act.WebId());\r\n                    div.find(\"a.delete-activity\").addClass(act.WebId());\r\n                    div.find(\"a.start-activity\").addClass(act.WebId());\r\n                    return div.find(\"div.context-menu\").html();\r\n                }\r\n            });\r\n\r\n        // just display it for 5 seconds\r\n        pop.on(\"shown.bs.popover\", function () {\r\n            setTimeout(function () { pop.popover('hide'); }, 5000);\r\n        });\r\n\r\n        $(document).on(\"click\", \"a.\" + act.WebId(), function (e) {\r\n            e.preventDefault();\r\n            var app = require(objectbuilders.app),\r\n                link = $(this);\r\n            if (link.hasClass(\"delete-activity\")) {\r\n                app.showMessage(\"Are you sure you want to remove this Activity\", \"Remove activity\", [\"Yes\", \"No\"])\r\n                    .done(function (result) {\r\n                        if (result === \"Yes\") {\r\n                            wd.removeActivity(act)();\r\n                        }\r\n                    });\r\n            }\r\n            if (link.hasClass(\"edit-activity\")) {\r\n                wd.editActivity(act)();\r\n            }\r\n            if (link.hasClass(\"start-activity\")) {\r\n                wd.setStartActivity(act)();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.comboBoxLookupOptions = {\r\n    init: function (element, valueAccessor) {\r\n        var $select = $(element),\r\n            lookup = ko.unwrap(valueAccessor()),\r\n            value = lookup.value,\r\n            caption = lookup.caption,\r\n            context = require(\"services/datacontext\"),\r\n            displayPath = ko.unwrap(lookup.displayPath),\r\n            valuePath = ko.unwrap(lookup.valuePath);\r\n\r\n        var setup = function (query) {\r\n\r\n            //getListAsync\r\n            var promise = ko.unwrap(lookup.valuePath) === ko.unwrap(lookup.displayPath) ?\r\n                context.getListAsync(ko.unwrap(lookup.entity), query, ko.unwrap(lookup.valuePath)) :\r\n                context.getTuplesAsync({\r\n                    entity: ko.unwrap(lookup.entity),\r\n                    query: query,\r\n                    field: valuePath,\r\n                    field2: displayPath\r\n                });\r\n\r\n\r\n            promise.done(function (list) {\r\n                element.options.length = 0;\r\n                if (caption) {\r\n                    element.add(new Option(caption, \"\"));\r\n                }\r\n                _(list).each(function (v) {\r\n                    if (typeof v === \"string\") {\r\n                        element.add(new Option(v, v));\r\n                        return;\r\n                    }\r\n                    if (typeof v.Item1 === \"string\" && typeof v.Item2 === \"string\") {\r\n                        element.add(new Option(v.Item2, v.Item1));\r\n                        return;\r\n                    }\r\n                    if (typeof v[valuePath] === \"string\" && typeof v[displayPath] === \"string\") {\r\n                        element.add(new Option(v[valuePath], v[displayPath]));\r\n                        return;\r\n                    }\r\n                });\r\n\r\n                $select.val(ko.unwrap(value))\r\n                    .on(\"change\", function () {\r\n                        value($select.val());\r\n                    });\r\n\r\n            });\r\n        };\r\n        setup(ko.unwrap(lookup.query));\r\n\r\n        if (typeof lookup.query === \"function\") {\r\n            if (typeof lookup.query.subscribe === \"function\") {\r\n                lookup.query.subscribe(function (v) {\r\n                    setup(ko.unwrap(v));\r\n                });\r\n            }\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var lookup = ko.unwrap(valueAccessor()),\r\n            value = lookup.value;\r\n        $(element).val(ko.unwrap(value));\r\n    }\r\n};\r\n\r\n","/// <reference path=\"~/Scripts/underscore.js\" />\r\n/// <reference path=\"~/Scripts/jstree.min.js\" />\r\n/// <reference path=\"require.js\" />\r\n/// <reference path=\"jquery-2.2.0.intellisense.js\" />\r\n/// <reference path=\"complete.ly.1.0.1.js\" />\r\n/// <reference path=\"../SphApp/objectbuilders.js\" />\r\n/// <reference path=\"../SphApp/schemas/form.designer.g.js\" />\r\n/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n\r\nko.bindingHandlers.tree = {\r\n    init: function (element, valueAccessor) {\r\n        // let member = null;\r\n        let memberNameSubscription = null,\r\n            memberAllowMultipleSubscription = null,\r\n            memberIsNullableSubscription = null,\r\n            memberTypeNameSubscription = null;\r\n        const system = require(objectbuilders.system),\r\n            value = valueAccessor(),\r\n            entity = ko.unwrap(value.entity),\r\n            searchbox = ko.unwrap(value.searchbox),\r\n            member = value.selected,\r\n            jsTreeData = {\r\n                text: entity.Name(),\r\n                state: {\r\n                    opened: true,\r\n                    selected: true\r\n                }\r\n            },\r\n            getNodeMemberType = function (v) {\r\n                var type = ko.unwrap(v.TypeName) || ko.unwrap(v.$type);\r\n                if (type.indexOf(\",\") < 0) {\r\n                    type = ko.unwrap(v.$type);\r\n                }\r\n                return type;\r\n            },\r\n            recurseChildMember = function (node) {\r\n                node.children = _(node.data.MemberCollection()).map(function (v) {\r\n\r\n                    const type = getNodeMemberType(v);\r\n                    return {\r\n                        text: v.Name(),\r\n                        state: \"open\",\r\n                        type: type,\r\n                        data: v\r\n                    };\r\n                });\r\n                _(node.children).each(recurseChildMember);\r\n            },\r\n            setNodePropertyForChildOfValueObject = function (node, tag) {\r\n                if (!ko.isObservable(tag.childOfValueMember)) {\r\n                    tag.childOfValueMember = ko.observable(true);\r\n                }\r\n                var ref = $(element).jstree(true),\r\n                    parents = _(node.parents).map(function (n) { return ref.get_node(n); }),\r\n                    valueMember = _(parents).find(function (n) { return n.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\"; });\r\n                tag.childOfValueMember(valueMember || false);\r\n            },\r\n            setAllowMultipleAndNullableIcons = function (id) {\r\n                const schemaTree1 = $(element).jstree(true);\r\n                const node = schemaTree1.get_node(id),\r\n                    mbr = node.data;\r\n                if (!mbr) return;\r\n                $(`#${id} a.jstree-anchor>i.fa-question`).remove();\r\n                $(`#${id} a.jstree-anchor>i.fa-certificate`).remove();\r\n\r\n                if (ko.isObservable(mbr.IsNullable) && ko.unwrap(mbr.IsNullable)) {\r\n                    $(`#${id} a.jstree-anchor>i.jstree-icon`)\r\n                        .after('<i class=\"fa fa-question\" style=\"margin-right:5px;color:orange\"></i>');\r\n                }\r\n                if (ko.unwrap(mbr.AllowMultiple)) {\r\n                    $(`#${id} a.jstree-anchor>i.jstree-icon`)\r\n                        .after('<i class=\"fa fa-certificate\" style=\"margin-right:5px;color:green\"></i>');\r\n                }\r\n            },\r\n            loadJsTree = function () {\r\n                jsTreeData.children = _(entity.MemberCollection()).map(function (v) {\r\n\r\n                    return {\r\n                        text: ko.unwrap(v.Name),\r\n                        state: \"open\",\r\n                        type: getNodeMemberType(v),\r\n                        data: v\r\n                    };\r\n                });\r\n                _(jsTreeData.children).each(recurseChildMember);\r\n                $(element)\r\n                    .on(\"select_node.jstree\", function (node, selected) {\r\n                        if (typeof member !== \"function\") {\r\n                            return;\r\n                        }\r\n                        if (memberIsNullableSubscription) {\r\n                            memberIsNullableSubscription.dispose();\r\n                            memberIsNullableSubscription = null;\r\n                        }\r\n                        if (memberAllowMultipleSubscription) {\r\n                            memberAllowMultipleSubscription.dispose();\r\n                            memberAllowMultipleSubscription = null;\r\n                        }\r\n\r\n                        if (memberNameSubscription) {\r\n                            memberNameSubscription.dispose();\r\n                            memberNameSubscription = null;\r\n                        }\r\n\r\n                        if (memberTypeNameSubscription) {\r\n                            memberTypeNameSubscription.dispose();\r\n                            memberTypeNameSubscription = null;\r\n                        }\r\n\r\n                        const tag = selected.node.data;\r\n                        if (tag) {\r\n                            if (selected.node.type === \"default\") {\r\n                                return;\r\n                            }\r\n\r\n                            if (!ko.isObservable(tag.childOfValueMember)) {\r\n                                tag.childOfValueMember = ko.observable(true);\r\n                            }\r\n                            if (!ko.isObservable(tag.allowFilter)) {\r\n                                tag.allowFilter = ko.observable(true);\r\n                            }\r\n\r\n                            var ref = $(element).jstree(true),\r\n                                parents = _(selected.node.parents).map(function (n) { return ref.get_node(n); }),\r\n                                valueMember = _(parents).find(function (n) { return n.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\"; });\r\n                            tag.childOfValueMember(valueMember || false);\r\n                            // we also need to disable for collection member\r\n                            if (!valueMember) {\r\n\r\n                                const cm = _(parents).find(function (n) {\r\n                                    const mb1 = n.data;\r\n                                    return n.type === \"Bespoke.Sph.Domain.ComplexMember, domain.sph\" && ko.unwrap(mb1.AllowMultiple);\r\n                                });\r\n                                if (cm) {\r\n                                    tag.allowFilter(false);\r\n                                }\r\n                            }\r\n\r\n\r\n                            if (!tag.childOfValueMember()) {\r\n                                ref.edit(selected.node);\r\n                            }\r\n                            member(tag);\r\n\r\n                            // subscribe to Name change\r\n                            memberNameSubscription = member().Name.subscribe(function (name) {\r\n                                $(element).jstree(true)\r\n                                    .rename_node(selected.node, name);\r\n                                console.log(`rename ${name}`);\r\n                            });\r\n                            memberAllowMultipleSubscription = member().AllowMultiple.subscribe( _=> setAllowMultipleAndNullableIcons(selected.node.id));\r\n                            if (ko.isObservable(member().IsNullable)) {\r\n                                memberAllowMultipleSubscription = member().IsNullable.subscribe(_ =>setAllowMultipleAndNullableIcons(selected.node.id));\r\n                            }\r\n                            // type\r\n                            if (typeof member().TypeName === \"function\") {\r\n                                memberTypeNameSubscription = member().TypeName.subscribe(function (name) {\r\n                                    $(element).jstree(true)\r\n                                        .set_type(selected.node, name);\r\n                                });\r\n\r\n                            }\r\n                        }\r\n                    })\r\n                    .on(\"move_node.jstree\", function (e, data) {\r\n                        var ref = $(element).jstree(true),\r\n                            mbr = data.node.data,\r\n                            oldParent = ref.get_node(data.old_parent),\r\n                            oldCollections = oldParent.data.MemberCollection || entity.MemberCollection,\r\n                            parent = ref.get_node(data.parent),\r\n                            collection = parent.data.MemberCollection || entity.MemberCollection;\r\n                        oldCollections.remove(function (v) {\r\n                            return ko.unwrap(mbr.WebId) === ko.unwrap(v.WebId);\r\n                        });\r\n                        collection.splice(data.position, 0, mbr);\r\n\r\n                        parent.children.forEach(setAllowMultipleAndNullableIcons);\r\n                        oldParent.children.forEach(setAllowMultipleAndNullableIcons);\r\n                    })\r\n                    .on(\"rename_node.jstree\", function (ev, node) {\r\n                        const mb = node.node.data;\r\n                        mb.Name(node.text);\r\n                    })\r\n                    .on(\"open_node.jstree\", function (ev, item) {\r\n                        setAllowMultipleAndNullableIcons(item.node.id);\r\n                        item.node.children.forEach(setAllowMultipleAndNullableIcons);\r\n                    })\r\n                    .jstree({\r\n                        \"core\": {\r\n                            \"animation\": 0,\r\n                            \"check_callback\": function (operation, node, nodeParent, nodePosition, more) {\r\n                                if (operation === \"move_node\") {\r\n                                    const mbr = node.data,\r\n                                        ref = $(element).jstree(true),\r\n                                        target = ref.get_node(nodeParent);\r\n                                    if (!mbr) {\r\n                                        return false;\r\n                                    }\r\n                                    if (!target) {\r\n                                        return false;\r\n                                    }\r\n                                    if (!ko.isObservable(mbr.childOfValueMember)) {\r\n                                        setNodePropertyForChildOfValueObject(node, mbr);\r\n                                    }\r\n                                    if (ko.unwrap(mbr.childOfValueMember)) {\r\n                                        return false;\r\n                                    }\r\n                                    if (target.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\") {\r\n                                        return false;\r\n                                    }\r\n\r\n                                    return true;\r\n                                }\r\n                                return true;\r\n                            },\r\n                            \"themes\": { \"stripes\": true },\r\n                            'data': jsTreeData\r\n                        },\r\n                        \"dnd\": {\r\n                            \"is_draggable\": function (node) {\r\n                                var mbr = node.data;\r\n                                if (mbr && ko.unwrap(mbr.childOfValueMember)) {\r\n                                    return false;\r\n                                }\r\n                                return true;\r\n                            }\r\n                        },\r\n                        \"contextmenu\": {\r\n                            \"items\": function ($node) {\r\n\r\n                                var ref = $(element).jstree(true),\r\n                                    parents = _($node.parents).map(function (n) { return ref.get_node(n); }),\r\n                                    valueMember = _(parents).find(function (n) { return n.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\"; }),\r\n                                    sel = ref.get_selected();\r\n                                if (valueMember) {\r\n                                    return [];\r\n                                }\r\n\r\n                                var simpleMenu = {\r\n                                    label: \"Add Simple Child\",\r\n                                    action: function () {\r\n                                        const child = new bespoke.sph.domain.SimpleMember({ WebId: system.guid(), TypeName: \"System.String, mscorlib\", Name: \"Member_Name\" }),\r\n                                            parent = $(element).jstree(\"get_selected\", true),\r\n                                            mb = parent[0].data,\r\n                                            newNode = { state: \"open\", type: \"System.String, mscorlib\", text: \"Member_Name\", data: child };\r\n\r\n                                        if (!sel.length) {\r\n                                            return false;\r\n                                        }\r\n                                        sel = sel[0];\r\n                                        sel = ref.create_node(sel, newNode);\r\n                                        if (sel) {\r\n                                            ref.edit(sel);\r\n                                            if (mb && mb.MemberCollection) {\r\n                                                mb.MemberCollection.push(child);\r\n                                            } else {\r\n                                                entity.MemberCollection.push(child);\r\n                                            }\r\n                                            return true;\r\n                                        }\r\n                                        return false;\r\n\r\n\r\n                                    }\r\n                                },\r\n                                    valueObjectMenu = {\r\n                                        label: \"Add Value Object Child\",\r\n                                        action: function () {\r\n                                            var typeName = \"Bespoke.Sph.Domain.ValueObjectDefinition, domain.sph\",\r\n                                                child = new bespoke.sph.domain.ValueObjectMember({ WebId: system.guid(), TypeName: typeName, Name: \"Member_Name\" }),\r\n                                                parent = $(element).jstree(\"get_selected\", true),\r\n                                                mb = parent[0].data,\r\n                                                newNode = { state: \"open\", type: \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\", text: \"Member_Name\", data: child };\r\n\r\n                                            if (!sel.length) {\r\n                                                return false;\r\n                                            }\r\n                                            sel = sel[0];\r\n                                            sel = ref.create_node(sel, newNode);\r\n                                            if (sel) {\r\n                                                ref.edit(sel);\r\n                                                if (mb && mb.MemberCollection) {\r\n                                                    mb.MemberCollection.push(child);\r\n                                                } else {\r\n                                                    entity.MemberCollection.push(child);\r\n                                                }\r\n                                                child.TypeName.subscribe(function () {\r\n                                                    // TODO : clear the node children and populate the node according to the value object definition members\r\n\r\n                                                });\r\n                                                return true;\r\n                                            }\r\n                                            return false;\r\n\r\n\r\n                                        }\r\n                                    },\r\n                                    complexChildMenu = {\r\n                                        label: \"Add Complex Child\",\r\n                                        action: function () {\r\n                                            var child = new bespoke.sph.domain.ComplexMember({ WebId: system.guid(), Name: \"Member_Name\" }),\r\n                                                parent = $(element).jstree(\"get_selected\", true),\r\n                                                mb = parent[0].data,\r\n                                                newNode = { state: \"open\", type: \"Bespoke.Sph.Domain.ComplexMember, domain.sph\", text: \"Member_Name\", data: child };\r\n\r\n                                            if (!sel.length) {\r\n                                                return false;\r\n                                            }\r\n                                            sel = sel[0];\r\n                                            sel = ref.create_node(sel, newNode);\r\n                                            if (sel) {\r\n                                                ref.edit(sel);\r\n                                                if (mb && mb.MemberCollection) {\r\n                                                    mb.MemberCollection.push(child);\r\n                                                } else {\r\n                                                    entity.MemberCollection.push(child);\r\n                                                }\r\n                                                return true;\r\n                                            }\r\n                                            return false;\r\n\r\n\r\n                                        }\r\n                                    },\r\n                                    removeMenu = {\r\n                                        label: \"Remove\",\r\n                                        action: function () {\r\n                                            // now delete the member\r\n                                            var n = ref.get_selected(true)[0],\r\n                                                p = ref.get_node($(\"#\" + n.parent)),\r\n                                                parentMember = p.data;\r\n                                            if (parentMember && typeof parentMember.MemberCollection === \"function\") {\r\n                                                var child = _(parentMember.MemberCollection()).find(function (v) {\r\n                                                    return v.WebId() === n.data.WebId();\r\n                                                });\r\n                                                parentMember.MemberCollection.remove(child);\r\n                                            } else {\r\n                                                var child2 = _(entity.MemberCollection()).find(function (v) {\r\n                                                    return v.WebId() === n.data.WebId();\r\n                                                });\r\n                                                entity.MemberCollection.remove(child2);\r\n                                            }\r\n\r\n                                            if (!sel.length) {\r\n                                                return false;\r\n                                            }\r\n                                            ref.delete_node(sel);\r\n\r\n                                            return true;\r\n\r\n                                        }\r\n                                    };\r\n\r\n                                var items = [];\r\n\r\n                                if ($node.type === \"default\" || $node.type === \"Bespoke.Sph.Domain.ComplexMember, domain.sph\") {\r\n                                    items.push(simpleMenu);\r\n                                    items.push(valueObjectMenu);\r\n                                    items.push(complexChildMenu);\r\n                                }\r\n\r\n                                console.log($node);\r\n                                if ($node.type !== \"default\") {\r\n                                    items.push(removeMenu);\r\n                                }\r\n                                return items;\r\n                            }\r\n                        },\r\n                        \"types\": {\r\n\r\n                            \"default\": {\r\n                                \"icon\": \"fa fa-clipboard\"\r\n                            },\r\n                            \"System.String, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-bold\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.DateTime, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-calendar\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Int32, mscorlib\": {\r\n                                \"icon\": \"fa fa-sort-numeric-asc\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Decimal, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-usd\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Boolean, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-ok\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\": {\r\n                                \"icon\": \"fa fa-object-ungroup\"\r\n                            },\r\n                            \"Bespoke.Sph.Domain.ComplexMember, domain.sph\": {\r\n                                \"icon\": \"fa fa-object-group\"\r\n                            }\r\n                        },\r\n                        \"plugins\": [\"contextmenu\", \"dnd\", \"types\", \"search\"]\r\n                    });\r\n            };\r\n        loadJsTree();\r\n\r\n        const schemaTree = $(element).jstree(true);\r\n        $.each($(element).find(\"li\"), function (index, li) {\r\n            setAllowMultipleAndNullableIcons(li.id);\r\n        });\r\n\r\n        var to = false;\r\n        $(searchbox).keyup(function () {\r\n            if (to) {\r\n                clearTimeout(to);\r\n            }\r\n            to = setTimeout(function () {\r\n                const v = $(searchbox).val();\r\n                schemaTree.search(v);\r\n            }, 250);\r\n        });\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.help = {\r\n    init: function (element, valueAccessor) {\r\n        var link = $(element),\r\n            href = ko.unwrap(valueAccessor());\r\n        link.click(function (e) {\r\n            e.preventDefault();\r\n            window.open(\"/docs/#\" + href);\r\n        });\r\n    }\r\n};\r\nvar substringMatcher = function (strs) {\r\n    return function findMatches(q, cb) {\r\n        var matches, substringRegex;\r\n\r\n        // an array that will be populated with substring matches\r\n        matches = [];\r\n        // regex used to determine if a string contains the substring `q`\r\n        substringRegex = new RegExp(q, \"i\");\r\n\r\n        // iterate through the pool of strings and for any string that\r\n        // contains the substring `q`, add it to the `matches` array\r\n        $.each(strs, function (i, str) {\r\n            if (substringRegex.test(str)) {\r\n                // the typeahead jQuery plugin expects suggestions to a\r\n                // JavaScript object, refer to typeahead docs for more info\r\n                matches.push({ value: str });\r\n            }\r\n        });\r\n\r\n        cb(matches);\r\n    };\r\n};\r\n\r\n\r\nko.bindingHandlers.typeaheadUrl = {\r\n    init: function (element, valueAccessor) {\r\n        var types = ko.unwrap(valueAccessor()),\r\n            ttl = 300000,\r\n            url = String.format(\"/list?table={0}&column={1}\", types[0], \"Route\"),\r\n            suggestions = new Bloodhound({\r\n                datumTokenizer: Bloodhound.tokenizers.obj.whitespace(\"name\"),\r\n                queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n                limit: 10,\r\n                remote: {\r\n                    url: url,\r\n                    tt1: ttl,\r\n                    filter: function (list) {\r\n                        return _(list).map(function (v) {\r\n                            return { name: v };\r\n                        });\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n        suggestions.initialize();\r\n        $(element).typeahead(null,\r\n            {\r\n                name: \"EntityView_\" + $(element).prop(\"id\"),\r\n                displayKey: \"name\",\r\n                source: suggestions.ttAdapter()\r\n            });\r\n    }\r\n};\r\nko.bindingHandlers.entityTypeaheadPath = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        const value = valueAccessor(),\r\n            context = require(objectbuilders.datacontext),\r\n            config = require(objectbuilders.config),\r\n            allBindings = allBindingsAccessor(),\r\n            idOrName = ko.unwrap(valueAccessor()) || window.typeaheadEntity,\r\n            setup = function (options) {\r\n                const toCamelCase = function (text) {\r\n                    return text.replace(/^([A-Z])|\\s(\\w)/g, function (match, p1, p2, offset) {\r\n                        if (p2) return p2.toUpperCase();\r\n                        return p1.toLowerCase();\r\n                    });\r\n                };\r\n\r\n                const name = options.name || options,\r\n                    eid = options.id || options,\r\n                    camel = toCamelCase(name);\r\n\r\n                var ed = ko.toJS(bespoke[config.applicationName + \"_\" + camel].domain[name]());\r\n                const input = $(element),\r\n                    div = $(\"<div></div>\").css({\r\n                        'height': \"28px\"\r\n                    });\r\n                input.hide().before(div);\r\n\r\n                var c = completely(div[0], {\r\n                    fontSize: \"12px\",\r\n                    color: \"#555;\",\r\n                    fontFamily: \"\\\"Open Sans\\\", Arial, Helvetica, sans-serif\"\r\n                });\r\n\r\n                c.setText(ko.unwrap(allBindings.value));\r\n                for (let ix in ed) {\r\n                    if (ed.hasOwnProperty(ix)) {\r\n                        if (ix === \"$type\") continue;\r\n                        if (ix === \"addChildItem\") continue;\r\n                        if (ix === \"removeChildItem\") continue;\r\n                        if (ix === \"Empty\") continue;\r\n                        if (ix === \"WebId\") continue;\r\n                        c.options.push(`${ix}`);\r\n                    }\r\n                }\r\n                c.options.sort();\r\n\r\n                var currentObject = ed;\r\n                c.onChange = function (text) {\r\n                    if (text.lastIndexOf(\".\") === text.length - 1) {\r\n                        c.options = [];\r\n                        const props = text.split(\".\");\r\n\r\n                        currentObject = ed;\r\n                        _(props).each(function (v) {\r\n                            if (v === \"\") { return; }\r\n                            currentObject = currentObject[v];\r\n                        });\r\n                        console.log(\"currentObject\", currentObject);\r\n                        for (var i in currentObject) {\r\n                            if (currentObject.hasOwnProperty(i)) {\r\n                                if (i === \"$type\") continue;\r\n                                if (i === \"addChildItem\") continue;\r\n                                if (i === \"removeChildItem\") continue;\r\n                                if (i === \"Empty\") continue;\r\n                                if (i === \"WebId\") continue;\r\n                                c.options.push(\"\" + i);\r\n                            }\r\n                        }\r\n                        c.options.sort();\r\n                        c.startFrom = text.lastIndexOf(\".\") + 1;\r\n                    }\r\n                    c.repaint();\r\n                };\r\n\r\n                c.repaint();\r\n                $(c.input)\r\n                    .attr(\"autocomplete\", \"off\")\r\n                    .blur(function () {\r\n                        allBindings.value($(this).val());\r\n                    }).parent().find(\"input\")\r\n                    .css({ \"padding\": \"6px 12px\", \"height\": \"28px\" });\r\n\r\n                if ($(element).prop(\"required\")) {\r\n                    $(c.input).prop(\"required\", true);\r\n                }\r\n\r\n                c.hideDropDown();\r\n\r\n            };\r\n\r\n\r\n        if (idOrName) {\r\n            context.loadOneAsync(\"EntityDefinition\", `Name eq '${idOrName}' OR id eq '${idOrName}'`, \"Id\")\r\n                .done(function (edf) {\r\n                    setup({ name: edf.Name(), id: edf.Id() });\r\n                });\r\n\r\n        }\r\n\r\n\r\n        if (typeof value === \"function\" && typeof value.subscribe === \"function\") {\r\n            value.subscribe(function (entity) {\r\n                $(element).typeahead(\"destroy\");\r\n                setup(entity);\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.cssTypeahead = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var allBindings = allBindingsAccessor(),\r\n            results = [\"fa\", \"fa-user\", \"fa-user-o\"],\r\n            extractor = function (query) {\r\n                var result = /([^,]+)$/.exec(query);\r\n                if (result && result[1])\r\n                    return result[1].trim();\r\n                return \"\";\r\n            },\r\n            paths = _(results).map(function (v) {\r\n                return { path: v };\r\n            }),\r\n            members = new Bloodhound({\r\n                datumTokenizer: function (d) {\r\n                    return d.path.split(/s+/);\r\n                },\r\n                queryTokenizer: function (s) {\r\n                    return s.split(/\\./);\r\n                },\r\n                local: paths\r\n            });\r\n        members.initialize();\r\n\r\n        $(element).typeahead({\r\n            minLength: 0,\r\n            highlight: true,\r\n            updater: function () {\r\n                return this.$element.val().replace(/[^,]*$/, \"\") + item + \",\";\r\n            },\r\n            matcher: function (item) {\r\n                var tquery = extractor(this.query);\r\n                if (!tquery) return false;\r\n                return ~item.toLowerCase().indexOf(tquery.toLowerCase());\r\n            }\r\n        },\r\n            {\r\n                name: \"css-class\",\r\n                displayKey: \"path\",\r\n                source: members.ttAdapter()\r\n            })\r\n            .on(\"typeahead:closed\", function () {\r\n                allBindings.value($(this).val());\r\n            });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.chart = {\r\n    init: function (element, valueAccessor) {\r\n        var chart = ko.unwrap(valueAccessor()),\r\n            context = require(\"services/datacontext\"),\r\n            entity = chart.Entity(),\r\n            query = JSON.parse(chart.Query()),\r\n            type = chart.Type(),\r\n            tcs = new $.Deferred(),\r\n            name = chart.Name();\r\n\r\n\r\n        context.searchAsync(entity, query)\r\n            .done(function (result) {\r\n\r\n                var buckets = result.aggregations.category.buckets || result.aggregations.category,\r\n                    data = _(buckets).map(function (v) {\r\n                        return {\r\n                            category: v.key_as_string || v.key.toString(),\r\n                            value: v.doc_count\r\n                        };\r\n                    }),\r\n                    categories = _(buckets).map(function (v) {\r\n                        return v.key_as_string || v.key.toString();\r\n                    }),\r\n                    kendoChart = $(element).kendoChart({\r\n                        theme: \"metro\",\r\n                        chartArea: {\r\n                            background: \"\"\r\n                        },\r\n                        title: {\r\n                            text: name\r\n                        },\r\n                        legend: {\r\n                            position: \"bottom\"\r\n                        },\r\n                        seriesDefaults: {\r\n                            labels: {\r\n                                visible: true,\r\n                                format: \"{0}\",\r\n                                background: \"transparent\",\r\n                                template: \"#= category #: #= value#\"\r\n                            }\r\n                        },\r\n                        series: [\r\n                            {\r\n                                type: type,\r\n                                data: data\r\n                            }\r\n                        ],\r\n                        categoryAxis: {\r\n                            categories: categories,\r\n                            majorGridLines: {\r\n                                visible: false\r\n                            }\r\n                        },\r\n                        tooltip: {\r\n                            visible: true,\r\n                            format: \"{0}\",\r\n                            template: \"#= category #: #= value #\"\r\n                        }\r\n                    }).data(\"kendoChart\");\r\n                tcs.resolve(true);\r\n\r\n                context.getScalarAsync(\"EntityView\", \"Id eq '\" + chart.EntityViewId() + \"'\", \"Name\")\r\n                    .done(function (viewName) {\r\n                        kendoChart.options.title.text = name + \" (\" + viewName + \")\";\r\n                        kendoChart.refresh();\r\n                    });\r\n\r\n            });\r\n\r\n\r\n        return tcs.promise();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.iconPicker = {\r\n    init: function (element, valueAccessor) {\r\n        var $input = $(element),\r\n            value = valueAccessor(),\r\n            $picker = $(\"<a href=\\\"#\\\" class=\\\"btn btn-link\\\">Pick Icon</a>\");\r\n\r\n        $input.parent().append($picker);\r\n        $picker.click(function (e) {\r\n            e.preventDefault();\r\n            require([\"viewmodels/icon.picker\", \"durandal/app\"], function (dialog, app2) {\r\n                app2.showDialog(dialog)\r\n                    .done(function (result) {\r\n                        if (result === \"OK\") {\r\n                            value(dialog.icon());\r\n                            $input.val(dialog.icon());\r\n                        }\r\n                    });\r\n\r\n            });\r\n        });\r\n\r\n    }\r\n};\r\n\r\nvar bespoke = bespoke || {};\r\nbespoke.observableArray = bespoke.observableArray || {};\r\n\r\nbespoke.getSingletonObservableArray = function (key) {\r\n    if (bespoke.observableArray[key]) {\r\n        return bespoke.observableArray[key];\r\n    }\r\n\r\n    bespoke.observableArray[key] = ko.observableArray();\r\n    return bespoke.observableArray[key];\r\n};\r\n\r\n\r\nko.bindingHandlers.lookup = {\r\n    init: function (element, valueAccessor) {\r\n        var $link = $(element),\r\n            options = valueAccessor(),\r\n            member = ko.unwrap(options.member);\r\n\r\n        $link.click(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            require([\"viewmodels/entity.lookup.dialog\", \"durandal/app\"], function (dialog, app2) {\r\n                dialog.options(options);\r\n                app2.showDialog(dialog)\r\n                    .done(function (result) {\r\n                        if (!result) return;\r\n                        if (result === \"OK\") {\r\n                            var item = dialog.selected();\r\n                            options.value(item[member]);\r\n                        }\r\n                    });\r\n\r\n            });\r\n\r\n        });\r\n    }\r\n};\r\nko.virtualElements.allowedBindings.lookupText = true;\r\nbespoke.lookupText = function (element, valueAccessor) {\r\n    var options = valueAccessor(),\r\n        entity = ko.unwrap(options.entity),\r\n        displayPath = ko.unwrap(options.displayPath),\r\n        valuePath = ko.unwrap(options.valuePath),\r\n        val = ko.unwrap(options.value),\r\n        context = require(\"services/datacontext\"),\r\n        setTextContent = function (ele, textContent) {\r\n            var value = ko.utils.unwrapObservable(textContent);\r\n            if ((value === null) || (value === undefined))\r\n                value = \"\";\r\n            var innerTextNode = ko.virtualElements.firstChild(ele);\r\n            if (!innerTextNode || innerTextNode.nodeType !== 3 || ko.virtualElements.nextSibling(innerTextNode)) {\r\n                ko.virtualElements.setDomNodeChildren(ele, [ele.ownerDocument.createTextNode(value)]);\r\n            } else {\r\n                innerTextNode.data = value;\r\n            }\r\n\r\n        };\r\n\r\n    context.getScalarAsync(entity, valuePath + \" eq '\" + val + \"'\", displayPath)\r\n        .done(function (text) {\r\n            setTextContent(element, text);\r\n            console.log(text);\r\n        });\r\n};\r\nko.bindingHandlers.lookupText = {\r\n    init: bespoke.lookupText,\r\n    update: bespoke.lookupText\r\n};\r\n\r\n\r\nko.bindingHandlers.readonly = {\r\n    init: function (element, valueAccessor) {\r\n        var input = $(element),\r\n            ro = ko.unwrap(valueAccessor());\r\n\r\n        if (ro) {\r\n            input.prop(\"readonly\", true);\r\n        } else {\r\n\r\n            input.prop(\"readonly\", false);\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var input = $(element),\r\n            ro = ko.unwrap(valueAccessor());\r\n\r\n        if (ro) {\r\n            input.prop(\"readonly\", true);\r\n        } else {\r\n\r\n            input.prop(\"readonly\", false);\r\n        }\r\n    }\r\n};","/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"~/Scripts/jquery-2.2.0.intellisense.js\" />\r\n/// <reference path=\"~/Scripts/require.js\" />\r\n/// <reference path=\"~/kendo/js/kendo.all.js\" />\r\n/// <reference path=\"_pager.js\" />\r\n/// <reference path=\"/SphApp/services/datacontext.js\" />\r\n/// <reference path=\"/SphApp/objectbuilders.js\" />\r\n\r\n\r\n\r\nko.bindingHandlers.kendoEditor = {\r\n    init: function (element, valueAccessor) {\r\n        var $editor = $(element),\r\n            value = valueAccessor(),\r\n            updating = false;\r\n\r\n        setTimeout(function () {\r\n            var editor = $editor.kendoEditor({\r\n                change: function () {\r\n                    if (updating) return;\r\n                    updating = true;\r\n                    value(this.value());\r\n                    setTimeout(function () { updating = false; }, 500);\r\n                }\r\n            }).data(\"kendoEditor\");\r\n\r\n            editor.value(value());\r\n\r\n            value.subscribe(function (html) {\r\n                if (updating) return;\r\n                updating = true;\r\n                editor.value(html);\r\n                setTimeout(function () { updating = false; }, 500);\r\n            });\r\n\r\n        }, 500);\r\n    },\r\n    update2: function (element, valueAccessor) {\r\n        var $editor = $(element),\r\n            value = valueAccessor(),\r\n            ke = $editor.data(\"kendoEditor\");\r\n        if (!$editor.data(\"updating\")) {\r\n            ke.value(value());\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.kendoDropDownListValue = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var currentModelValue = ko.utils.unwrapObservable(value);\r\n        var dd = $(element).data(\"kendoDropDownList\");\r\n        dd.value(currentModelValue);\r\n\r\n        dd.bind(\"change\", function () {\r\n            var nv = dd.value();\r\n            value(nv);\r\n        });\r\n    },\r\n\r\n    update: function (element, valueAccessor) {\r\n        //update value based on a model change\r\n        var value = valueAccessor();\r\n        var modelValue = ko.utils.unwrapObservable(value);\r\n\r\n        if (modelValue) {\r\n            $(element).data(\"kendoDropDownList\").value(modelValue);\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.source = {\r\n};\r\nko.bindingHandlers.kendoComboBox = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            currentModelValue = ko.utils.unwrapObservable(value),\r\n            dd = $(element).data(\"kendoComboBox\") ||\r\n                $(element).kendoComboBox({\r\n                    dataSource: allBindings.source()\r\n                }).data(\"kendoComboBox\");\r\n\r\n        dd.value(currentModelValue);\r\n        allBindings.source.subscribe(function (options) {\r\n            // console.log(options, dd);\r\n            dd.dataSource.data(options);\r\n        });\r\n        dd.bind(\"change\", function () {\r\n            var nv = dd.value();\r\n            value(nv);\r\n        });\r\n    },\r\n\r\n    update: function (element, valueAccessor) {\r\n        //update value based on a model change\r\n        var value = valueAccessor();\r\n        var modelValue = ko.utils.unwrapObservable(value);\r\n\r\n        if (modelValue) {\r\n            $(element).data(\"kendoComboBox\").value(modelValue);\r\n        }\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.decimal = {};\r\nko.bindingHandlers.money = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            decimal = function () {\r\n                if (typeof allBindings.decimal === \"undefined\") {\r\n                    return 2;\r\n                }\r\n                return parseInt(allBindings.decimal);\r\n            },\r\n            textbox = $(element),\r\n            initBinding = function () {\r\n                var val = parseFloat(ko.unwrap(value) || \"0\"),\r\n                    fm = val.toFixed(decimal())\r\n                        .replace(/./g,\r\n                        function (c, i, a) {\r\n                            return i && c !== \".\" && !((a.length - i) % 3) ? \",\" + c : c;\r\n                        });\r\n                if (element.tagName.toLowerCase() === \"span\") {\r\n                    textbox.text(fm);\r\n                    return;\r\n                }\r\n\r\n                textbox.val(fm);\r\n\r\n                textbox.on(\"blur\", function () {\r\n                    var tv = $(this).val().replace(/,/g, \"\");\r\n                    console.log(tv);\r\n                    value(parseFloat(tv));\r\n                });\r\n\r\n            };\r\n        initBinding();\r\n\r\n        if (ko.isObservable(value)) {\r\n            value.subscribe(initBinding);\r\n        }\r\n\r\n\r\n    },\r\n    update: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            decimal = function () {\r\n                if (typeof allBindings.decimal === \"undefined\") {\r\n                    return 2;\r\n                }\r\n                return parseInt(allBindings.decimal);\r\n            },\r\n            textbox = $(element),\r\n            val = parseFloat(ko.unwrap(value) || \"0\"),\r\n            fm = val.toFixed(decimal()).replace(/./g, function (c, i, a) {\r\n                return i && c !== \".\" && !((a.length - i) % 3) ? \",\" + c : c;\r\n            });\r\n\r\n        textbox.val(fm);\r\n\r\n    }\r\n};\r\n\r\n///user moment format\r\nko.bindingHandlers.date = {\r\n    init: function (element, valueAccessor) {\r\n        var value = ko.utils.unwrapObservable(valueAccessor());\r\n\r\n        if (!value) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n        var dv = ko.unwrap(value.value),\r\n            defaultFormat = (dv || \"\").indexOf(\"T\") > -1 ? \"YYYY-MM-DDTHH:mm:ss\" : \"YYYY-MM-DD\",\r\n            inputFormat = ko.unwrap(value.inputFormat) || defaultFormat,\r\n            date = moment(dv, inputFormat),\r\n            invalid = ko.unwrap(value.invalid) || \"invalid date\",\r\n            format = ko.unwrap(value.format) || \"DD/MM/YYYY\";\r\n\r\n        if (!value.format && typeof ko.unwrap(value) === \"string\") {\r\n            dv = ko.unwrap(value);\r\n            date = moment(dv);\r\n        }\r\n\r\n        $(element).on(\"change\", function () {\r\n            var nv = $(this).val();\r\n            value.value(nv);\r\n        });\r\n        if (!dv) {\r\n            $(element).text(invalid);\r\n            $(element).val(invalid);\r\n            return;\r\n        }\r\n        if (!date) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n\r\n        var dateString = date.format(format).toString();\r\n        if (dateString.indexOf(\"NaN\") < 0) {\r\n            $(element).text(dateString);\r\n            $(element).val(dateString);\r\n        }\r\n\r\n\r\n\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = ko.utils.unwrapObservable(valueAccessor());\r\n\r\n        if (!value) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n        var dv = ko.unwrap(value.value),\r\n            defaultFormat = (dv || \"\").indexOf(\"T\") > -1 ? \"YYYY-MM-DDTHH:mm:ss\" : \"YYYY-MM-DD\",\r\n            inputFormat = ko.unwrap(value.inputFormat) || defaultFormat,\r\n            date = moment(dv, inputFormat),\r\n            invalid = ko.unwrap(value.invalid) || \"invalid date\",\r\n            format = ko.unwrap(value.format) || \"DD/MM/YYYY\";\r\n\r\n        if (!value.format && typeof ko.unwrap(value) === \"string\") {\r\n            dv = ko.unwrap(value);\r\n            date = moment(dv);\r\n        }\r\n\r\n        $(element).on(\"change\", function () {\r\n            var nv = $(this).val();\r\n            value.value(nv);\r\n        });\r\n        if (!dv) {\r\n            $(element).text(invalid);\r\n            $(element).val(invalid);\r\n            return;\r\n        }\r\n        if (!date) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n\r\n        var dateString = date.format(format).toString();\r\n        if (dateString.indexOf(\"NaN\") < 0) {\r\n            $(element).text(dateString);\r\n            $(element).val(dateString);\r\n        }\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.kendoUpload = {\r\n    init: function (element, valueAccessor) {\r\n        var context = require(objectbuilders.datacontext),\r\n            logger = require(objectbuilders.logger),\r\n            value = valueAccessor(),\r\n            options = valueAccessor(),\r\n            extensions = [];\r\n        if (options && typeof options === \"object\") {\r\n            value = options.value;\r\n            extensions = options.extensions;\r\n        }\r\n\r\n        $(element).attr(\"name\", \"files\").kendoUpload({\r\n            async: {\r\n                saveUrl: \"/BinaryStore/Upload\",\r\n                removeUrl: \"/BinaryStore/Remove\",\r\n                autoUpload: true\r\n            },\r\n            multiple: false,\r\n            error: function (e) {\r\n                logger.logError(e, e, this, true);\r\n            },\r\n            select: function (e) {\r\n                if (extensions.length === 0) {\r\n                    return;\r\n                }\r\n                _(e.files).each(function (v) {\r\n                    if (extensions.indexOf(v.extension) < 0) {\r\n                        logger.error(\"Only \" + extensions.join(\",\") + \" files can be uploaded\");\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            },\r\n            success: function (e) {\r\n                logger.info(\"Your file has been \" + e.operation);\r\n\r\n                var storeId = e.response.storeId,\r\n                    uploaded = e.operation === \"upload\",\r\n                    removed = e.operation !== \"upload\",\r\n                    oldFile = value();\r\n                if (uploaded) {\r\n                    value(storeId);\r\n                    if (oldFile) {\r\n                        context.post(JSON.stringify({ id: oldFile }), \"/BinaryStore/Remove/\");\r\n                    }\r\n                }\r\n                if (removed) {\r\n                    value(\"\");\r\n                }\r\n            },\r\n            remove: function () {\r\n                var tcs = new $.Deferred(),\r\n                    data = JSON.stringify({ id: value() });\r\n                context.post(data, \"/BinaryStore/Remove/\")\r\n                    .then(function (result) {\r\n                        tcs.resolve(result);\r\n                    });\r\n                return tcs.promise();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n///user moment format\r\nko.bindingHandlers.kendoDate = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            $input = $(element),\r\n            allBindings = allBindingsAccessor(),\r\n            currentValue = ko.unwrap(value),\r\n            date = moment(currentValue, \"DD/MM/YYYY\"),\r\n            changed = function (e) {\r\n                console.log(e);\r\n                var nv = this.value();\r\n                if (typeof nv == \"string\") {\r\n                    date = moment(nv, \"DD/MM/YYYY\");\r\n                } else {\r\n                    date = moment(nv);\r\n                }\r\n                // DO NOT fire update\r\n                $input.data(\"stop\", \"true\");\r\n                value(date.format(\"YYYY-MM-DD\"));\r\n                $input.data(\"stop\", \"false\");\r\n\r\n            },\r\n            picker = $input.kendoDatePicker({ format: \"dd/MM/yyyy\", change: changed }).data(\"kendoDatePicker\");\r\n\r\n        if (typeof allBindings.enable === \"boolean\") {\r\n            if (!allBindings.enable) {\r\n                picker.enable(false);\r\n            }\r\n        }\r\n        if (typeof allBindings.enable === \"function\" && typeof allBindings.enable.subscribe === \"function\") {\r\n            allBindings.enable.subscribe(function (enable) {\r\n                picker.enable(enable);\r\n            });\r\n        }\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n        if (typeof currentValue === \"undefined\" && typeof value === \"function\") {\r\n            value(date.format(\"YYYY-MM-DD\"));\r\n        }\r\n    },\r\n    update: function (element, valueAccessor, allBindingsAccessor) {\r\n        var $input = $(element),\r\n            allBindings = allBindingsAccessor();\r\n        if ($input.data(\"stop\") === \"true\") return;\r\n\r\n        var value = valueAccessor(),\r\n            modelValue = ko.utils.unwrapObservable(value),\r\n            date = moment(modelValue),\r\n            picker = $input.data(\"kendoDatePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (typeof allBindings.enable === \"boolean\") {\r\n            if (!allBindings.enable) {\r\n                picker.enable(false);\r\n            }\r\n        }\r\n        if (typeof allBindings.enable === \"function\" && typeof allBindings.enable.subscribe === \"function\") {\r\n            allBindings.enable.subscribe(function (enable) {\r\n                picker.enable(enable);\r\n            });\r\n        }\r\n        picker.value(date.toDate());\r\n\r\n    }\r\n};\r\n\r\n\r\n///user moment format\r\nko.bindingHandlers.kendoDateTime = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            $input = $(element),\r\n            currentValue = ko.utils.unwrapObservable(value),\r\n            date = moment(currentValue, \"DD/MM/YYYY \"),\r\n            changed = function (e) {\r\n                console.log(e);\r\n                var nv = this.value();\r\n                if (typeof nv == \"string\") {\r\n                    date = moment(nv, \"DD/MM/YYYY hh:mm\");\r\n                } else {\r\n                    date = moment(nv);\r\n                }\r\n                // DO NOT fire update\r\n                $input.data(\"stop\", \"true\");\r\n                value(date.format());\r\n                $input.data(\"stop\", \"false\");\r\n\r\n            },\r\n            picker = $input.kendoDateTimePicker({ format: \"dd/MM/yyyy HH:mm\", change: changed }).data(\"kendoDateTimePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var $input = $(element);\r\n        if ($input.data(\"stop\") === \"true\") return;\r\n\r\n        var value = valueAccessor(),\r\n            modelValue = ko.utils.unwrapObservable(value),\r\n            date = moment(modelValue),\r\n            picker = $input.data(\"kendoDateTimePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.slideVisible = {\r\n    init: function (element, valueAccessor) {\r\n        // Initially set the element to be instantly visible/hidden depending on the value\r\n        var value = valueAccessor();\r\n        $(element).toggle(ko.utils.unwrapObservable(value));\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        ko.utils.unwrapObservable(value) ? $(element).slideDown() : $(element).slideUp();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.kendoEnable = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var enable = ko.utils.unwrapObservable(value);\r\n        if (enable) {\r\n            $(element).removeClass(\"k-state-disabled\");\r\n        } else {\r\n            $(element).addClass(\"k-state-disabled\");\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var enable = ko.utils.unwrapObservable(value);\r\n        if (enable) {\r\n            $(element).removeClass(\"k-state-disabled\");\r\n            $(element).removeAttr(\"disabled\");\r\n        } else {\r\n            $(element).addClass(\"k-state-disabled\");\r\n            $(element).attr(\"disabled\", \"disabled\");\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.command = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var action = valueAccessor(),\r\n            $button = $(element),\r\n            allBindings = allBindingsAccessor(),\r\n            inputValue = $button.val(),\r\n            logger = require(\"services/logger\");\r\n\r\n        if (allBindings.isvisible) {\r\n            var visible = typeof allBindings.isvisible === \"function\" ? allBindings.isvisible() : allBindings.isvisible;\r\n            if (!visible) {\r\n                $button.hide();\r\n            } else {\r\n                $button.show();\r\n            }\r\n\r\n            if (typeof allBindings.isvisible === \"function\") {\r\n                allBindings.isvisible.subscribe(function (v) {\r\n                    if (v)\r\n                        $button.show();\r\n                    else\r\n                        $button.hide();\r\n                });\r\n            }\r\n        }\r\n\r\n        var $spinner = $(\"<i class='fa fa-spin fa-circle-o-notch'></i>\").hide(),\r\n            $warning = $(\"<i class='fa fa-warning' style='color:red'></i>\").hide();\r\n        $button.append($spinner);\r\n        $button.append($warning);\r\n\r\n        $button.click(function (e) {\r\n            e.preventDefault();\r\n            if (this.form) {\r\n                if (!this.form.checkValidity()) return;\r\n            }\r\n            $spinner.show();\r\n            $warning.hide();\r\n\r\n            action(viewModel, e)\r\n                .fail(function (err, o, message) {\r\n                    $button\r\n                        .button(\"complete\")\r\n                        .prop(\"disabled\", false)\r\n                        .val(inputValue)\r\n                        .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                    $warning.show();\r\n                    if (err.status === 404) {\r\n                        logger.error(message);\r\n                        logger.error(err.statusText);\r\n                        return;\r\n                    }\r\n                    if (err.responseJSON) {\r\n                        const responseMessage = err.responseJSON.Message || \"\",\r\n                            details = err.responseJSON.Details || JSON.stringify(err.responseJSON);\r\n                        logger.error(responseMessage);\r\n                        console.error(responseMessage, details);\r\n                    } else {\r\n                        if (err.responseText) {\r\n                            logger.error(err.responseText);\r\n                            console.error(err.responseText);\r\n                        }\r\n                    }\r\n                })\r\n                .done(function () {\r\n                    $button\r\n                        .button(\"complete\")\r\n                        .prop(\"disabled\", false)\r\n                        .val(inputValue)\r\n                        .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                });\r\n            if ($button.data(\"loading-text\")) {\r\n                $button.button(\"loading\");\r\n            }\r\n            $button.addClass(\"btn-disabled\").prop(\"disabled\", true);\r\n\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.field = {\r\n    init: function () {\r\n    }\r\n};\r\n\r\nko.bindingHandlers.unwrapClick = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var action = valueAccessor(),\r\n            button = $(element),\r\n            allBindings = allBindingsAccessor();\r\n\r\n\r\n        button.click(function (e) {\r\n            e.preventDefault();\r\n            var prop = allBindings.property,\r\n                accessor = allBindings.accessor,\r\n                type = allBindings.field,\r\n                entity = allBindings.entity;\r\n            /* if we can't get to the function , i.e. it's still object not ko.observable\r\n            \r\n            */\r\n            if (prop) {\r\n                if (typeof accessor[prop] === \"undefined\") {\r\n                    console.log(\"Can't figure out the accessor.prop\");\r\n                }\r\n                if (typeof accessor[prop] === \"object\") {\r\n                    accessor[prop] = ko.observable(accessor[prop]);\r\n                }\r\n                if (typeof accessor[prop] === \"function\") {\r\n                    action(accessor[prop], type, entity);\r\n                }\r\n            } else {\r\n                action(accessor, type, entity);\r\n            }\r\n\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.fieldImage = {\r\n    init: function (element, valueAccessor) {\r\n        var type = valueAccessor(),\r\n            img = $(element);\r\n\r\n        var ft = typeof type === \"function\" ? type() : type;\r\n        img.attr(\"src\", \"/image/index/\" + ft);\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.stringArrayAutoComplete = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            options = allBindings.data();\r\n\r\n        $(element).data(\"kendoAutoComplete\") ||\r\n            $(element).kendoAutoComplete({\r\n                dataSource: options,\r\n                change: function () {\r\n                    var data = _(this.value().split(\",\")).filter(function (s) {\r\n                        return s;\r\n                    });\r\n                    value(data);\r\n                },\r\n                filter: \"startswith\",\r\n                placeholder: \"....\",\r\n                separator: \",\"\r\n            }).val(value());\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        $(element).data(\"kendoAutoComplete\").value(value());\r\n    }\r\n\r\n};\r\n\r\nko.bindingHandlers.pathAutoComplete = {\r\n    init: function (element, valueAccessor) {\r\n        var command = valueAccessor();\r\n        var value = command.value;\r\n        var type = command.type;\r\n\r\n        if (!type()) return;\r\n\r\n        $.get(\"/App/TriggerPathPickerJson/\" + type())\r\n            .done(function (json) {\r\n                var tree = JSON.parse(json);\r\n                var data = _.chain(tree)\r\n                    .map(function (t) {\r\n                        if (t.parent === \"\")\r\n                            return t.name;\r\n                        return undefined;\r\n                    })\r\n                    .filter(function (t) {\r\n                        return typeof t !== \"undefined\";\r\n                    })\r\n                    .value();\r\n\r\n                console.log(data);\r\n\r\n                var dataSource = new kendo.data.DataSource({\r\n                    data: data\r\n                });\r\n                var input = $(element).data(\"kendoAutoComplete\") ||\r\n                    $(element).kendoAutoComplete({\r\n                        dataSource: tree,\r\n                        dataTextField: \"path\",\r\n                        change: function () {\r\n                            var path = this.value();\r\n                            console.log(\"selected path \", path);\r\n\r\n                        },\r\n                        filter: \"startswith\",\r\n                        placeholder: \"Select path...\",\r\n                        separator: \"\"\r\n                    }).data(\"kendoAutoComplete\");\r\n\r\n                $(element)\r\n                    .change(function () {\r\n                        value($(this).val());\r\n                        console.log(\"new value\", value());\r\n                    })\r\n                    .val(value())\r\n                    .on(\"keydown3\", function (e) {\r\n                        if (e.which === 110 || e.which === 190) {\r\n                            var path = $(this).val() + \".\";\r\n                            console.log(\"show the auto complete\", path);\r\n                            var filtered = _.chain(tree)\r\n                                .filter(function (t) {\r\n                                    return t.parent === path;\r\n                                })\r\n                                .map(function (t) {\r\n                                    return t.name;\r\n                                })\r\n                                .value();\r\n                            console.log(filtered);\r\n                            //input.setDataSource(dataSource);\r\n                            dataSource.data(filtered);\r\n                            input.refresh();\r\n                        }\r\n                    });\r\n            });\r\n\r\n    }\r\n\r\n};\r\n\r\nko.bindingHandlers.commandWithParameter = {\r\n    init: function (element, valueAccessor) {\r\n        var command = valueAccessor(),\r\n            callback = command.command,\r\n            parameter = command.parameter || command.commandParameter,\r\n            button = $(element),\r\n            inputValue = button.val();\r\n\r\n\r\n        var $spinner = $(\"<i class='fa fa-spin fa-circle-o-notch'></i>\").hide(),\r\n            $warning = $(\"<i class='fa fa-warning' style='color:red'></i>\").hide();\r\n        button.append($spinner);\r\n        button.append($warning);\r\n\r\n        button.click(function (e) {\r\n            e.preventDefault();\r\n            if (this.form) {\r\n                if (!this.form.checkValidity()) return;\r\n            }\r\n            $spinner.show();\r\n            $warning.hide();\r\n\r\n            callback(parameter)\r\n                .fail(function (err, o, message) {\r\n                    button\r\n                        .button(\"complete\")\r\n                        .prop(\"disabled\", false)\r\n                        .val(inputValue)\r\n                        .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                    $warning.show();\r\n                    if (err.status === 404) {\r\n                        logger.error(message);\r\n                        logger.error(err.statusText);\r\n                        return;\r\n                    }\r\n                    if (err.responseText) {\r\n                        logger.error(err.responseText);\r\n                        console.error(err.responseText);\r\n                    }\r\n                    if (err.responseJSON) {\r\n                        logger.error(JSON.stringify(err.responseJSON));\r\n                        console.error(err.responseJson);\r\n                    }\r\n                })\r\n                .done(function () {\r\n                    button\r\n                        .button(\"complete\")\r\n                        .prop(\"disabled\", false)\r\n                        .val(inputValue)\r\n                        .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                });\r\n            if (button.data(\"loading-text\")) {\r\n                button.button(\"loading\");\r\n            }\r\n            button.addClass(\"btn-disabled\").prop(\"disabled\", true);\r\n\r\n        });\r\n    }\r\n\r\n};\r\n\r\n\r\nko.bindingHandlers.filter = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            bindingAccessor = allBindingsAccessor(),\r\n            path = value.path,\r\n            tooltip = value.tooltip || \"Type to filter current page or type and [ENTER] to search the whole view\",\r\n            $element = $(element),\r\n            $filterInput = $(\"<input data-toggle=\\\"tooltip\\\" title=\\\"\" + tooltip + \"\\\" type=\\\"search\\\" class=\\\"search-query input-medium form-control\\\" placeholder=\\\"Filter.. \\\">\"),\r\n            $serverLoadButton = $(\"<a href='/#' title='Carian server'><i class='add-on icon-search'></i><a>\"),\r\n            $form = $(\"<form class='form-search row'>\" +\r\n                \" <div class='input-group pull-right' style='width:300px'>\" +\r\n                \"<span class='input-group-addon'>\" +\r\n                \" <span class='glyphicon glyphicon-remove'></span>\" +\r\n                \"</span> \" +\r\n                \"</div>\" +\r\n                \" </form>\"),\r\n            pagedSearch = bindingAccessor.searchPaging,\r\n            customSearch = value.customSearch;\r\n\r\n\r\n        $form.find(\"span.input-group-addon\").before($filterInput);\r\n        if (pagedSearch) {\r\n            $form.find(\"span.glyphicon-remove\").after($serverLoadButton);\r\n        }\r\n        $element.before($form);\r\n\r\n        $form.submit(function (e) {\r\n            e.preventDefault();\r\n            var filter = $filterInput.val().toLowerCase(),\r\n                tcs = new $.Deferred();\r\n            if (!filter) {\r\n                return tcs.promise();\r\n            }\r\n            if (typeof customSearch === \"function\") {\r\n                return customSearch(filter);\r\n            }\r\n            if (pagedSearch && typeof pagedSearch.query !== \"undefined\" && typeof pagedSearch.query.filterAndSearch === \"function\") {\r\n                return pagedSearch.query.filterAndSearch(filter);\r\n            }\r\n            return tcs.promise();\r\n        });\r\n\r\n        var previousFilter = \"\",\r\n            dofilter = function () {\r\n                var $rows = $element.find(path),\r\n                    filter = $filterInput.val().toLowerCase();\r\n                if (previousFilter === filter) {\r\n                    return;\r\n                }\r\n                previousFilter = filter;\r\n                $rows.each(function () {\r\n                    var $tr = $(this),\r\n                        text = $tr.text().toLowerCase().trim();\r\n                    if (!text) {\r\n                        $(\"input\", $tr).each(function (i, v) { text += \" \" + $(v).val() });\r\n                        text = text.toLowerCase().trim();\r\n                    }\r\n                    if (text.indexOf(filter) > -1) {\r\n                        $tr.show();\r\n                    } else {\r\n                        $tr.hide();\r\n                    }\r\n                });\r\n\r\n\r\n            },\r\n            throttled = _.throttle(dofilter, 800);\r\n\r\n        $filterInput.on(\"keyup\", throttled).siblings(\"span.input-group-addon\")\r\n            .click(function () {\r\n                $filterInput.val(\"\");\r\n                dofilter();\r\n            });\r\n\r\n        if ($filterInput.val()) {\r\n            dofilter();\r\n        }\r\n        $filterInput.tooltip();\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.serverPaging = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var value = valueAccessor(),\r\n            entity = value.entity,\r\n            enableReload = value.enableReload,\r\n            hasCommands = ko.isObservable((viewModel.toolbar || {}).commands),\r\n            query = value.query,\r\n            list = value.list,\r\n            map = value.map,\r\n            pagerHidden = value.pagerHidden || false,\r\n            $element = $(element),\r\n            context = require(\"services/datacontext\"),\r\n            $pagerPanel = $(\"<div></div>\"),\r\n            $spinner = $(\"<img src=\\\"/Images/spinner-md.gif\\\" alt=\\\"loading\\\" class=\\\"absolute-center\\\" />\"),\r\n            startLoad = function () {\r\n                $spinner.show();\r\n                $element.fadeTo(\"fast\", 0.33);\r\n            },\r\n            endLoad = function () {\r\n                $spinner.hide();\r\n                $element.fadeTo(\"fast\", 1);\r\n            },\r\n            setItemsSource = function (items) {\r\n                if (map) {\r\n                    items = _(items).map(map);\r\n                }\r\n                if (typeof list === \"string\") {\r\n                    viewModel[list](items);\r\n                }\r\n                if (typeof list === \"function\") {\r\n                    list(items);\r\n                }\r\n            },\r\n            changed = function (page, size) {\r\n                startLoad();\r\n                return context.loadAsync({\r\n                    entity: entity,\r\n                    page: page,\r\n                    size: size,\r\n                    includeTotal: true\r\n                }, query)\r\n                    .then(function (lo) {\r\n                        setItemsSource(lo.itemCollection);\r\n                        endLoad();\r\n                    });\r\n            };\r\n\r\n        if (enableReload && hasCommands) {\r\n            const commandId = \"server-paging-reload\",\r\n                reloadCommand = viewModel.toolbar.commands().find(x => x.id === commandId);\r\n            if (!reloadCommand) {\r\n                viewModel.toolbar.commands.push({\r\n                    command: function () {\r\n                        return changed(1, 20);\r\n                    },\r\n                    caption: \"Reload\",\r\n                    icon: \"bowtie-icon bowtie-navigate-refresh\",\r\n                    id: commandId\r\n                });\r\n\r\n            }\r\n        }\r\n\r\n        if (enableReload && !hasCommands) {\r\n            console.error(\"Please provide a toolbar with commands : ko.observableArray(), in your viewModel\");\r\n        }\r\n\r\n        $element.after($pagerPanel).after($spinner)\r\n            .fadeTo(\"slow\", 0.33);\r\n\r\n        var tcs = new $.Deferred();\r\n        context.loadAsync({\r\n            entity: entity,\r\n            page: 1,\r\n            size: 20,\r\n            includeTotal: true\r\n        }, query)\r\n            .then(function (lo) {\r\n\r\n                var options = {\r\n                    element: $pagerPanel,\r\n                    count: lo.rows,\r\n                    changed: changed,\r\n                    hidden: pagerHidden\r\n                },\r\n                    pager = new bespoke.utils.ServerPager(options);\r\n                console.log(pager);\r\n                setTimeout(function () {\r\n                    setItemsSource(lo.itemCollection);\r\n                    tcs.resolve(true);\r\n                    endLoad();\r\n                }, 500);\r\n\r\n            });\r\n        return tcs.promise();\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.searchPaging = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var value = valueAccessor(),\r\n            entity = value.entity,\r\n            enableReload = value.enableReload,\r\n            hasCommands = ko.isObservable((viewModel.toolbar || {}).commands),\r\n            query = value.query,\r\n            executedQuery = value.query || value.initialQuery || {},\r\n            list = value.list,\r\n            map = value.map,\r\n            pagerHidden = value.pagerHidden || false,\r\n            searchButton = value.searchButton,\r\n            $element = $(element),\r\n            context = require(\"services/datacontext\"),\r\n            logger = require(\"services/logger\"),\r\n            cultures = require(objectbuilders.cultures),\r\n            $pagerPanel = $(\"<div></div>\"),\r\n            $spinner = $(\"<img src=\\\"/Images/spinner-md.gif\\\" alt=\\\"loading\\\" class=\\\"absolute-center\\\" />\"),\r\n            startLoad = function () {\r\n                $spinner.show();\r\n                $element.fadeTo(\"fast\", 0.33);\r\n            },\r\n            endLoad = function () {\r\n                $spinner.hide();\r\n                $element.fadeTo(\"fast\", 1);\r\n            },\r\n            pager = null,\r\n            setItemsSource = function (items) {\r\n\r\n                if (!pagerHidden) {\r\n                    _(items).each(function (v) {\r\n                        v.pager = {\r\n                            page: pager.page(),\r\n                            size: pager.pageSize()\r\n                        };\r\n                    });\r\n                }\r\n\r\n                if (map) {\r\n                    items = _(items).map(map);\r\n                }\r\n                if (typeof list === \"string\") {\r\n                    viewModel[list](items);\r\n                }\r\n                if (typeof list === \"function\") {\r\n                    list(items);\r\n                }\r\n            },\r\n            pageChanged = function (page, size) {\r\n                startLoad();\r\n                context.searchAsync({\r\n                    entity: entity,\r\n                    page: page,\r\n                    size: size\r\n                }, executedQuery)\r\n                    .then(function (lo) {\r\n                        setItemsSource(lo.itemCollection);\r\n                        endLoad();\r\n                    });\r\n            },\r\n            search = function (q, page, size) {\r\n                executedQuery = q;\r\n                var tcs1 = new $.Deferred();\r\n                startLoad();\r\n                context.searchAsync({\r\n                    entity: entity,\r\n                    page: page || 1,\r\n                    size: size || 20\r\n                }, q)\r\n                    .then(function (lo) {\r\n                        if (pager) {\r\n                            pager.update(lo.rows);\r\n                        } else {\r\n                            var pagerOptions = {\r\n                                element: $pagerPanel,\r\n                                count: lo.rows,\r\n                                changed: pageChanged,\r\n                                hidden: pagerHidden\r\n                            };\r\n                            pager = new bespoke.utils.ServerPager(pagerOptions);\r\n\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            setItemsSource(lo.itemCollection);\r\n                            tcs1.resolve(lo);\r\n                            endLoad();\r\n                        }, 500);\r\n\r\n                    });\r\n                return tcs1.promise();\r\n            },\r\n            filterAndSearch = function (text) {\r\n                const originalQuery = JSON.parse(ko.toJSON(value.query || value.initialQuery)),\r\n                    fullTextQuery = {\r\n                        \"from\": 0,\r\n                        \"size\": 20,\r\n                        \"query\": {}\r\n                    };\r\n                originalQuery.query = originalQuery.query || {};\r\n                originalQuery.query.bool = originalQuery.query.bool || {};\r\n\r\n                fullTextQuery.query.bool = originalQuery.query.bool;\r\n                fullTextQuery.query.bool.must = originalQuery.query.bool.must || [];\r\n                fullTextQuery.query = ({\r\n                    \"query_string\": {\r\n                        \"default_field\": \"_all\",\r\n                        \"query\": text\r\n                    }\r\n                });\r\n                fullTextQuery.sort = originalQuery.sort;\r\n                pager.destroy();\r\n                pager = null;\r\n                search(fullTextQuery);\r\n            };\r\n\r\n        if (typeof query.subscribe === \"function\") {\r\n            query.subscribe(function (q) {\r\n                search(q, 1, 20);\r\n            });\r\n        }\r\n\r\n\r\n        if (enableReload && hasCommands) {\r\n            const commandId = \"search-paging-reload\",\r\n                reloadCommand = viewModel.toolbar.commands().find(x => x.id === commandId);\r\n            if (!reloadCommand) {\r\n                viewModel.toolbar.commands.push({\r\n                    command: function () {\r\n                        return changed(1, 20);\r\n                    },\r\n                    caption: \"Reload\",\r\n                    icon: \"bowtie-icon bowtie-navigate-refresh\",\r\n                    id: commandId\r\n                });\r\n\r\n            }\r\n        }\r\n\r\n        if (enableReload && !hasCommands) {\r\n            console.error(\"Please provide a toolbar with commands : ko.observableArray(), in your viewModel\");\r\n        }\r\n        //exposed the search function\r\n        query.search = search;\r\n        query.filterAndSearch = filterAndSearch;\r\n\r\n        $element.after($pagerPanel).after($spinner)\r\n            .fadeTo(\"slow\", 0.33);\r\n\r\n        if (searchButton) {\r\n            $(document).on(\"click\", searchButton, function (e) {\r\n                e.preventDefault();\r\n                if (!$(this).parents(\"form\")[0].checkValidity()) {\r\n                    logger.error(cultures.messages.FORM_IS_NOT_VALID);\r\n                    return;\r\n                }\r\n                search(ko.toJS(query), 1, pager.pageSize());\r\n            });\r\n\r\n        }\r\n\r\n\r\n        search(ko.toJS(executedQuery));\r\n        return {\r\n            search: search,\r\n            filterAndSearch: filterAndSearch\r\n        };\r\n\r\n    }\r\n};","/// <reference path=\"typeahead.bundle.js\" />\r\n/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"jquery-2.1.1.intellisense.js\" />\r\n\r\nko.bindingHandlers.bootstrapDropDown = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor()) || '[Select your value]',\r\n            anchor = $(element),\r\n            opened = false,\r\n            dropDown = function (e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                var button = $(this);\r\n\r\n                if (opened) {\r\n                    button.parent().removeClass(\"open\");\r\n                    opened = false;\r\n\r\n                } else {\r\n                    button.parent().addClass(\"open\");\r\n                    opened = true;\r\n                    $(document).one('click', function () {\r\n                        button.parent().removeClass(\"open\");\r\n                        opened = false;\r\n                    });\r\n                }\r\n\r\n\r\n            };\r\n        anchor.click(dropDown);\r\n\r\n        if (!anchor.html()) {\r\n            if (text.toString() === \"[object Object]\") {\r\n                text = \"[Select you value]\";\r\n            }\r\n            anchor.html(text + ' <i class=\"fa fa-caret-down\"></i>');\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.tooltip = {\r\n    init: function (element, valueAccesor) {\r\n        var optionOrText = ko.unwrap(valueAccesor()),\r\n            placement = optionOrText.tooltipPlacement || optionOrText.placement || \"top\",\r\n            text = optionOrText.text || optionOrText.tooltip || optionOrText;\r\n        if (typeof text !== \"string\") {\r\n            text = (optionOrText.text || {}).tooltip;\r\n        }\r\n        if (typeof text === \"string\") {\r\n            $(element).tooltip({ title: text, placement: placement });\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.bootstrapPopover = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor()).replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\r\n        $(element).popover({ content: \"<pre>\" + text + \"</pre>\", html: true, placement:\"bottom\" });\r\n    }\r\n};\r\nko.bindingHandlers.popover = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).popover({ content: '<pre>' + text + '</pre>', html: true });\r\n    }\r\n};\r\nko.bindingHandlers.bootstrapTooltip = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).tooltip({ title: text });\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nko.bindingHandlers.cssAutoComplete = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            bootstrap = _(document.styleSheets).find(function (s) {\r\n                // TODO : what happend if were to combine the css with Bundle\r\n                if (!s) return false;\r\n                if (!s.href) return false;\r\n\r\n                return s.href.indexOf(\"bootstrap\") > -1;\r\n            });\r\n        var data = ['btn', 'btn-warning', 'btn-success', 'btn-link'];\r\n        if (bootstrap) {\r\n            data = _.chain(bootstrap.rules).filter(function (r) {\r\n                return /^\\./g.test(r.selectorText)\r\n                    && !/:/g.test(r.selectorText)\r\n                    && !/\\s/g.test(r.selectorText)\r\n                    && !/\\+/g.test(r.selectorText)\r\n                    && !/>/g.test(r.selectorText)\r\n                    && !/\\[/g.test(r.selectorText);\r\n            }).map(function (s) {\r\n                return s.selectorText.replace(/\\./g, \"\");\r\n            })\r\n                .value();\r\n        }\r\n\r\n        $(element).typeahead({\r\n            name: 'css_class',\r\n            limit: 10,\r\n            local: data\r\n        })\r\n        .on('typeahead:closed', function () {\r\n            value($(this).val());\r\n        });\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\nko.bindingHandlers.autocomplete = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var va = ko.unwrap(valueAccessor()),\r\n         entity = ko.unwrap(va.entity),\r\n         field = ko.unwrap(va.field),\r\n         query = ko.unwrap(va.query),\r\n         ttl = va.ttl || 300000,\r\n         allBindings = allBindingsAccessor(),\r\n         url = String.format(\"/api/list?table={0}&column={1}&filter={2}\", entity, field, query),\r\n         suggestions = new Bloodhound({\r\n             datumTokenizer: Bloodhound.tokenizers.obj.whitespace(\"name\"),\r\n             queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n             prefetch: {\r\n                 url: url,\r\n                 tt1: ttl,\r\n                 filter: function (list) {\r\n                     return _(list).map(function (v) {\r\n                         return { name: v };\r\n                     });\r\n                 }\r\n             }\r\n\r\n         });\r\n\r\n        suggestions.initialize();\r\n        $(element).typeahead(null, {\r\n            name: 'autocomplete_' + $(element).prop(\"id\"),\r\n            displayKey: \"name\",\r\n            source: suggestions.ttAdapter()\r\n        })\r\n           .on('typeahead:closed', function () {\r\n               allBindings.value($(this).val());\r\n           });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.scroll = {\r\n    init: function (element, valueAccessor) {\r\n        var rows = ko.unwrap(valueAccessor()),\r\n            done = false;\r\n        // wait for attached\r\n        //setTimeout(function () {\r\n        //    // TODO : just do it this once rows is more than certail values\r\n        //    $(element).tableScroll({ height: height });\r\n        //    done = true;\r\n        //}, 500);\r\n    }\r\n};\r\n","(function () {\r\n    Function.prototype.partial = function () {\r\n        var fn = this, args = Array.prototype.slice.call(arguments);\r\n        return function () {\r\n            var arg = 0;\r\n            for (var i = 0; i < args.length && arg < arguments.length; i++) {\r\n                if (args[i] === undefined) {\r\n                    args[i] = arguments[arg++];\r\n                }\r\n            }\r\n            return fn.apply(this, args);\r\n        };\r\n    };\r\n\r\n})();","(function (window) {\r\n    window.bespoke = window.bespoke || {};\r\n    window.bespoke.ServerOperationStatus = {        \r\n        OK: \"OK\",\r\n        ERROR : \"ERROR\"\r\n    };\r\n\r\n    window.bespoke.messagesText = {\r\n        SAVE_SUCCESS : \"Your item has been saved\"\r\n    };\r\n\r\n})(window);\r\n","/// <reference path=\"bootstrap.js\" />\r\n/// <reference path=\"google-maps-3-vs-1-0-vsdoc.js\" />\r\n/// <reference path=\"bootstrap-datepicker.js\" />\r\n/// <reference path=\"jquery.validate-vsdoc.js\" />\r\n/// <reference path=\"jquery-1.9.1.intellisense.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"modernizr-2.6.2.js\" />\r\n\r\n\r\nvar _uiready = function () {\r\n    var init = function (view) {\r\n    };\r\n    return {\r\n        init: init\r\n    };\r\n\r\n}();\r\n","(function (window, $) {\r\n    window.bespoke = window.bespoke || {};\r\n    bespoke.utils = bespoke.utils || {};\r\n    bespoke.utils.form = bespoke.utils.form || {};\r\n    bespoke.utils.form.checkValidity = function (button) {\r\n        if (button.form)\r\n            return button.form.checkValidity();\r\n        var form = $(button).attr(\"form\");\r\n        if (form) {\r\n           return document.getElementById(form).checkValidity();\r\n        }\r\n        throw \"cannot find the form for the button\";\r\n    };\r\n\r\n\r\n    window.console = window.console || {};\r\n    window.console.dir = window.console.dir || function (){};\r\n\r\n\r\n})(window, jQuery);","(function (window, $) {\r\n    window.Task = window.Task || {};\r\n    window.Task.fromResult = function (returnValue, delay) {\r\n        var tcs = new $.Deferred(),\r\n            d = delay || 100;\r\n\r\n        setTimeout(function () {\r\n            tcs.resolve(returnValue);\r\n        }, d);\r\n        return tcs.promise();\r\n\r\n    };\r\n\r\n})(window, jQuery);\r\n","\r\nko.bindingHandlers.theme = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {\r\n        // First get the latest data that we're bound to\r\n        var value = valueAccessor(), allBindings = allBindingsAccessor();\r\n        var valueUnwrapped = ko.unwrap(value);\r\n        if(bespoke.sph.Theme) {\r\n            var theme = new bespoke.sph.Theme();\r\n            if (theme[valueUnwrapped]) {\r\n                theme[valueUnwrapped](element, viewModel, allBindings, bindingContext);\r\n            }\r\n            \r\n        }\r\n\r\n    }\r\n};","/// <reference path=\"jquery-2.2.0.js\" />\r\n/// <reference path=\"jquery-ui-1.11.1.js\" />\r\n/// <reference path=\"modernizr-2.8.3.js\" />\r\n/// <reference path=\"bootstrap.js\" />\r\n/// <reference path=\"breeze.debug.js\" />\r\n/// <reference path=\"knockout-2.2.1.debug.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"q.js\" />\r\n/// <reference path=\"toastr-1.1.5.js\" />\r\n"]}