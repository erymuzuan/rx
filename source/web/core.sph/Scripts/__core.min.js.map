{"version":3,"sources":["string.js","_pager.js","_ko.workflow.js","_ko.entity.js","_ko.kendo.js","_ko.bootstrap.js","_function.prototypes.js","_constants.js","_uiready.js","_utils.js","_task.js","_theme.js","_references.js"],"names":["$type","String","__typeName","__class","$prototype","prototype","moment","format","this","endsWith","suffix","substr","length","startsWith","prefix","trim","replace","isNullOrWhiteSpace","value","trimmedValue","isNullOrEmpty","trimEnd","trimStart","_toFormattedString","arguments","useLocale","args","result","i","open","indexOf","close","slice","charAt","Error","brace","substring","colonIndex","argNumber","parseInt","isNaN","argFormat","arg","toFormattedString","localeFormat","toString","window","bespoke","utils","ServerPager","options","element","count","changed","console","log","self2","rows","_","range","pagerDataSource","kendo","data","DataSource","pageSize","hidden","pager","kendoPager","dataSource","pageSizes","page","bind","update","count2","j","setTimeout","destroy","empty","size","pg","dropdownlist","$","find","e","ko","bindingHandlers","activityClass","init","valueAccessor","div","act","unwrap","fullName","name","exec","addClass","checkedItems","item","dataFor","list","change","checked","is","push","remove","wdTypeaheadPath","allBindingsAccessor","allBindings","instance","setup","wd","mapping","toJS","input","css","height","hide","before","c","completely","fontSize","color","fontFamily","setText","ix","sort","currentObject","onChange","text","lastIndexOf","props","split","each","v","startFrom","repaint","attr","blur","val","parent","padding","prop","subscribe","typeahead","activityPopover","pop","popover","title","Name","html","content","WebId","on","document","preventDefault","app","require","objectbuilders","link","hasClass","showMessage","done","removeActivity","editActivity","setStartActivity","comboBoxLookupOptions","$select","lookup","caption","context","query","getTuplesAsync","entity","field","valuePath","field2","displayPath","add","Option","Item2","Item1","solutiontree","solution","click","addEntityDefinition","addForm","addOperation","addView","eds","treeRoots","id","icon","TypeName","ProjectMetadataCollection","pmd","Id","ChildItemCollection","child","parentId","ParentId","jstree","core","concat","plugins","contextmenu","items","node","Create","label","action","addWorkflowDefinition","addTransformDefinition","addAdapter","addTrigger","Create Form","Create Views","Create Operation","tree","system","searchbox","member","selected","jsTreeData","state","opened","recurseChildMember","children","MemberCollection","map","type","loadJsTree","rename_node","set_type","event","ev","mb","animation","check_callback","themes","stripes","sph","domain","Member","guid","newNode","ref","sel","get_selected","create_node","edit","n","p","get_node","parentMember","child2","delete_node","types","System.String, mscorlib","valid_children","System.DateTime, mscorlib","System.Int32, mscorlib","System.Decimal, mscorlib","System.Boolean, mscorlib","System.Object, mscorlib","System.Array, mscorlib","to","keyup","clearTimeout","search","help","href","substringMatcher","strs","q","cb","matches","substringRegex","RegExp","str","test","typeaheadUrl","ttl","url","suggestions","Bloodhound","datumTokenizer","tokenizers","obj","whitespace","queryTokenizer","limit","remote","tt1","filter","initialize","displayKey","source","ttAdapter","entityTypeaheadPath","datacontext","config","idOrName","typeaheadEntity","eid","ed","applicationName","toLowerCase","loadOneAsync","edf","cssTypeahead","results","extractor","paths","path","members","d","s","local","minLength","highlight","updater","$element","matcher","tquery","chart","Entity","JSON","parse","Query","Type","tcs","Deferred","searchAsync","buckets","aggregations","category","key_as_string","key","doc_count","categories","kendoChart","theme","chartArea","background","legend","position","seriesDefaults","labels","visible","template","series","categoryAxis","majorGridLines","tooltip","resolve","getScalarAsync","EntityViewId","viewName","refresh","promise","iconPicker","$input","$picker","append","dialog","app2","showDialog","observableArray","getSingletonObservableArray","$link","stopPropagation","virtualElements","allowedBindings","lookupText","setTextContent","ele","textContent","unwrapObservable","undefined","innerTextNode","firstChild","nodeType","nextSibling","setDomNodeChildren","ownerDocument","createTextNode","readonly","ro","kendoEditor","$editor","updating","editor","update2","ke","kendoDropDownListValue","currentModelValue","dd","nv","modelValue","kendoComboBox","decimal","money","textbox","parseFloat","fm","toFixed","a","tagName","tv","date","dv","inputFormat","invalid","year","dateString","kendoUpload","logger","extensions","async","saveUrl","removeUrl","autoUpload","multiple","error","logError","select","files","extension","join","success","info","operation","storeId","response","uploaded","removed","oldFile","post","stringify","then","kendoDate","currentValue","picker","kendoDatePicker","enable","toDate","kendoDateTime","kendoDateTimePicker","slideVisible","toggle","slideDown","slideUp","kendoEnable","removeClass","removeAttr","command","$button","inputValue","isvisible","show","$spinner","form","checkValidity","button","unwrapClick","property","accessor","observable","fieldImage","img","ft","stringArrayAutoComplete","kendoAutoComplete","placeholder","separator","pathAutoComplete","get","json","chain","t","dataTextField","which","filtered","commandWithParameter","callback","parameter","commandParameter","completeText","bindingAccessor","offset","colmd","coloff","$filterInput","$serverLoadButton","$form","pagedSearch","searchPaging","after","submit","filterAndSearch","dofilter","$rows","$tr","throttled","throttle","siblings","serverPaging","viewModel","pagerHidden","$pagerPanel","startLoad","fadeTo","endLoad","setItemsSource","loadAsync","includeTotal","lo","itemCollection","executedQuery","initialQuery","searchButton","cultures","pageChanged","tcs1","pagerOptions","toJSON","q2","from","query_string","default_field","parents","messages","FORM_IS_NOT_VALID","bootstrapDropDown","valueAccesor","anchor","dropDown","one","bootstrapPopover","bootstrapTooltip","cssAutoComplete","bootstrap","styleSheets","rules","r","selectorText","autocomplete","va","prefetch","scroll","Function","partial","fn","Array","call","apply","ServerOperationStatus","OK","ERROR","messagesText","SAVE_SUCCESS","_uiready","getElementById","dir","jQuery","Task","fromResult","returnValue","delay","ret","bindingContext","valueUnwrapped","Theme"],"mappings":"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","file":"__core.min.js","sourcesContent":["// String.js - liberated from MicrosoftAjax.js on 03/28/10 by Sky Sanders \r\n\r\n/*\r\n    Copyright (c) 2009, CodePlex Foundation\r\n    All rights reserved.\r\n\r\n    Redistribution and use in source and binary forms, with or without modification, are permitted \r\n    provided that the following conditions are met:\r\n\r\n    *   Redistributions of source code must retain the above copyright notice, this list of conditions \r\n        and the following disclaimer.\r\n\r\n    *   Redistributions in binary form must reproduce the above copyright notice, this list of conditions \r\n        and the following disclaimer in the documentation and/or other materials provided with the distribution.\r\n\r\n    *   Neither the name of CodePlex Foundation nor the names of its contributors may be used to endorse or \r\n        promote products derived from this software without specific prior written permission.\r\n\r\n    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED \r\n    WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR \r\n    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE \r\n    FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT \r\n    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS \r\n    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, \r\n    OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN \r\n    IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</textarea>\r\n*/\r\n\r\n(function (window) {\r\n\r\n    $type = String;\r\n    $type.__typeName = 'String';\r\n    $type.__class = true;\r\n\r\n    $prototype = $type.prototype;\r\n    $prototype.moment = function String$moment(format) {\r\n        /// <summary>Create a moment date time object.</summary>\r\n        /// <param name=\"format\" type=\"String\">format.</param>\r\n        /// <returns type=\"moment\"></returns>\r\n        if (format)\r\n            return moment(this, format);\r\n        return moment(this);\r\n    };\r\n    $prototype.endsWith = function String$endsWith(suffix) {\r\n        /// <summary>Determines whether the end of this instance matches the specified string.</summary>\r\n        /// <param name=\"suffix\" type=\"String\">A string to compare to.</param>\r\n        /// <returns type=\"Boolean\">true if suffix matches the end of this instance; otherwise, false.</returns>\r\n        return (this.substr(this.length - suffix.length) === suffix);\r\n    };\r\n\r\n    $prototype.startsWith = function String$startsWith(prefix) {\r\n        /// <summary >Determines whether the beginning of this instance matches the specified string.</summary>\r\n        /// <param name=\"prefix\" type=\"String\">The String to compare.</param>\r\n        /// <returns type=\"Boolean\">true if prefix matches the beginning of this string; otherwise, false.</returns>\r\n        return (this.substr(0, prefix.length) === prefix);\r\n    };\r\n\r\n    $prototype.trim = function String$trim() {\r\n        /// <summary >Removes all leading and trailing white-space characters from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the start and end of the current String object.</returns>\r\n        return this.replace(/^\\s+|\\s+$/g, '');\r\n    };\r\n\r\n    $prototype.isNullOrWhiteSpace = function String$isNullOrWhiteSpace(value) {\r\n\r\n        var trimmedValue = String.trim(value);\r\n        if (!trimmedValue)\r\n            return true;\r\n        return false;\r\n    };\r\n    $prototype.isNullOrEmpty = function String$isNullOrWhiteSpace(value) {\r\n        if (!value)\r\n            return true;\r\n        return false;\r\n    };\r\n\r\n    $prototype.trimEnd = function String$trimEnd() {\r\n        /// <summary >Removes all trailing white spaces from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the end of the current String object.</returns>\r\n        return this.replace(/\\s+$/, '');\r\n    };\r\n\r\n    $prototype.trimStart = function String$trimStart() {\r\n        /// <summary >Removes all leading white spaces from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the start of the current String object.</returns>\r\n        return this.replace(/^\\s+/, '');\r\n    }\r\n\r\n    $type.format = function String$format(format, args) {\r\n        /// <summary>Replaces the format items in a specified String with the text equivalents of the values of   corresponding object instances. The invariant culture will be used to format dates and numbers.</summary>\r\n        /// <param name=\"format\" type=\"String\">A format string.</param>\r\n        /// <param name=\"args\" parameterArray=\"true\" mayBeNull=\"true\">The objects to format.</param>\r\n        /// <returns type=\"String\">A copy of format in which the format items have been replaced by the   string equivalent of the corresponding instances of object arguments.</returns>\r\n        return String._toFormattedString(false, arguments);\r\n    };\r\n\r\n    $type._toFormattedString = function String$_toFormattedString(useLocale, args) {\r\n        var result = '';\r\n        var format = args[0];\r\n\r\n        for (var i = 0; ;) {\r\n            // Find the next opening or closing brace\r\n            var open = format.indexOf('{', i);\r\n            var close = format.indexOf('}', i);\r\n            if ((open < 0) && (close < 0)) {\r\n                // Not found: copy the end of the string and break\r\n                result += format.slice(i);\r\n                break;\r\n            }\r\n            if ((close > 0) && ((close < open) || (open < 0))) {\r\n\r\n                if (format.charAt(close + 1) !== '}') {\r\n                    throw new Error('format stringFormatBraceMismatch');\r\n                }\r\n\r\n                result += format.slice(i, close + 1);\r\n                i = close + 2;\r\n                continue;\r\n            }\r\n\r\n            // Copy the string before the brace\r\n            result += format.slice(i, open);\r\n            i = open + 1;\r\n\r\n            // Check for double braces (which display as one and are not arguments)\r\n            if (format.charAt(i) === '{') {\r\n                result += '{';\r\n                i++;\r\n                continue;\r\n            }\r\n\r\n            if (close < 0) throw new Error('format stringFormatBraceMismatch');\r\n\r\n\r\n            // Find the closing brace\r\n\r\n            // Get the string between the braces, and split it around the ':' (if any)\r\n            var brace = format.substring(i, close);\r\n            var colonIndex = brace.indexOf(':');\r\n            var argNumber = parseInt((colonIndex < 0) ? brace : brace.substring(0, colonIndex), 10) + 1;\r\n\r\n            if (isNaN(argNumber)) throw new Error('format stringFormatInvalid');\r\n\r\n            var argFormat = (colonIndex < 0) ? '' : brace.substring(colonIndex + 1);\r\n\r\n            var arg = args[argNumber];\r\n            if (typeof (arg) === \"undefined\" || arg === null) {\r\n                arg = '';\r\n            }\r\n\r\n            // If it has a toFormattedString method, call it.  Otherwise, call toString()\r\n            if (arg.toFormattedString) {\r\n                result += arg.toFormattedString(argFormat);\r\n            } else if (useLocale && arg.localeFormat) {\r\n                result += arg.localeFormat(argFormat);\r\n            } else if (arg.format) {\r\n                result += arg.format(argFormat);\r\n            } else\r\n                result += arg.toString();\r\n\r\n            i = close + 1;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n})(window); ","/// <reference path=\"toastr.js\" />\r\n/// <reference path=\"_ko.kendo.js\" />\r\n/// <reference path=\"../kendo/js/kendo.pager.js\" />\r\n/// <reference path=\"../kendo/js/kendo.all.js\" />\r\n\r\n\r\n\r\n\r\nvar bespoke = bespoke || {};\r\nbespoke.utils = {};\r\n\r\nbespoke.utils.ServerPager = function (options) {\r\n    options = options || {};\r\n    var element = options.element,\r\n        count = options.count || 0,\r\n        changed = options.changed || function () {\r\n            console.log(\"no change event\");\r\n        },\r\n        self2 = this,\r\n        rows = _.range(count),\r\n        pagerDataSource = new kendo.data.DataSource({\r\n            data: rows,\r\n            pageSize: 20\r\n        });\r\n    if (options.hidden) {\r\n        return self2;\r\n    }\r\n\r\n    var pager = element.kendoPager({\r\n        dataSource: pagerDataSource,\r\n        /*messages: {\r\n            display: \"{0} - {1} of {2} rekod\",\r\n            empty: \"Tiada rekod\",\r\n            page: \"Muka\",\r\n            of: \"dari {0}\",\r\n            itemsPerPage: \"rekod setiap mukasurat\",\r\n            first: \"Pergi mukasurat pertama\",\r\n            previous: \"Pergi ke mukasurat belakang\",\r\n            next: \"Sergi mukasurat depan\",\r\n            last: \"Pergi mukasurat terakhir\",\r\n            refresh: \"Muat\"\r\n        },*/\r\n        pageSizes: [10, 20, 50]\r\n    }).data(\"kendoPager\");\r\n    pager.page(1);\r\n    pager.bind('change', function () {\r\n        if (changed) {\r\n            changed(pager.page(), pager.pageSize());\r\n        }\r\n    });\r\n\r\n    self2.update = function (count2) {\r\n        rows = [];\r\n        for (var j = 0; j < count2 ; j++) {\r\n            rows[j] = j;\r\n        }\r\n        setTimeout(function () {\r\n            pagerDataSource.data(rows);\r\n        }, 500);\r\n    };\r\n    self2.destroy = function () {\r\n        pager.destroy();\r\n        element.empty();\r\n    };\r\n\r\n    self2.pageSize = function (size) {\r\n        if (size) {\r\n            pager.pageSize(size);\r\n        }\r\n        return pager.pageSize();\r\n    };\r\n    self2.page = function (pg) {\r\n        if (pg) {\r\n            pager.page(pg);\r\n        }\r\n        return pager.page();\r\n    };\r\n\r\n    var dropdownlist = $(element).find('select').data(\"kendoDropDownList\");\r\n    dropdownlist.bind(\"change\", function () {\r\n        try {\r\n            changed(1, parseInt(this.value()));\r\n        } catch (e) {\r\n\r\n        }\r\n    });\r\n\r\n\r\n\r\n    return self2;\r\n\r\n};","/// <reference path=\"jstree.min.js\" />\r\n/// <reference path=\"jstree.min.js\" />\r\n/// <reference path=\"typeahead.bundle.js\" />\r\n/// <reference path=\"knockout-3.2.0.debug.js\" />\r\n/// <reference path=\"knockout.mapping-latest.debug.js\" />\r\n/// <reference path=\"../App/services/datacontext.js\" />\r\n/// <reference path=\"../SphApp/objectbuilders.js\" />\r\n/// <reference path=\"../App/durandal/amd/text.js\" />\r\n/// <reference path=\"jquery-2.1.1.intellisense.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"require.js\" />\r\n/// <reference path=\"C:\\project\\work\\sph\\source\\web\\core.sph\\SphApp/services/datacontext.js\" />\r\n\r\nko.bindingHandlers.activityClass = {\r\n    init: function (element, valueAccessor) {\r\n\r\n        var div = $(element),\r\n            act = ko.unwrap(valueAccessor()),\r\n        fullName = typeof act.$type === \"function\" ? act.$type() : act.$type,\r\n        name = /Bespoke\\.Sph\\.Domain\\.(.*?),/.exec(fullName)[1];\r\n\r\n        div.addClass(\"activity32\").addClass(\"activity32-\" + name);\r\n    }\r\n};\r\n\r\nko.bindingHandlers.checkedItems = {\r\n    init: function (element, valueAccessor) {\r\n        var item = ko.dataFor(element),\r\n            list = valueAccessor();\r\n\r\n        $(element).change(function () {\r\n            var checked = $(this).is(':checked');\r\n            if (checked) {\r\n                list.push(item);\r\n            } else {\r\n                list.remove(item);\r\n            }\r\n        });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.wdTypeaheadPath = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            instance = ko.unwrap(valueAccessor()),\r\n            setup = function () {\r\n\r\n                var wd = ko.mapping.toJS(instance);\r\n                var input = $(element),\r\n                         div = $('<div></div>').css({\r\n                             'height': '28px'\r\n                         });\r\n                input.hide().before(div);\r\n\r\n                var c = completely(div[0], {\r\n                    fontSize: '12px',\r\n                    color: '#555;',\r\n                    fontFamily: '\"Open Sans\", Arial, Helvetica, sans-serif'\r\n                });\r\n\r\n                c.setText(ko.unwrap(allBindings.value));\r\n                for (var ix in wd) {\r\n                    if (ix === \"$type\") continue;\r\n                    if (ix === \"addChildItem\") continue;\r\n                    if (ix === \"removeChildItem\") continue;\r\n                    c.options.push(\"\" + ix);\r\n                }\r\n                c.options.sort();\r\n\r\n                var currentObject = wd;\r\n                c.onChange = function (text) {\r\n                    if (text.lastIndexOf(\".\") === text.length - 1) {\r\n                        c.options = [];\r\n                        var props = text.split(\".\");\r\n\r\n                        currentObject = wd;\r\n                        _(props).each(function (v) {\r\n                            if (v === \"\") { return; }\r\n                            currentObject = currentObject[v];\r\n                        });\r\n                        console.log(\"currentObject\", currentObject);\r\n                        for (var i in currentObject) {\r\n                            if (i === \"$type\") continue;\r\n                            if (i === \"addChildItem\") continue;\r\n                            if (i === \"removeChildItem\") continue;\r\n                            c.options.push(\"\" + i);\r\n                        }\r\n                        c.options.sort();\r\n                        c.startFrom = text.lastIndexOf(\".\") + 1;\r\n                    }\r\n                    c.repaint();\r\n                };\r\n\r\n                c.repaint();\r\n                $(c.input)\r\n                    .attr(\"autocomplete\", \"off\")\r\n                    .blur(function () {\r\n                        allBindings.value($(this).val());\r\n                    }).parent().find('input')\r\n                    .css({ \"padding\": \"6px 12px\", \"height\": \"28px\" });\r\n\r\n                if ($(element).prop(\"required\")) {\r\n                    $(c.input).prop(\"required\", true);\r\n                }\r\n\r\n\r\n            };\r\n\r\n\r\n        if (typeof value === \"function\" && typeof value.subscribe === \"function\") {\r\n            value.subscribe(function () {\r\n                $(element).typeahead(\"destroy\");\r\n                setup();\r\n            });\r\n        }\r\n        setup();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.activityPopover = {\r\n    init: function (element, valueAccessor) {\r\n\r\n        var div = $(element),\r\n            act = ko.unwrap(valueAccessor()),\r\n            fullName = typeof act.$type === \"function\" ? act.$type() : act.$type,\r\n            name = /Bespoke\\.Sph\\.Domain\\.(.*?),/.exec(fullName)[1],\r\n            wd = ko.dataFor(div.parent()[0]).wd(),\r\n            pop = div.popover({\r\n                title: name + ' : ' + act.Name(),\r\n                html: true,\r\n                content: function () {\r\n                    $('a.edit-activity').popover('hide');\r\n                    div.find(\"a.edit-activity\").addClass(act.WebId());\r\n                    div.find(\"a.delete-activity\").addClass(act.WebId());\r\n                    div.find(\"a.start-activity\").addClass(act.WebId());\r\n                    return div.find(\"div.context-menu\").html();\r\n                }\r\n            });\r\n\r\n        // just display it for 5 seconds\r\n        pop.on('shown.bs.popover', function () {\r\n            setTimeout(function () { pop.popover('hide'); }, 5000);\r\n        });\r\n\r\n        $(document).on('click', 'a.' + act.WebId(), function (e) {\r\n            e.preventDefault();\r\n            var app = require(objectbuilders.app),\r\n                link = $(this);\r\n            if (link.hasClass(\"delete-activity\")) {\r\n                app.showMessage(\"Are you sure you want to remove this Activity\", \"Remove activity\", [\"Yes\", \"No\"])\r\n                    .done(function (result) {\r\n                        if (result === \"Yes\") {\r\n                            wd.removeActivity(act)();\r\n                        }\r\n                    });\r\n            }\r\n            if (link.hasClass(\"edit-activity\")) {\r\n                wd.editActivity(act)();\r\n            }\r\n            if (link.hasClass(\"start-activity\")) {\r\n                wd.setStartActivity(act)();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.comboBoxLookupOptions = {\r\n    init: function (element, valueAccessor) {\r\n        var $select = $(element),\r\n            lookup = ko.unwrap(valueAccessor()),\r\n            value = lookup.value,\r\n            caption = lookup.caption,\r\n            context = require('services/datacontext');\r\n\r\n        var setup = function(query) {\r\n            context.getTuplesAsync({\r\n                    entity: ko.unwrap(lookup.entity),\r\n                    query: query,\r\n                    field: ko.unwrap(lookup.valuePath),\r\n                    field2: ko.unwrap(lookup.displayPath)\r\n\r\n                })\r\n                .done(function(list) {\r\n                    element.options.length = 0;\r\n                    if (caption) {\r\n                        element.add(new Option(caption, \"\"));\r\n                    }\r\n                    _(list).each(function(v) {\r\n                        element.add(new Option(v.Item2, v.Item1));\r\n                    });\r\n\r\n                    $select.val(ko.unwrap(value))\r\n                        .on('change', function() {\r\n                            value($select.val());\r\n                        });\r\n\r\n                });\r\n        };\r\n        setup(ko.unwrap(lookup.query));\r\n\r\n        if (typeof lookup.query === \"function\") {\r\n            if (typeof lookup.query.subscribe === \"function\") {\r\n                lookup.query.subscribe(function(v) {\r\n                    setup(ko.unwrap(v));\r\n                });\r\n            }\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var lookup = ko.unwrap(valueAccessor()),\r\n            value = lookup.value;\r\n        $(element).val(ko.unwrap(value));\r\n    }\r\n};\r\n\r\n","ko.bindingHandlers.solutiontree = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            solution = ko.unwrap(value.solution),\r\n            click = value.click,\r\n            addEntityDefinition = value.addEntityDefinition,\r\n            addForm = value.addForm,\r\n            addOperation = value.addOperation,\r\n            addView = value.addView;\r\n\r\n        var eds = [];\r\n        var treeRoots = [\r\n            { \"id\": \"EntityDefinition\", \"parent\": \"#\", \"text\": \"Entity Definitions\", icon: \"fa fa-file\", data: { TypeName: \"#\" } },\r\n            { \"id\": \"WorkflowDefinition\", \"parent\": \"#\", \"text\": \"Workflow Definitions\", icon: \"fa fa-file\", data: { TypeName: \"#\" } },\r\n            { \"id\": \"TransformDefinition\", \"parent\": \"#\", \"text\": \"Transform Definitions\", icon: \"fa fa-file\", data: { TypeName: \"#\" } },\r\n            { \"id\": \"Adapter\", \"parent\": \"#\", \"text\": \"Adapters\", icon: \"fa fa-file\", data: { TypeName: \"#\" } },\r\n            { \"id\": \"Trigger\", \"parent\": \"#\", \"text\": \"Triggers\", icon: \"fa fa-file\", data: { TypeName: \"#\" } }\r\n        ];\r\n\r\n        _.each(solution.ProjectMetadataCollection(), function (pmd) {\r\n            eds.push({\r\n                id: ko.unwrap(pmd.Id),\r\n                text: ko.unwrap(pmd.Name),\r\n                parent: \"EntityDefinition\",\r\n                icon: \"fa fa-clipboard\"\r\n            });\r\n\r\n            _.each(pmd.ChildItemCollection(), function (child) {\r\n                var icon = \"\";\r\n\r\n                switch (ko.unwrap(child.TypeName)) {\r\n                    case \"EntityForm\":\r\n                        icon = \"fa fa-edit\";\r\n                        break;\r\n                    case \"EntityOperation\":\r\n                        icon = \"fa fa-gavel\";\r\n                        break;\r\n                    case \"EntityView\":\r\n                        icon = \"fa fa-table\";\r\n                        break;\r\n                    case \"BusinessRule\":\r\n                        icon = \"fa fa-bold\";\r\n                        break;\r\n                }\r\n\r\n\r\n                eds.push({\r\n                    id: ko.unwrap(child.Id),\r\n                    parentId: ko.unwrap(child.ParentId),\r\n                    text: ko.unwrap(child.Name),\r\n                    parent: ko.unwrap(pmd.Id),\r\n                    icon: ko.unwrap(icon),\r\n                    data: child\r\n\r\n                });\r\n            });\r\n\r\n        });\r\n\r\n        $(\"#jstree_demo_div\").jstree({\r\n            'core': {\r\n                'data': treeRoots.concat(eds)\r\n            },\r\n            \"plugins\": [\"contextmenu\", \"search\"],\r\n            \"contextmenu\": {\r\n                \"items\": function (node) {\r\n\r\n                    if (node.id === \"EntityDefinition\") {\r\n                        return {\r\n                            \"Create\": {\r\n                                \"label\": \"Add New Entity\",\r\n                                \"action\": function (obj) {\r\n                                    //this.create(obj);\r\n                                    addEntityDefinition();\r\n                                }\r\n                            }\r\n                        };\r\n                    } else if (node.id === \"WorkflowDefinition\") {\r\n                        return {\r\n                            \"Create\": {\r\n                                \"label\": \"Add New Workflow Definition\",\r\n                                \"action\": function (obj) {\r\n                                    addWorkflowDefinition();\r\n                                }\r\n                            }\r\n                        };\r\n                    } else if (node.id === \"TransformDefinition\") {\r\n                        return {\r\n                            \"Create\": {\r\n                                \"label\": \"Add New Transform Definition\",\r\n                                \"action\": function (obj) {\r\n                                    addTransformDefinition();\r\n                                }\r\n                            }\r\n                        };\r\n                    } else if (node.id === \"Adapter\") {\r\n                        return {\r\n                            \"Create\": {\r\n                                \"label\": \"Add New Adapter\",\r\n                                \"action\": function (obj) {\r\n                                    addAdapter();\r\n                                }\r\n                            }\r\n                        };\r\n                    } else if (node.id === \"Trigger\") {\r\n                        return {\r\n                            \"Create\": {\r\n                                \"label\": \"Add New Trigger\",\r\n                                \"action\": function (obj) {\r\n                                    addTrigger();\r\n                                }\r\n                            }\r\n                        };\r\n                    } else if (node.parent === \"EntityDefinition\") {\r\n                        return {\r\n                            \"Create Form\": {\r\n                                \"label\": \"Add New Form\",\r\n                                \"action\": function (obj) {\r\n                                    addForm(node.id);\r\n                                }\r\n                            },\r\n                            \"Create Views\": {\r\n                                \"label\": \"Add New View\",\r\n                                \"action\": function (obj) {\r\n                                    addView(node.id);\r\n                                }\r\n                            },\r\n                            \"Create Operation\": {\r\n                                \"label\": \"Add New Operation\",\r\n                                \"action\": function (obj) {\r\n                                    addOperation(node.id);\r\n                                }\r\n                            }\r\n                        };\r\n                    }\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n        $(\"#jstree_demo_div\").on(\"select_node.jstree\", click);\r\n\r\n\r\n\r\n    }\r\n};\r\nko.bindingHandlers.tree = {\r\n    init: function (element, valueAccessor) {\r\n        var system = require(objectbuilders.system),\r\n            value = valueAccessor(),\r\n            entity = ko.unwrap(value.entity),\r\n            searchbox = ko.unwrap(value.searchbox),\r\n            member = value.selected,\r\n            jsTreeData = {\r\n                text: entity.Name(),\r\n                state: {\r\n                    opened: true,\r\n                    selected: true\r\n                }\r\n            },\r\n            recurseChildMember = function (node) {\r\n                node.children = _(node.data.MemberCollection()).map(function (v) {\r\n                    return {\r\n                        text: v.Name(),\r\n                        state: \"open\",\r\n                        type: v.TypeName(),\r\n                        data: v\r\n                    };\r\n                });\r\n                _(node.children).each(recurseChildMember);\r\n            },\r\n            loadJsTree = function () {\r\n                jsTreeData.children = _(entity.MemberCollection()).map(function (v) {\r\n                    return {\r\n                        text: v.Name(),\r\n                        state: \"open\",\r\n                        type: v.TypeName(),\r\n                        data: v\r\n                    };\r\n                });\r\n                _(jsTreeData.children).each(recurseChildMember);\r\n                $(element)\r\n                    .on(\"select_node.jstree\", function (node, selected) {\r\n                        if (selected.node.data) {\r\n                            member(selected.node.data);\r\n\r\n                            // subscribe to Name change\r\n                            member().Name.subscribe(function (name) {\r\n                                $(element).jstree(true)\r\n                                    .rename_node(selected.node, name);\r\n                            });\r\n                            // type\r\n                            member().TypeName.subscribe(function (name) {\r\n                                $(element).jstree(true)\r\n                                    .set_type(selected.node, name);\r\n                            });\r\n                        }\r\n                    })\r\n                    .on(\"create_node.jstree\", function (event, node) {\r\n                        console.log(node, \"node\");\r\n                    })\r\n                    .on(\"rename_node.jstree\", function (ev, node) {\r\n                        var mb = node.node.data;\r\n                        mb.Name(node.text);\r\n                    })\r\n                    .jstree({\r\n                        \"core\": {\r\n                            \"animation\": 0,\r\n                            \"check_callback\": true,\r\n                            \"themes\": { \"stripes\": true },\r\n                            'data': jsTreeData\r\n                        },\r\n                        \"contextmenu\": {\r\n                            \"items\": [\r\n                                {\r\n                                    label: \"Add Child\",\r\n                                    action: function () {\r\n                                        var child = new bespoke.sph.domain.Member({ WebId: system.guid(), TypeName: 'System.String, mscorlib', Name: 'Member_Name' }),\r\n                                            parent = $(element).jstree('get_selected', true),\r\n                                            mb = parent[0].data,\r\n                                            newNode = { state: \"open\", type: \"System.String, mscorlib\", text: 'Member_Name', data: child };\r\n\r\n                                        var ref = $(element).jstree(true),\r\n                                            sel = ref.get_selected();\r\n                                        if (!sel.length) {\r\n                                            return false;\r\n                                        }\r\n                                        sel = sel[0];\r\n                                        sel = ref.create_node(sel, newNode);\r\n                                        if (sel) {\r\n                                            ref.edit(sel);\r\n                                            if (mb && mb.MemberCollection) {\r\n                                                mb.MemberCollection.push(child);\r\n                                            } else {\r\n                                                entity.MemberCollection.push(child);\r\n                                            }\r\n                                            return true;\r\n                                        }\r\n                                        return false;\r\n\r\n\r\n                                    }\r\n                                },\r\n                                {\r\n                                    label: \"Remove\",\r\n                                    action: function () {\r\n                                        var ref = $(element).jstree(true),\r\n                                            sel = ref.get_selected();\r\n\r\n                                        // now delete the member\r\n                                        var n = ref.get_selected(true)[0],\r\n                                            p = ref.get_node($('#' + n.parent)),\r\n                                            parentMember = p.data;\r\n                                        if (parentMember && typeof parentMember.MemberCollection === \"function\") {\r\n                                            var child = _(parentMember.MemberCollection()).find(function (v) {\r\n                                                return v.WebId() === n.data.WebId();\r\n                                            });\r\n                                            parentMember.MemberCollection.remove(child);\r\n                                        } else {\r\n                                            var child2 = _(entity.MemberCollection()).find(function (v) {\r\n                                                return v.WebId() === n.data.WebId();\r\n                                            });\r\n                                            entity.MemberCollection.remove(child2);\r\n                                        }\r\n\r\n                                        if (!sel.length) {\r\n                                            return false;\r\n                                        }\r\n                                        ref.delete_node(sel);\r\n\r\n                                        return true;\r\n\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        \"types\": {\r\n\r\n                            \"System.String, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-bold\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.DateTime, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-calendar\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Int32, mscorlib\": {\r\n                                \"icon\": \"fa fa-sort-numeric-asc\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Decimal, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-usd\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Boolean, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-ok\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Object, mscorlib\": {\r\n                                \"icon\": \"fa fa-building-o\"\r\n                            },\r\n                            \"System.Array, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-list\"\r\n                            }\r\n                        },\r\n                        \"plugins\": [\"contextmenu\", \"dnd\", \"types\", \"search\"]\r\n                    });\r\n            };\r\n        loadJsTree();\r\n\r\n        var to = false;\r\n        $(searchbox).keyup(function () {\r\n            if (to) {\r\n                clearTimeout(to);\r\n            }\r\n            to = setTimeout(function () {\r\n                var v = $(searchbox).val();\r\n                $(element).jstree(true).search(v);\r\n            }, 250);\r\n        });\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.help = {\r\n    init: function (element, valueAccessor) {\r\n        var link = $(element),\r\n            href = ko.unwrap(valueAccessor());\r\n        link.click(function (e) {\r\n            e.preventDefault();\r\n            window.open(\"/docs/#\" + href);\r\n        });\r\n    }\r\n};\r\nvar substringMatcher = function (strs) {\r\n    return function findMatches(q, cb) {\r\n        var matches, substringRegex;\r\n\r\n        // an array that will be populated with substring matches\r\n        matches = [];\r\n        // regex used to determine if a string contains the substring `q`\r\n        substringRegex = new RegExp(q, 'i');\r\n\r\n        // iterate through the pool of strings and for any string that\r\n        // contains the substring `q`, add it to the `matches` array\r\n        $.each(strs, function (i, str) {\r\n            if (substringRegex.test(str)) {\r\n                // the typeahead jQuery plugin expects suggestions to a\r\n                // JavaScript object, refer to typeahead docs for more info\r\n                matches.push({ value: str });\r\n            }\r\n        });\r\n\r\n        cb(matches);\r\n    };\r\n};\r\n\r\n\r\nko.bindingHandlers.typeaheadUrl = {\r\n    init: function (element, valueAccessor) {\r\n        var types = ko.unwrap(valueAccessor()),\r\n            ttl = 300000,\r\n            url = String.format(\"/list?table={0}&column={1}\", types[0], \"Route\"),\r\n            suggestions = new Bloodhound({\r\n                datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name'),\r\n                queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n                limit: 10,\r\n                remote: {\r\n                    url: url,\r\n                    tt1: ttl,\r\n                    filter: function (list) {\r\n                        return _(list).map(function (v) {\r\n                            return { name: v };\r\n                        });\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n        suggestions.initialize();\r\n        $(element).typeahead(null,\r\n            {\r\n                name: 'EntityView_' + $(element).prop(\"id\"),\r\n                displayKey: \"name\",\r\n                source: suggestions.ttAdapter()\r\n            });\r\n    }\r\n};\r\nko.bindingHandlers.entityTypeaheadPath = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            context = require(objectbuilders.datacontext),\r\n            config = require(objectbuilders.config),\r\n            allBindings = allBindingsAccessor(),\r\n            idOrName = ko.unwrap(valueAccessor()) || window.typeaheadEntity,\r\n            setup = function (options) {\r\n\r\n                var name = options.name || options,\r\n                    eid = options.id || options;\r\n\r\n                var ed = ko.toJS(bespoke[config.applicationName + \"_\" + eid.toLowerCase()].domain[name]());\r\n                var input = $(element),\r\n                         div = $('<div></div>').css({\r\n                             'height': '28px'\r\n                         });\r\n                input.hide().before(div);\r\n\r\n                var c = completely(div[0], {\r\n                    fontSize: '12px',\r\n                    color: '#555;',\r\n                    fontFamily: '\"Open Sans\", Arial, Helvetica, sans-serif'\r\n                });\r\n\r\n                c.setText(ko.unwrap(allBindings.value));\r\n                for (var ix in ed) {\r\n                    if (ix === \"$type\") continue;\r\n                    if (ix === \"addChildItem\") continue;\r\n                    if (ix === \"removeChildItem\") continue;\r\n                    c.options.push('' + ix);\r\n                }\r\n                c.options.sort();\r\n\r\n                var currentObject = ed;\r\n                c.onChange = function (text) {\r\n                    if (text.lastIndexOf(\".\") === text.length - 1) {\r\n                        c.options = [];\r\n                        var props = text.split(\".\");\r\n\r\n                        currentObject = ed;\r\n                        _(props).each(function (v) {\r\n                            if (v === \"\") { return; }\r\n                            currentObject = currentObject[v];\r\n                        });\r\n                        console.log(\"currentObject\", currentObject);\r\n                        for (var i in currentObject) {\r\n                            if (i === \"$type\") continue;\r\n                            if (i === \"addChildItem\") continue;\r\n                            if (i === \"removeChildItem\") continue;\r\n                            c.options.push(\"\" + i);\r\n                        }\r\n                        c.options.sort();\r\n                        c.startFrom = text.lastIndexOf(\".\") + 1;\r\n                    }\r\n                    c.repaint();\r\n                };\r\n\r\n                c.repaint();\r\n                $(c.input)\r\n                    .attr(\"autocomplete\", \"off\")\r\n                    .blur(function () {\r\n                        allBindings.value($(this).val());\r\n                    }).parent().find(\"input\")\r\n                    .css({ \"padding\": \"6px 12px\", \"height\": \"28px\" });\r\n\r\n                if ($(element).prop(\"required\")) {\r\n                    $(c.input).prop(\"required\", true);\r\n                }\r\n\r\n\r\n            };\r\n\r\n\r\n        if (idOrName) {\r\n            context.loadOneAsync(\"EntityDefinition\", \"Name eq '\" + idOrName + \"' OR id eq '\" + idOrName + \"'\", \"Id\")\r\n                .done(function (edf) {\r\n                    setup({ name: edf.Name(), id: edf.Id() });\r\n                });\r\n\r\n        }\r\n\r\n\r\n        if (typeof value === \"function\" && typeof value.subscribe === \"function\") {\r\n            value.subscribe(function (entity) {\r\n                $(element).typeahead(\"destroy\");\r\n                setup(entity);\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.cssTypeahead = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var allBindings = allBindingsAccessor(),\r\n            results = [\"fa\", \"fa-user\", \"fa-user-o\"],\r\n            extractor = function (query) {\r\n                var result = /([^,]+)$/.exec(query);\r\n                if (result && result[1])\r\n                    return result[1].trim();\r\n                return '';\r\n            },\r\n            paths = _(results).map(function (v) {\r\n                return { path: v };\r\n            }),\r\n            members = new Bloodhound({\r\n                datumTokenizer: function (d) {\r\n                    return d.path.split(/s+/);\r\n                },\r\n                queryTokenizer: function (s) {\r\n                    return s.split(/\\./);\r\n                },\r\n                local: paths\r\n            });\r\n        members.initialize();\r\n\r\n        $(element).typeahead({\r\n            minLength: 0,\r\n            highlight: true,\r\n            updater: function () {\r\n                return this.$element.val().replace(/[^,]*$/, \"\") + item + \",\";\r\n            },\r\n            matcher: function (item) {\r\n                var tquery = extractor(this.query);\r\n                if (!tquery) return false;\r\n                return ~item.toLowerCase().indexOf(tquery.toLowerCase());\r\n            }\r\n        },\r\n            {\r\n                name: \"css-class\",\r\n                displayKey: \"path\",\r\n                source: members.ttAdapter()\r\n            })\r\n            .on(\"typeahead:closed\", function () {\r\n                allBindings.value($(this).val());\r\n            });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.chart = {\r\n    init: function (element, valueAccessor) {\r\n        var chart = ko.unwrap(valueAccessor()),\r\n            context = require(\"services/datacontext\"),\r\n            entity = chart.Entity(),\r\n            query = JSON.parse(chart.Query()),\r\n            type = chart.Type(),\r\n            tcs = new $.Deferred(),\r\n            name = chart.Name();\r\n\r\n\r\n        context.searchAsync(entity, query)\r\n            .done(function (result) {\r\n\r\n                var buckets = result.aggregations.category.buckets || result.aggregations.category,\r\n                    data = _(buckets).map(function (v) {\r\n                        return {\r\n                            category: v.key_as_string || v.key.toString(),\r\n                            value: v.doc_count\r\n                        };\r\n                    }),\r\n                    categories = _(buckets).map(function (v) {\r\n                        return v.key_as_string || v.key.toString();\r\n                    }),\r\n                    kendoChart = $(element).kendoChart({\r\n                        theme: \"metro\",\r\n                        chartArea: {\r\n                            background: \"\"\r\n                        },\r\n                        title: {\r\n                            text: name\r\n                        },\r\n                        legend: {\r\n                            position: \"bottom\"\r\n                        },\r\n                        seriesDefaults: {\r\n                            labels: {\r\n                                visible: true,\r\n                                format: \"{0}\",\r\n                                background: \"transparent\",\r\n                                template: \"#= category #: #= value#\"\r\n                            }\r\n                        },\r\n                        series: [\r\n                            {\r\n                                type: type,\r\n                                data: data\r\n                            }\r\n                        ],\r\n                        categoryAxis: {\r\n                            categories: categories,\r\n                            majorGridLines: {\r\n                                visible: false\r\n                            }\r\n                        },\r\n                        tooltip: {\r\n                            visible: true,\r\n                            format: \"{0}\",\r\n                            template: \"#= category #: #= value #\"\r\n                        }\r\n                    }).data(\"kendoChart\");\r\n                tcs.resolve(true);\r\n\r\n                context.getScalarAsync(\"EntityView\", \"Id eq '\" + chart.EntityViewId() + \"'\", \"Name\")\r\n                    .done(function (viewName) {\r\n                        kendoChart.options.title.text = name + \" (\" + viewName + \")\";\r\n                        kendoChart.refresh();\r\n                    });\r\n\r\n            });\r\n\r\n\r\n        return tcs.promise();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.iconPicker = {\r\n    init: function (element, valueAccessor) {\r\n        var $input = $(element),\r\n            value = valueAccessor(),\r\n            $picker = $('<a href=\"#\" class=\"btn btn-link\">Pick Icon</a>');\r\n\r\n        $input.parent().append($picker);\r\n        $picker.click(function (e) {\r\n            e.preventDefault();\r\n            require(['viewmodels/icon.picker', 'durandal/app'], function (dialog, app2) {\r\n                app2.showDialog(dialog)\r\n                    .done(function (result) {\r\n                        if (result === \"OK\") {\r\n                            value(dialog.icon());\r\n                            $input.val(dialog.icon());\r\n                        }\r\n                    });\r\n\r\n            });\r\n        });\r\n\r\n    }\r\n};\r\n\r\nvar bespoke = bespoke || {};\r\nbespoke.observableArray = bespoke.observableArray || {};\r\n\r\nbespoke.getSingletonObservableArray = function (key) {\r\n    if (bespoke.observableArray[key]) {\r\n        return bespoke.observableArray[key];\r\n    }\r\n\r\n    bespoke.observableArray[key] = ko.observableArray();\r\n    return bespoke.observableArray[key];\r\n};\r\n\r\n\r\nko.bindingHandlers.lookup = {\r\n    init: function (element, valueAccessor) {\r\n        var $link = $(element),\r\n            options = valueAccessor(),\r\n            member = ko.unwrap(options.member);\r\n\r\n        $link.click(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            require(['viewmodels/entity.lookup.dialog', 'durandal/app'], function (dialog, app2) {\r\n                dialog.options(options);\r\n                app2.showDialog(dialog)\r\n                    .done(function (result) {\r\n                        if (!result) return;\r\n                        if (result === \"OK\") {\r\n                            var item = dialog.selected();\r\n                            options.value(item[member]);\r\n                        }\r\n                    });\r\n\r\n            });\r\n\r\n        });\r\n    }\r\n};\r\nko.virtualElements.allowedBindings.lookupText = true;\r\nbespoke.lookupText = function (element, valueAccessor) {\r\n    var options = valueAccessor(),\r\n        entity = ko.unwrap(options.entity),\r\n        displayPath = ko.unwrap(options.displayPath),\r\n        valuePath = ko.unwrap(options.valuePath),\r\n        val = ko.unwrap(options.value),\r\n        context = require('services/datacontext'),\r\n        setTextContent = function (ele, textContent) {\r\n            var value = ko.utils.unwrapObservable(textContent);\r\n            if ((value === null) || (value === undefined))\r\n                value = \"\";\r\n            var innerTextNode = ko.virtualElements.firstChild(ele);\r\n            if (!innerTextNode || innerTextNode.nodeType !== 3 || ko.virtualElements.nextSibling(innerTextNode)) {\r\n                ko.virtualElements.setDomNodeChildren(ele, [ele.ownerDocument.createTextNode(value)]);\r\n            } else {\r\n                innerTextNode.data = value;\r\n            }\r\n\r\n        };\r\n\r\n    context.getScalarAsync(entity, valuePath + \" eq '\" + val + \"'\", displayPath)\r\n    .done(function (text) {\r\n        setTextContent(element, text);\r\n        console.log(text);\r\n    });\r\n};\r\nko.bindingHandlers.lookupText = {\r\n    init: bespoke.lookupText,\r\n    update: bespoke.lookupText\r\n};\r\n\r\n\r\nko.bindingHandlers.readonly = {\r\n    init: function (element, valueAccessor) {\r\n        var input = $(element),\r\n            ro = ko.unwrap(valueAccessor());\r\n\r\n        if (ro) {\r\n            input.prop('readonly', true);\r\n        } else {\r\n\r\n            input.prop('readonly', false);\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var input = $(element),\r\n             ro = ko.unwrap(valueAccessor());\r\n\r\n        if (ro) {\r\n            input.prop('readonly', true);\r\n        } else {\r\n\r\n            input.prop('readonly', false);\r\n        }\r\n    }\r\n};","/// <reference path=\"knockout-3.2.0.debug.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"~/Scripts/jquery-2.1.1.intellisense.js\" />\r\n/// <reference path=\"~/Scripts/require.js\" />\r\n/// <reference path=\"~/kendo/js/kendo.all.js\" />\r\n/// <reference path=\"_pager.js\" />\r\n/// <reference path=\"/SphApp/services/datacontext.js\" />\r\n/// <reference path=\"/SphApp/objectbuilders.js\" />\r\n\r\n\r\n\r\nko.bindingHandlers.kendoEditor = {\r\n    init: function (element, valueAccessor) {\r\n        var $editor = $(element),\r\n            value = valueAccessor(),\r\n            updating = false;\r\n\r\n        setTimeout(function () {\r\n            var editor = $editor.kendoEditor({\r\n                change: function () {\r\n                    if (updating) return;\r\n                    updating = true;\r\n                    value(this.value());\r\n                    setTimeout(function () { updating = false; }, 500);\r\n                }\r\n            }).data(\"kendoEditor\");\r\n\r\n            editor.value(value());\r\n\r\n            value.subscribe(function (html) {\r\n                if (updating) return;\r\n                updating = true;\r\n                editor.value(html);\r\n                setTimeout(function () { updating = false; }, 500);\r\n            });\r\n\r\n        }, 500);\r\n\r\n\r\n    },\r\n    update2: function (element, valueAccessor) {\r\n        var $editor = $(element),\r\n            value = valueAccessor(),\r\n            ke = $editor.data(\"kendoEditor\");\r\n        if (!$editor.data(\"updating\")) {\r\n            ke.value(value());\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.kendoDropDownListValue = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var currentModelValue = ko.utils.unwrapObservable(value);\r\n        var dd = $(element).data('kendoDropDownList');\r\n        dd.value(currentModelValue);\r\n\r\n        dd.bind(\"change\", function () {\r\n            var nv = dd.value();\r\n            value(nv);\r\n        });\r\n    },\r\n\r\n    update: function (element, valueAccessor) {\r\n        //update value based on a model change\r\n        var value = valueAccessor();\r\n        var modelValue = ko.utils.unwrapObservable(value);\r\n\r\n        if (modelValue) {\r\n            $(element).data('kendoDropDownList').value(modelValue);\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.source = {\r\n};\r\nko.bindingHandlers.kendoComboBox = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            currentModelValue = ko.utils.unwrapObservable(value),\r\n            dd = $(element).data('kendoComboBox') ||\r\n                $(element).kendoComboBox({\r\n                    dataSource: allBindings.source()\r\n                }).data('kendoComboBox');\r\n\r\n        dd.value(currentModelValue);\r\n        allBindings.source.subscribe(function (options) {\r\n            // console.log(options, dd);\r\n            dd.dataSource.data(options);\r\n        });\r\n        dd.bind(\"change\", function () {\r\n            var nv = dd.value();\r\n            value(nv);\r\n        });\r\n    },\r\n\r\n    update: function (element, valueAccessor) {\r\n        //update value based on a model change\r\n        var value = valueAccessor();\r\n        var modelValue = ko.utils.unwrapObservable(value);\r\n\r\n        if (modelValue) {\r\n            $(element).data('kendoComboBox').value(modelValue);\r\n        }\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.decimal = {};\r\nko.bindingHandlers.money = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            decimal = function () {\r\n                if (typeof allBindings.decimal === \"undefined\") {\r\n                    return 2;\r\n                }\r\n                return parseInt(allBindings.decimal);\r\n            },\r\n            textbox = $(element),\r\n            val = parseFloat(ko.unwrap(value) || \"0\"),\r\n            fm = val.toFixed(decimal()).replace(/./g, function (c, i, a) {\r\n                return i && c !== \".\" && !((a.length - i) % 3) ? ',' + c : c;\r\n            });\r\n\r\n\r\n        if (element.tagName.toLowerCase() === \"span\") {\r\n            textbox.text(fm);\r\n            return;\r\n        }\r\n\r\n        textbox.val(fm);\r\n\r\n        textbox.on('blur', function () {\r\n            var tv = $(this).val().replace(/,/g, \"\");\r\n            console.log(tv);\r\n            value(parseFloat(tv));\r\n        });\r\n\r\n    },\r\n    update: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            decimal = function () {\r\n                if (typeof allBindings.decimal === \"undefined\") {\r\n                    return 2;\r\n                }\r\n                return parseInt(allBindings.decimal);\r\n            },\r\n             textbox = $(element),\r\n             val = parseFloat(ko.unwrap(value) || \"0\"),\r\n             fm = val.toFixed(decimal()).replace(/./g, function (c, i, a) {\r\n                 return i && c !== \".\" && !((a.length - i) % 3) ? ',' + c : c;\r\n             });\r\n\r\n        textbox.val(fm);\r\n\r\n    }\r\n};\r\n\r\n///user moment format\r\nko.bindingHandlers.date = {\r\n    init: function (element, valueAccessor) {\r\n        var value = ko.utils.unwrapObservable(valueAccessor()),\r\n            dv = ko.unwrap(value.value),\r\n            inputFormat = ko.unwrap(value.inputFormat) || 'YYYY-MM-DD',\r\n            date = moment(dv, inputFormat),\r\n            invalid = ko.unwrap(value.invalid) || 'invalid date',\r\n            format = ko.unwrap(value.format) || \"DD/MM/YYYY\";\r\n\r\n        if (!value.format && typeof ko.unwrap(value) === \"string\") {\r\n            dv = ko.unwrap(value);\r\n            date = moment(dv);\r\n        }\r\n\r\n        $(element).on(\"change\", function () {\r\n            var nv = $(this).val();\r\n            value.value(nv);\r\n        });\r\n        if (!dv) {\r\n            $(element).text(invalid);\r\n            $(element).val(invalid);\r\n            return;\r\n        }\r\n        if (!date) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n        if (date.year() == 1) { // DateTime.Min\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n\r\n        var dateString = date.format(format).toString();\r\n        if (dateString.indexOf(\"NaN\") < 0) {\r\n            $(element).text(dateString);\r\n            $(element).val(dateString);\r\n        }\r\n\r\n\r\n\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = ko.utils.unwrapObservable(valueAccessor()),\r\n            dv = ko.unwrap(value.value),\r\n            inputFormat = ko.unwrap(value.inputFormat) || 'YYYY-MM-DD',\r\n            date = moment(dv, inputFormat),\r\n            invalid = ko.unwrap(value.invalid) || 'invalid date',\r\n            format = ko.unwrap(value.format) || \"DD/MM/YYYY\";\r\n\r\n        if (!value.format && typeof ko.unwrap(value) === \"string\") {\r\n            dv = ko.unwrap(value);\r\n            date = moment(dv);\r\n        }\r\n\r\n        $(element).on(\"change\", function () {\r\n            var nv = $(this).val();\r\n            value.value(nv);\r\n        });\r\n        if (!dv) {\r\n            $(element).text(invalid);\r\n            $(element).val(invalid);\r\n            return;\r\n        }\r\n        if (!date) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n        if (date.year() == 1) { // DateTime.Min\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n\r\n        var dateString = date.format(format).toString();\r\n        if (dateString.indexOf(\"NaN\") < 0) {\r\n            $(element).text(dateString);\r\n            $(element).val(dateString);\r\n        }\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.kendoUpload = {\r\n    init: function (element, valueAccessor) {\r\n        var context = require(objectbuilders.datacontext),\r\n             logger = require(objectbuilders.logger),\r\n             value = valueAccessor(),\r\n             options = valueAccessor(),\r\n                 extensions = [];\r\n        if (typeof options === \"object\") {\r\n            value = options.value;\r\n            extensions = options.extensions;\r\n        }\r\n\r\n        $(element).attr(\"name\", \"files\").kendoUpload({\r\n            async: {\r\n                saveUrl: \"/BinaryStore/Upload\",\r\n                removeUrl: \"/BinaryStore/Remove\",\r\n                autoUpload: true\r\n            },\r\n            multiple: false,\r\n            error: function (e) {\r\n                logger.logError(e, e, this, true);\r\n            },\r\n            select: function (e) {\r\n                if (extensions.length === 0) {\r\n                    return;\r\n                }\r\n                _(e.files).each(function (v) {\r\n                    if (extensions.indexOf(v.extension) < 0) {\r\n                        logger.error(\"Only \" + extensions.join(\",\") + \" files can be uploaded\");\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            },\r\n            success: function (e) {\r\n                logger.info('Your file has been ' + e.operation);\r\n\r\n                var storeId = e.response.storeId,\r\n                    uploaded = e.operation === \"upload\",\r\n                    removed = e.operation != \"upload\",\r\n                    oldFile = value();\r\n                if (uploaded) {\r\n                    value(storeId);\r\n                    if (oldFile) {\r\n                        context.post(JSON.stringify({ id: oldFile }), \"/BinaryStore/Remove/\");\r\n                    }\r\n                }\r\n                if (removed) {\r\n                    value(\"\");\r\n                }\r\n            },\r\n            remove: function () {\r\n                var tcs = new $.Deferred(),\r\n                    data = JSON.stringify({ id: value() });\r\n                context.post(data, \"/BinaryStore/Remove/\")\r\n                    .then(function (result) {\r\n                        tcs.resolve(result);\r\n                    });\r\n                return tcs.promise();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n///user moment format\r\nko.bindingHandlers.kendoDate = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            $input = $(element),\r\n            allBindings = allBindingsAccessor(),\r\n            currentValue = ko.unwrap(value),\r\n            date = moment(currentValue, \"DD/MM/YYYY\"),\r\n            changed = function (e) {\r\n                console.log(e);\r\n                var nv = this.value();\r\n                if (typeof nv == \"string\") {\r\n                    date = moment(nv, \"DD/MM/YYYY\");\r\n                } else {\r\n                    date = moment(nv);\r\n                }\r\n                // DO NOT fire update\r\n                $input.data(\"stop\", \"true\");\r\n                value(date.format(\"YYYY-MM-DD\"));\r\n                $input.data(\"stop\", \"false\");\r\n\r\n            },\r\n            picker = $input.kendoDatePicker({ format: \"dd/MM/yyyy\", change: changed }).data(\"kendoDatePicker\");\r\n\r\n        if (typeof allBindings.enable === \"boolean\") {\r\n            if (!allBindings.enable) {\r\n                picker.enable(false);\r\n            }\r\n        }\r\n        if (typeof allBindings.enable === \"function\" && typeof allBindings.enable.subscribe === \"function\") {\r\n            allBindings.enable.subscribe(function (enable) {\r\n                picker.enable(enable);\r\n            });\r\n        }\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n        if (typeof currentValue === \"undefined\" && typeof value === \"function\") {\r\n            value(date.format(\"YYYY-MM-DD\"));\r\n        }\r\n    },\r\n    update: function (element, valueAccessor, allBindingsAccessor) {\r\n        var $input = $(element),\r\n            allBindings = allBindingsAccessor();\r\n        if ($input.data(\"stop\") == \"true\") return;\r\n\r\n        var value = valueAccessor(),\r\n            modelValue = ko.utils.unwrapObservable(value),\r\n            date = moment(modelValue),\r\n            picker = $input.data(\"kendoDatePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n        if (date.year() == 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (typeof allBindings.enable === \"boolean\") {\r\n            if (!allBindings.enable) {\r\n                picker.enable(false);\r\n            }\r\n        }\r\n        if (typeof allBindings.enable === \"function\" && typeof allBindings.enable.subscribe === \"function\") {\r\n            allBindings.enable.subscribe(function (enable) {\r\n                picker.enable(enable);\r\n            });\r\n        }\r\n        picker.value(date.toDate());\r\n\r\n    }\r\n};\r\n\r\n\r\n///user moment format\r\nko.bindingHandlers.kendoDateTime = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            $input = $(element),\r\n            currentValue = ko.utils.unwrapObservable(value),\r\n            date = moment(currentValue,\"DD/MM/YYYY \"),\r\n            changed = function (e) {\r\n                console.log(e);\r\n                var nv = this.value();\r\n                if (typeof nv == \"string\") {\r\n                    date = moment(nv, \"DD/MM/YYYY hh:mm\");\r\n                } else {\r\n                    date = moment(nv);\r\n                }\r\n                // DO NOT fire update\r\n                $input.data(\"stop\", \"true\");\r\n                value(date.format());\r\n                $input.data(\"stop\", \"false\");\r\n\r\n            },\r\n            picker = $input.kendoDateTimePicker({ format: \"dd/MM/yyyy HH:mm\", change: changed }).data(\"kendoDateTimePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var $input = $(element);\r\n        if ($input.data(\"stop\") == \"true\") return;\r\n\r\n        var value = valueAccessor(),\r\n            modelValue = ko.utils.unwrapObservable(value),\r\n            date = moment(modelValue),\r\n            picker = $input.data(\"kendoDateTimePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n        if (date.year() == 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.slideVisible = {\r\n    init: function (element, valueAccessor) {\r\n        // Initially set the element to be instantly visible/hidden depending on the value\r\n        var value = valueAccessor();\r\n        $(element).toggle(ko.utils.unwrapObservable(value));\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        ko.utils.unwrapObservable(value) ? $(element).slideDown() : $(element).slideUp();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.kendoEnable = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var enable = ko.utils.unwrapObservable(value);\r\n        if (enable) {\r\n            $(element).removeClass('k-state-disabled');\r\n        } else {\r\n            $(element).addClass('k-state-disabled');\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var enable = ko.utils.unwrapObservable(value);\r\n        if (enable) {\r\n            $(element).removeClass('k-state-disabled');\r\n            $(element).removeAttr('disabled');\r\n        } else {\r\n            $(element).addClass('k-state-disabled');\r\n            $(element).attr('disabled', 'disabled');\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.command = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var action = valueAccessor(),\r\n            $button = $(element),\r\n            allBindings = allBindingsAccessor(),\r\n            inputValue = $button.val();\r\n\r\n        if (allBindings.isvisible) {\r\n            var visible = typeof allBindings.isvisible === \"function\" ? allBindings.isvisible() : allBindings.isvisible;\r\n            if (!visible) {\r\n                $button.hide();\r\n            } else {\r\n                $button.show();\r\n            }\r\n\r\n            if (typeof allBindings.isvisible === \"function\") {\r\n                allBindings.isvisible.subscribe(function (v) {\r\n                    if (v)\r\n                        $button.show();\r\n                    else\r\n                        $button.hide();\r\n                });\r\n            }\r\n        }\r\n\r\n        var $spinner = $(\"<i class='fa fa-spin fa-spinner'></i>\").hide();\r\n        $button.append($spinner);\r\n\r\n        $button.click(function (e) {\r\n            e.preventDefault();\r\n            if (this.form) {\r\n                if (!this.form.checkValidity()) return;\r\n            }\r\n            $spinner.show();\r\n\r\n            action()\r\n                .then(function () {\r\n                    $button\r\n                        .button(\"complete\")\r\n                        .prop('disabled', false)\r\n                        .val(inputValue)\r\n                        .removeClass('btn-disabled');\r\n                    $spinner.hide();\r\n\r\n                });\r\n            if ($button.data(\"loading-text\")) {\r\n                $button.button(\"loading\");\r\n            }\r\n            $button.addClass('btn-disabled').prop('disabled', true);\r\n\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.field = {\r\n    init: function () {\r\n    }\r\n};\r\nko.bindingHandlers.unwrapClick = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var action = valueAccessor(),\r\n            button = $(element),\r\n            allBindings = allBindingsAccessor();\r\n\r\n\r\n        button.click(function (e) {\r\n            e.preventDefault();\r\n            var prop = allBindings.property,\r\n                accessor = allBindings.accessor,\r\n                type = allBindings.field,\r\n                entity = allBindings.entity;\r\n            /* if we can't get to the function , i.e. it's still object not ko.observable\r\n            \r\n            */\r\n            if (prop) {\r\n                if (typeof accessor[prop] === \"undefined\") {\r\n                    console.log(\"Can't figure out the accessor.prop\");\r\n                }\r\n                if (typeof accessor[prop] === \"object\") {\r\n                    accessor[prop] = ko.observable(accessor[prop]);\r\n                }\r\n                if (typeof accessor[prop] === \"function\") {\r\n                    action(accessor[prop], type, entity);\r\n                }\r\n            } else {\r\n                action(accessor, type, entity);\r\n            }\r\n\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.fieldImage = {\r\n    init: function (element, valueAccessor) {\r\n        var type = valueAccessor(),\r\n            img = $(element);\r\n\r\n        var ft = typeof type === \"function\" ? type() : type;\r\n        img.attr(\"src\", \"/image/index/\" + ft);\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.stringArrayAutoComplete = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            options = allBindings.data();\r\n\r\n        $(element).data(\"kendoAutoComplete\") ||\r\n           $(element).kendoAutoComplete({\r\n               dataSource: options,\r\n               change: function () {\r\n                   var data = _(this.value().split(\",\")).filter(function (s) {\r\n                       return s;\r\n                   });\r\n                   value(data);\r\n               },\r\n               filter: \"startswith\",\r\n               placeholder: \"....\",\r\n               separator: \",\"\r\n           }).val(value());\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        $(element).data(\"kendoAutoComplete\").value(value());\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\nko.bindingHandlers.pathAutoComplete = {\r\n    init: function (element, valueAccessor) {\r\n        var command = valueAccessor();\r\n        var value = command.value;\r\n        var type = command.type;\r\n\r\n        if (!type()) return;\r\n\r\n        $.get(\"/App/TriggerPathPickerJson/\" + type())\r\n            .done(function (json) {\r\n                var tree = JSON.parse(json);\r\n                var data = _.chain(tree)\r\n                    .map(function (t) {\r\n                        if (t.parent === \"\")\r\n                            return t.name;\r\n                        return undefined;\r\n                    })\r\n                    .filter(function (t) {\r\n                        return typeof t !== \"undefined\";\r\n                    })\r\n                    .value();\r\n\r\n                console.log(data);\r\n\r\n                var dataSource = new kendo.data.DataSource({\r\n                    data: data\r\n                });\r\n                var input = $(element).data(\"kendoAutoComplete\") ||\r\n                   $(element).kendoAutoComplete({\r\n                       dataSource: tree,\r\n                       dataTextField: \"path\",\r\n                       change: function () {\r\n                           var path = this.value();\r\n                           console.log(\"selected path \", path);\r\n\r\n                       },\r\n                       filter: \"startswith\",\r\n                       placeholder: \"Select path...\",\r\n                       separator: \"\"\r\n                   }).data(\"kendoAutoComplete\");\r\n\r\n                $(element)\r\n                        .change(function () {\r\n                            value($(this).val());\r\n                            console.log(\"new value\", value());\r\n                        })\r\n                       .val(value())\r\n                    .on(\"keydown3\", function (e) {\r\n                        if (e.which === 110 || e.which === 190) {\r\n                            var path = $(this).val() + \".\";\r\n                            console.log(\"show the auto complete\", path);\r\n                            var filtered = _.chain(tree)\r\n                                .filter(function (t) {\r\n                                    return t.parent === path;\r\n                                })\r\n                                .map(function (t) {\r\n                                    return t.name;\r\n                                })\r\n                                .value();\r\n                            console.log(filtered);\r\n                            //input.setDataSource(dataSource);\r\n                            dataSource.data(filtered);\r\n                            input.refresh();\r\n                        }\r\n                    });\r\n            });\r\n\r\n    }\r\n\r\n};\r\n\r\nko.bindingHandlers.commandWithParameter = {\r\n    init: function (element, valueAccessor) {\r\n        var command = valueAccessor();\r\n        var callback = command.command;\r\n        var parameter = command.commandParameter;\r\n\r\n        var button = $(element);\r\n        var completeText = button.data(\"complete-text\") || button.html();\r\n        button.click(function (e) {\r\n            e.preventDefault();\r\n            callback(parameter)\r\n                .then(function () {\r\n                    button.button(\"complete\");\r\n                    if (button.get(0).tagName == 'BUTTON' || button.get(0).tagName == 'A') {\r\n                        button.html(completeText);\r\n                    } else {\r\n                        button.val(completeText);\r\n                    }\r\n\r\n                });\r\n            if (button.data(\"loading-text\")) {\r\n                button.button(\"loading\");\r\n            }\r\n        });\r\n    }\r\n\r\n};\r\n\r\n\r\nko.bindingHandlers.filter = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            bindingAccessor = allBindingsAccessor(),\r\n            path = value.path,\r\n            tooltip = value.tooltip || 'Type to filter current page or type and [ENTER] to search the whole view',\r\n            offset = (typeof value.offset === \"undefined\" ? 8 : parseInt(value.offset)),\r\n            colmd = \"col-md-\" + (12 - offset),\r\n            coloff = \"col-md-offset-\" + offset,\r\n            $element = $(element),\r\n            $filterInput = $(\"<input data-toggle='tooltip' title='\" + tooltip + \"' type='search' class='search-query input-medium form-control' placeholder='Filter.. '>\"),\r\n            $serverLoadButton = $(\"<a href='/#' title='Carian server'><i class='add-on icon-search'></i><a>\"),\r\n            $form = $(\"<form class='form-search \" + colmd + \" \" + coloff + \"'>\" +\r\n                \" <div class='input-group pull-right'>\" +\r\n                \"<span class='input-group-addon'>\" +\r\n                \" <span class='glyphicon glyphicon-remove'></span>\" +\r\n                \"</span> \" +\r\n                \"</div>\" +\r\n                \" </form>\"),\r\n            pagedSearch = bindingAccessor.searchPaging;\r\n\r\n\r\n        $form.find('span.input-group-addon').before($filterInput);\r\n        if (pagedSearch) {\r\n            $form.find('span.glyphicon-remove').after($serverLoadButton);\r\n        }\r\n        $element.before($form);\r\n\r\n        $form.submit(function (e) {\r\n            e.preventDefault();\r\n            var filter = $filterInput.val().toLowerCase(),\r\n                tcs = new $.Deferred();\r\n            if (!filter) {\r\n                return tcs.promise();\r\n            }\r\n            if (pagedSearch && typeof pagedSearch.query !== \"undefined\" && typeof pagedSearch.query.filterAndSearch === \"function\") {\r\n                return pagedSearch.query.filterAndSearch(filter);\r\n            }\r\n            return tcs.promise();\r\n        });\r\n\r\n\r\n\r\n        var dofilter = function () {\r\n            var $rows = $element.find(path),\r\n                filter = $filterInput.val().toLowerCase();\r\n            $rows.each(function () {\r\n                var $tr = $(this);\r\n                if ($tr.text().toLowerCase().indexOf(filter) > -1) {\r\n                    $tr.show();\r\n                } else {\r\n                    $tr.hide();\r\n                }\r\n            });\r\n\r\n\r\n        },\r\n        throttled = _.throttle(dofilter, 800);\r\n\r\n        $filterInput.on('keyup', throttled).siblings('span.input-group-addon')\r\n            .click(function () {\r\n                $filterInput.val('');\r\n                dofilter();\r\n            });\r\n\r\n        if ($filterInput.val()) {\r\n            dofilter();\r\n        }\r\n        $filterInput.tooltip();\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.serverPaging = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var value = valueAccessor(),\r\n            entity = value.entity,\r\n            query = value.query,\r\n            list = value.list,\r\n            map = value.map,\r\n            pagerHidden = value.pagerHidden || false,\r\n            $element = $(element),\r\n            context = require('services/datacontext'),\r\n            $pagerPanel = $('<div></div>'),\r\n            $spinner = $('<img src=\"/Images/spinner-md.gif\" alt=\"loading\" class=\"absolute-center\" />'),\r\n            startLoad = function () {\r\n                $spinner.show();\r\n                $element.fadeTo(\"fast\", 0.33);\r\n            },\r\n            endLoad = function () {\r\n                $spinner.hide();\r\n                $element.fadeTo(\"fast\", 1);\r\n            },\r\n            setItemsSource = function (items) {\r\n                if (map) {\r\n                    items = _(items).map(map);\r\n                }\r\n                if (typeof list === \"string\") {\r\n                    viewModel[list](items);\r\n                }\r\n                if (typeof list === \"function\") {\r\n                    list(items);\r\n                }\r\n            },\r\n            changed = function (page, size) {\r\n                startLoad();\r\n                context.loadAsync({\r\n                    entity: entity,\r\n                    page: page,\r\n                    size: size,\r\n                    includeTotal: true\r\n                }, query)\r\n                     .then(function (lo) {\r\n                         setItemsSource(lo.itemCollection);\r\n                         endLoad();\r\n                     });\r\n            };\r\n\r\n        $element.after($pagerPanel).after($spinner)\r\n            .fadeTo(\"slow\", 0.33);\r\n\r\n        var tcs = new $.Deferred();\r\n        context.loadAsync({\r\n            entity: entity,\r\n            page: 1,\r\n            size: 20,\r\n            includeTotal: true\r\n        }, query)\r\n        .then(function (lo) {\r\n\r\n            var options = {\r\n                element: $pagerPanel,\r\n                count: lo.rows,\r\n                changed: changed,\r\n                hidden: pagerHidden\r\n            },\r\n                pager = new bespoke.utils.ServerPager(options);\r\n            console.log(pager);\r\n            setTimeout(function () {\r\n                setItemsSource(lo.itemCollection);\r\n                tcs.resolve(true);\r\n                endLoad();\r\n            }, 500);\r\n\r\n        });\r\n        return tcs.promise();\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.searchPaging = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var value = valueAccessor(),\r\n            entity = value.entity,\r\n            query = value.query,\r\n            executedQuery = value.query || value.initialQuery || {},\r\n            list = value.list,\r\n            map = value.map,\r\n            pagerHidden = value.pagerHidden || false,\r\n            searchButton = value.searchButton,\r\n            $element = $(element),\r\n            context = require('services/datacontext'),\r\n            logger = require('services/logger'),\r\n            cultures = require(objectbuilders.cultures),\r\n            $pagerPanel = $('<div></div>'),\r\n            $spinner = $('<img src=\"/Images/spinner-md.gif\" alt=\"loading\" class=\"absolute-center\" />'),\r\n            startLoad = function () {\r\n                $spinner.show();\r\n                $element.fadeTo(\"fast\", 0.33);\r\n            },\r\n            endLoad = function () {\r\n                $spinner.hide();\r\n                $element.fadeTo(\"fast\", 1);\r\n            },\r\n            setItemsSource = function (items) {\r\n\r\n                if (!pagerHidden) {\r\n                    _(items).each(function (v) {\r\n                        v.pager = {\r\n                            page: pager.page(),\r\n                            size: pager.pageSize()\r\n                        };\r\n                    });\r\n                }\r\n\r\n                if (map) {\r\n                    items = _(items).map(map);\r\n                }\r\n                if (typeof list === \"string\") {\r\n                    viewModel[list](items);\r\n                }\r\n                if (typeof list === \"function\") {\r\n                    list(items);\r\n                }\r\n            },\r\n            pager = null,\r\n            pageChanged = function (page, size) {\r\n                startLoad();\r\n                context.searchAsync({\r\n                    entity: entity,\r\n                    page: page,\r\n                    size: size\r\n                }, executedQuery)\r\n                     .then(function (lo) {\r\n                         setItemsSource(lo.itemCollection);\r\n                         endLoad();\r\n                     });\r\n            },\r\n            search = function (q, page, size) {\r\n                executedQuery = q;\r\n                var tcs1 = new $.Deferred();\r\n                startLoad();\r\n                context.searchAsync({\r\n                    entity: entity,\r\n                    page: page || 1,\r\n                    size: size || 20\r\n                }, q)\r\n                    .then(function (lo) {\r\n                        if (pager) {\r\n                            pager.update(lo.rows);\r\n                        } else {\r\n                            var pagerOptions = {\r\n                                element: $pagerPanel,\r\n                                count: lo.rows,\r\n                                changed: pageChanged,\r\n                                hidden: pagerHidden\r\n                            };\r\n                            pager = new bespoke.utils.ServerPager(pagerOptions);\r\n\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            setItemsSource(lo.itemCollection);\r\n                            tcs1.resolve(lo);\r\n                            endLoad();\r\n                        }, 500);\r\n\r\n                    });\r\n                return tcs1.promise();\r\n            },\r\n            filterAndSearch = function (text) {\r\n                var q = JSON.parse(ko.toJSON(value.query || value.initialQuery)),\r\n                    q2 = {\r\n                        \"from\": 0,\r\n                        \"size\": 20,\r\n                        \"query\": {}\r\n                    };\r\n                q2.query.filtered = q.query.filtered;\r\n                q2.query.filtered.query = {\r\n                    \"query_string\": {\r\n                        \"default_field\": \"_all\",\r\n                        \"query\": text\r\n                    }\r\n                };\r\n                q2.sort = q.sort;\r\n                pager.destroy();\r\n                pager = null;\r\n                search(q2);\r\n            };\r\n\r\n        //exposed the search function\r\n        query.search = search;\r\n        query.filterAndSearch = filterAndSearch;\r\n\r\n        $element.after($pagerPanel).after($spinner)\r\n            .fadeTo(\"slow\", 0.33);\r\n\r\n        if (searchButton) {\r\n            $(document).on('click', searchButton, function (e) {\r\n                e.preventDefault();\r\n                if (!$(this).parents(\"form\")[0].checkValidity()) {\r\n                    logger.error(cultures.messages.FORM_IS_NOT_VALID);\r\n                    return;\r\n                }\r\n                search(ko.toJS(query), 1, pager.pageSize());\r\n            });\r\n\r\n        }\r\n\r\n\r\n        search(ko.toJS(executedQuery));\r\n        return {\r\n            search: search,\r\n            filterAndSearch: filterAndSearch\r\n        };\r\n\r\n    }\r\n};","/// <reference path=\"typeahead.bundle.js\" />\r\n/// <reference path=\"knockout-3.2.0.debug.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"jquery-2.1.1.intellisense.js\" />\r\n\r\nko.bindingHandlers.bootstrapDropDown = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor()) || '[Select your value]',\r\n            anchor = $(element),\r\n            opened = false,\r\n            dropDown = function (e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                var button = $(this);\r\n\r\n                if (opened) {\r\n                    button.parent().removeClass(\"open\");\r\n                    opened = false;\r\n\r\n                } else {\r\n                    button.parent().addClass(\"open\");\r\n                    opened = true;\r\n                    $(document).one('click', function () {\r\n                        button.parent().removeClass(\"open\");\r\n                        opened = false;\r\n                    });\r\n                }\r\n\r\n\r\n            };\r\n        anchor.click(dropDown);\r\n\r\n        if (!anchor.html()) {\r\n            if (text.toString() === \"[object Object]\") {\r\n                text = \"[Select you value]\";\r\n            }\r\n            anchor.html(text + ' <i class=\"fa fa-caret-down\"></i>');\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.tooltip = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).tooltip({ title: text });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.bootstrapPopover = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).popover({ content: '<pre>' + text + '</pre>', html: true });\r\n    }\r\n};\r\nko.bindingHandlers.popover = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).popover({ content: '<pre>' + text + '</pre>', html: true });\r\n    }\r\n};\r\nko.bindingHandlers.bootstrapTooltip = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).tooltip({ title: text });\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nko.bindingHandlers.cssAutoComplete = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            bootstrap = _(document.styleSheets).find(function (s) {\r\n                // TODO : what happend if were to combine the css with Bundle\r\n                if (!s) return false;\r\n                if (!s.href) return false;\r\n\r\n                return s.href.indexOf(\"bootstrap\") > -1;\r\n            });\r\n        var data = ['btn', 'btn-warning', 'btn-success', 'btn-link'];\r\n        if (bootstrap) {\r\n            data = _.chain(bootstrap.rules).filter(function (r) {\r\n                return /^\\./g.test(r.selectorText)\r\n                    && !/:/g.test(r.selectorText)\r\n                    && !/\\s/g.test(r.selectorText)\r\n                    && !/\\+/g.test(r.selectorText)\r\n                    && !/>/g.test(r.selectorText)\r\n                    && !/\\[/g.test(r.selectorText);\r\n            }).map(function (s) {\r\n                return s.selectorText.replace(/\\./g, \"\");\r\n            })\r\n                .value();\r\n        }\r\n\r\n        $(element).typeahead({\r\n            name: 'css_class',\r\n            limit: 10,\r\n            local: data\r\n        })\r\n        .on('typeahead:closed', function () {\r\n            value($(this).val());\r\n        });\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\nko.bindingHandlers.autocomplete = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var va = ko.unwrap(valueAccessor()),\r\n         entity = ko.unwrap(va.entity),\r\n         field = ko.unwrap(va.field),\r\n         query = ko.unwrap(va.query),\r\n         ttl = va.ttl || 300000,\r\n         allBindings = allBindingsAccessor(),\r\n         url = String.format(\"/list?table={0}&column={1}&filter={2}\", entity, field, query),\r\n         suggestions = new Bloodhound({\r\n             datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name'),\r\n             queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n             prefetch: {\r\n                 url: url,\r\n                 tt1: ttl,\r\n                 filter: function (list) {\r\n                     return _(list).map(function (v) {\r\n                         return { name: v };\r\n                     });\r\n                 }\r\n             }\r\n\r\n         });\r\n\r\n        suggestions.initialize();\r\n        $(element).typeahead(null, {\r\n            name: 'autocomplete_' + $(element).prop(\"id\"),\r\n            displayKey: \"name\",\r\n            source: suggestions.ttAdapter()\r\n        })\r\n           .on('typeahead:closed', function () {\r\n               allBindings.value($(this).val());\r\n           });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.scroll = {\r\n    init: function (element, valueAccessor) {\r\n        var rows = ko.unwrap(valueAccessor()),\r\n            done = false;\r\n        // wait for attached\r\n        //setTimeout(function () {\r\n        //    // TODO : just do it this once rows is more than certail values\r\n        //    $(element).tableScroll({ height: height });\r\n        //    done = true;\r\n        //}, 500);\r\n    }\r\n};\r\n","(function () {\r\n    Function.prototype.partial = function () {\r\n        var fn = this, args = Array.prototype.slice.call(arguments);\r\n        return function () {\r\n            var arg = 0;\r\n            for (var i = 0; i < args.length && arg < arguments.length; i++) {\r\n                if (args[i] === undefined) {\r\n                    args[i] = arguments[arg++];\r\n                }\r\n            }\r\n            return fn.apply(this, args);\r\n        };\r\n    };\r\n\r\n})();","(function (window) {\r\n    window.bespoke = window.bespoke || {};\r\n    window.bespoke.ServerOperationStatus = {        \r\n        OK: \"OK\",\r\n        ERROR : \"ERROR\"\r\n    };\r\n\r\n    window.bespoke.messagesText = {\r\n        SAVE_SUCCESS : \"Your item has been saved\"\r\n    };\r\n\r\n})(window);\r\n","/// <reference path=\"bootstrap.js\" />\r\n/// <reference path=\"google-maps-3-vs-1-0-vsdoc.js\" />\r\n/// <reference path=\"bootstrap-datepicker.js\" />\r\n/// <reference path=\"jquery.validate-vsdoc.js\" />\r\n/// <reference path=\"jquery-1.9.1.intellisense.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"modernizr-2.6.2.js\" />\r\n\r\n\r\nvar _uiready = function () {\r\n    var init = function (view) {\r\n    };\r\n    return {\r\n        init: init\r\n    };\r\n\r\n}();\r\n","(function (window, $) {\r\n    window.bespoke = window.bespoke || {};\r\n    bespoke.utils = bespoke.utils || {};\r\n    bespoke.utils.form = bespoke.utils.form || {};\r\n    bespoke.utils.form.checkValidity = function (button) {\r\n        if (button.form)\r\n            return button.form.checkValidity();\r\n        var form = $(button).attr('form');\r\n        if (form) {\r\n           return document.getElementById(form).checkValidity();\r\n        }\r\n        throw \"cannot find the form for the button\";\r\n    };\r\n\r\n\r\n    window.console = window.console || {};\r\n    window.console.dir = window.console.dir || function (){};\r\n\r\n\r\n})(window, jQuery);","(function (window, $) {\r\n    window.Task = window.Task || {};\r\n    window.Task.fromResult = function (returnValue, delay) {\r\n        var tcs = new $.Deferred(),\r\n            ret = returnValue || true,\r\n            d = delay || 100;\r\n\r\n        setTimeout(function () {\r\n            tcs.resolve(ret);\r\n        }, d);\r\n        return tcs.promise();\r\n\r\n    };\r\n\r\n})(window, jQuery);\r\n","\r\nko.bindingHandlers.theme = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {\r\n        // First get the latest data that we're bound to\r\n        var value = valueAccessor(), allBindings = allBindingsAccessor();\r\n        var valueUnwrapped = ko.unwrap(value);\r\n        if(bespoke.sph.Theme) {\r\n            var theme = new bespoke.sph.Theme();\r\n            if (theme[valueUnwrapped]) {\r\n                theme[valueUnwrapped](element, viewModel, allBindings, bindingContext);\r\n            }\r\n            \r\n        }\r\n\r\n    }\r\n};","﻿/// <reference path=\"jquery-ui-1.11.1.js\" />\r\n/// <reference path=\"modernizr-2.8.3.js\" />\r\n/// <reference path=\"jquery-2.1.1.js\" />\r\n/// <reference path=\"bootstrap.js\" />\r\n/// <reference path=\"breeze.debug.js\" />\r\n/// <reference path=\"knockout-2.2.1.debug.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"q.js\" />\r\n/// <reference path=\"toastr-1.1.5.js\" />\r\n"],"sourceRoot":"/source/"}