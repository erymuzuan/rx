{"version":3,"sources":["string.js","_pager.js","_ko.workflow.js","_ko.entity.js","_ko.kendo.js","_ko.bootstrap.js","_function.prototypes.js","_constants.js","_uiready.js","_utils.js","_task.js","_theme.js","_references.js"],"names":["window","$type","String","__typeName","__class","$prototype","prototype","endsWith","suffix","substr","length","startsWith","prefix","trim","replace","trimEnd","trimStart","format","args","_toFormattedString","arguments","useLocale","result","i","open","indexOf","close","slice","charAt","Error","brace","substring","colonIndex","argNumber","parseInt","isNaN","argFormat","arg","toFormattedString","localeFormat","toString","bespoke","utils","ServerPager","options","element","count","sizes","defaultSize","changed","console","log","self2","rows","_","range","pagerDataSource","kendo","data","DataSource","pageSize","hidden","pager","kendoPager","dataSource","pageSizes","page","bind","update","count2","j","setTimeout","destroy","empty","size","pg","dropdownlist","$","find","value","e","ko","bindingHandlers","workflowFormPathIntellisense","init","valueAccessor","allBindingsAccessor","schema","unwrap","allBindings","input","div","css","hide","before","c","completely","fontSize","color","fontFamily","ix","setText","hasOwnProperty","push","sort","currentObject","onChange","text","lastIndexOf","props","split","each","v","startFrom","repaint","attr","blur","val","parent","prop","activityClass","act","fullName","name","exec","addClass","checkedItems","item","dataFor","list","change","checked","is","remove","typeahead","id","members","Bloodhound","datumTokenizer","d","tokenizers","whitespace","Path","queryTokenizer","nonword","prefetch","initialize","highlight","displayKey","source","ttAdapter","on","typeaheadExceptions","exceptions","activityPopover","wd","pop","popover","title","Name","html","content","WebId","document","preventDefault","app","require","objectbuilders","link","hasClass","showMessage","done","removeActivity","editActivity","setStartActivity","comboBoxLookupOptions","$select","lookup","caption","context","displayPath","valuePath","setup","query","promise","getListAsync","entity","getTuplesAsync","field","field2","add","Option","Item1","Item2","subscribe","tree","system","searchbox","member","selected","jsTreeData","state","opened","getNodeMemberType","type","TypeName","memberNameSubscription","memberTypeNameSubscription","recurseChildMember","node","children","MemberCollection","map","setNodePropertyForChildOfValueObject","tag","isObservable","childOfValueMember","observable","ref","jstree","parents","n","get_node","valueMember","dispose","allowFilter","cm","mb1","AllowMultiple","edit","rename_node","set_type","event","mbr","oldParent","old_parent","oldCollections","collection","splice","position","ev","mb","operation","nodeParent","nodePosition","more","target","$node","sel","get_selected","simpleMenu","label","action","child","sph","domain","SimpleMember","guid","create_node","valueObjectMenu","ValueObjectMember","complexChildMenu","ComplexMember","removeMenu","p","parentMember","child2","delete_node","items","to","keyup","clearTimeout","search","help","href","click","substringMatcher","strs","q","cb","matches","substringRegex","RegExp","str","test","typeaheadUrl","types","url","suggestions","obj","limit","remote","tt1","filter","entityTypeaheadPath","datacontext","config","idOrName","typeaheadEntity","eid","camel","match","p1","p2","offset","toUpperCase","toLowerCase","ed","toJS","applicationName","hideDropDown","loadOneAsync","edf","Id","cssTypeahead","extractor","paths","path","s","local","minLength","updater","$element","matcher","tquery","chart","Entity","JSON","parse","Query","Type","tcs","Deferred","searchAsync","buckets","aggregations","category","key_as_string","key","doc_count","categories","kendoChart","theme","chartArea","background","legend","seriesDefaults","labels","visible","template","series","categoryAxis","majorGridLines","tooltip","resolve","getScalarAsync","EntityViewId","viewName","refresh","iconPicker","$input","$picker","append","dialog","app2","showDialog","icon","observableArray","getSingletonObservableArray","$link","stopPropagation","virtualElements","allowedBindings","lookupText","setTextContent","ele","textContent","unwrapObservable","innerTextNode","firstChild","nodeType","nextSibling","setDomNodeChildren","ownerDocument","createTextNode","readonly","ro","kendoEditor","$editor","updating","editor","update2","ke","kendoDropDownListValue","currentModelValue","dd","nv","modelValue","kendoComboBox","decimal","money","textbox","initBinding","parseFloat","fm","toFixed","a","tagName","tv","date","dv","defaultFormat","inputFormat","moment","invalid","year","dateString","kendoUpload","logger","extensions","async","saveUrl","removeUrl","autoUpload","multiple","error","logError","select","files","extension","join","success","info","storeId","response","uploaded","removed","oldFile","post","stringify","then","kendoDate","currentValue","picker","kendoDatePicker","enable","toDate","kendoDateTime","kendoDateTimePicker","slideVisible","toggle","slideDown","slideUp","kendoEnable","removeClass","removeAttr","command","viewModel","$button","inputValue","isvisible","show","$spinner","$warning","form","checkValidity","fail","err","o","message","button","status","statusText","responseJSON","responseMessage","Message","details","Details","responseText","unwrapClick","property","accessor","fieldImage","img","ft","stringArrayAutoComplete","kendoAutoComplete","placeholder","separator","pathAutoComplete","get","json","chain","t","dataTextField","which","filtered","commandWithParameter","callback","parameter","commandParameter","responseJson","bindingAccessor","$filterInput","$serverLoadButton","$form","pagedSearch","searchPaging","customSearch","after","submit","filterAndSearch","previousFilter","dofilter","$rows","$tr","throttled","throttle","siblings","serverPaging","enableReload","hasCommands","toolbar","commands","pagerHidden","$pagerPanel","startLoad","fadeTo","endLoad","setItemsSource","loadAsync","includeTotal","lo","itemCollection","commandId","reloadCommand","x","executedQuery","initialQuery","searchButton","cultures","pageChanged","tcs1","pagerOptions","toJSON","q2","bool","messages","FORM_IS_NOT_VALID","bootstrapDropDown","valueAccesor","anchor","one","optionOrText","placement","tooltipPlacement","bootstrapPopover","bootstrapTooltip","cssAutoComplete","bootstrap","styleSheets","rules","r","selectorText","autocomplete","va","ttl","scroll","Function","partial","fn","Array","call","apply","ServerOperationStatus","OK","ERROR","messagesText","SAVE_SUCCESS","_uiready","view","getElementById","dir","jQuery","Task","fromResult","returnValue","delay","bindingContext","valueUnwrapped","Theme"],"mappings":"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","file":"__core.min.js","sourcesContent":["// String.js - liberated from MicrosoftAjax.js on 03/28/10 by Sky Sanders \r\n\r\n/*\r\n    Copyright (c) 2009, CodePlex Foundation\r\n    All rights reserved.\r\n\r\n    Redistribution and use in source and binary forms, with or without modification, are permitted \r\n    provided that the following conditions are met:\r\n\r\n    *   Redistributions of source code must retain the above copyright notice, this list of conditions \r\n        and the following disclaimer.\r\n\r\n    *   Redistributions in binary form must reproduce the above copyright notice, this list of conditions \r\n        and the following disclaimer in the documentation and/or other materials provided with the distribution.\r\n\r\n    *   Neither the name of CodePlex Foundation nor the names of its contributors may be used to endorse or \r\n        promote products derived from this software without specific prior written permission.\r\n\r\n    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED \r\n    WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR \r\n    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE \r\n    FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT \r\n    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS \r\n    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, \r\n    OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN \r\n    IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</textarea>\r\n*/\r\n\r\n(function (window) {\r\n\r\n    $type = String;\r\n    $type.__typeName = 'String';\r\n    $type.__class = true;\r\n\r\n    $prototype = $type.prototype;\r\n    $prototype.endsWith = function String$endsWith(suffix) {\r\n        /// <summary>Determines whether the end of this instance matches the specified string.</summary>\r\n        /// <param name=\"suffix\" type=\"String\">A string to compare to.</param>\r\n        /// <returns type=\"Boolean\">true if suffix matches the end of this instance; otherwise, false.</returns>\r\n        return (this.substr(this.length - suffix.length) === suffix);\r\n    };\r\n\r\n    $prototype.startsWith = function String$startsWith(prefix) {\r\n        /// <summary >Determines whether the beginning of this instance matches the specified string.</summary>\r\n        /// <param name=\"prefix\" type=\"String\">The String to compare.</param>\r\n        /// <returns type=\"Boolean\">true if prefix matches the beginning of this string; otherwise, false.</returns>\r\n        return (this.substr(0, prefix.length) === prefix);\r\n    };\r\n\r\n    $prototype.trim = function String$trim() {\r\n        /// <summary >Removes all leading and trailing white-space characters from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the start and end of the current String object.</returns>\r\n        return this.replace(/^\\s+|\\s+$/g, '');\r\n    };\r\n\r\n    $prototype.trimEnd = function String$trimEnd() {\r\n        /// <summary >Removes all trailing white spaces from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the end of the current String object.</returns>\r\n        return this.replace(/\\s+$/, '');\r\n    };\r\n\r\n    $prototype.trimStart = function String$trimStart() {\r\n        /// <summary >Removes all leading white spaces from the current String object.</summary>\r\n        /// <returns type=\"String\">The string that remains after all white-space characters are removed from the start of the current String object.</returns>\r\n        return this.replace(/^\\s+/, '');\r\n    }\r\n\r\n    $type.format = function String$format(format, args) {\r\n        /// <summary>Replaces the format items in a specified String with the text equivalents of the values of   corresponding object instances. The invariant culture will be used to format dates and numbers.</summary>\r\n        /// <param name=\"format\" type=\"String\">A format string.</param>\r\n        /// <param name=\"args\" parameterArray=\"true\" mayBeNull=\"true\">The objects to format.</param>\r\n        /// <returns type=\"String\">A copy of format in which the format items have been replaced by the   string equivalent of the corresponding instances of object arguments.</returns>\r\n        return String._toFormattedString(false, arguments);\r\n    };\r\n\r\n    $type._toFormattedString = function String$_toFormattedString(useLocale, args) {\r\n        var result = '';\r\n        var format = args[0];\r\n\r\n        for (var i = 0;;) {\r\n            // Find the next opening or closing brace\r\n            var open = format.indexOf('{', i);\r\n            var close = format.indexOf('}', i);\r\n            if ((open < 0) && (close < 0)) {\r\n                // Not found: copy the end of the string and break\r\n                result += format.slice(i);\r\n                break;\r\n            }\r\n            if ((close > 0) && ((close < open) || (open < 0))) {\r\n\r\n                if (format.charAt(close + 1) !== '}') {\r\n                    throw new Error('format stringFormatBraceMismatch');\r\n                }\r\n\r\n                result += format.slice(i, close + 1);\r\n                i = close + 2;\r\n                continue;\r\n            }\r\n\r\n            // Copy the string before the brace\r\n            result += format.slice(i, open);\r\n            i = open + 1;\r\n\r\n            // Check for double braces (which display as one and are not arguments)\r\n            if (format.charAt(i) === '{') {\r\n                result += '{';\r\n                i++;\r\n                continue;\r\n            }\r\n\r\n            if (close < 0) throw new Error('format stringFormatBraceMismatch');\r\n\r\n\r\n            // Find the closing brace\r\n\r\n            // Get the string between the braces, and split it around the ':' (if any)\r\n            var brace = format.substring(i, close);\r\n            var colonIndex = brace.indexOf(':');\r\n            var argNumber = parseInt((colonIndex < 0) ? brace : brace.substring(0, colonIndex), 10) + 1;\r\n\r\n            if (isNaN(argNumber)) throw new Error('format stringFormatInvalid');\r\n\r\n            var argFormat = (colonIndex < 0) ? '' : brace.substring(colonIndex + 1);\r\n\r\n            var arg = args[argNumber];\r\n            if (typeof(arg) === \"undefined\" || arg === null) {\r\n                arg = '';\r\n            }\r\n\r\n            // If it has a toFormattedString method, call it.  Otherwise, call toString()\r\n            if (arg.toFormattedString) {\r\n                result += arg.toFormattedString(argFormat);\r\n            } else if (useLocale && arg.localeFormat) {\r\n                result += arg.localeFormat(argFormat);\r\n            } else if (arg.format) {\r\n                result += arg.format(argFormat);\r\n            } else\r\n                result += arg.toString();\r\n\r\n            i = close + 1;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n})(window);","/// <reference path=\"toastr.js\" />\r\n/// <reference path=\"_ko.kendo.js\" />\r\n/// <reference path=\"../kendo/js/kendo.pager.js\" />\r\n/// <reference path=\"../kendo/js/kendo.all.js\" />\r\n\r\n\r\n\r\n\r\nvar bespoke = bespoke || {};\r\nbespoke.utils = {};\r\n\r\nbespoke.utils.ServerPager = function (options) {\r\n    options = options || {};\r\n    var element = options.element,\r\n        count = options.count || 0,\r\n        sizes = options.sizes || [10, 20, 50],\r\n        defaultSize = options.defaultSize || 20,\r\n        changed = options.changed || function () {\r\n            console.log(\"no change event\");\r\n        },\r\n        self2 = this,\r\n        rows = _.range(count),\r\n        pagerDataSource = new kendo.data.DataSource({\r\n            data: rows,\r\n            pageSize: defaultSize\r\n        });\r\n    if (options.hidden) {\r\n        return self2;\r\n    }\r\n\r\n    var pager = element.kendoPager({\r\n        dataSource: pagerDataSource,\r\n        pageSizes: sizes\r\n    }).data(\"kendoPager\");\r\n    pager.page(1);\r\n    pager.bind(\"change\", function () {\r\n        if (changed) {\r\n            changed(pager.page(), pager.pageSize());\r\n        }\r\n    });\r\n\r\n    self2.update = function (count2) {\r\n        rows = [];\r\n        for (var j = 0; j < count2 ; j++) {\r\n            rows[j] = j;\r\n        }\r\n        setTimeout(function () {\r\n            pagerDataSource.data(rows);\r\n        }, 500);\r\n    };\r\n    self2.destroy = function () {\r\n        pager.destroy();\r\n        element.empty();\r\n    };\r\n\r\n    self2.pageSize = function (size) {\r\n        if (size) {\r\n            pager.pageSize(size);\r\n        }\r\n        return pager.pageSize();\r\n    };\r\n    self2.page = function (pg) {\r\n        if (pg) {\r\n            pager.page(pg);\r\n        }\r\n        return pager.page();\r\n    };\r\n\r\n    var dropdownlist = $(element).find(\"select\").data(\"kendoDropDownList\");\r\n    if (dropdownlist) {\r\n        dropdownlist.bind(\"change\", function () {\r\n            try {\r\n                changed(1, parseInt(this.value()));\r\n            } catch (e) {\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    return self2;\r\n\r\n};","/// <reference path=\"jstree.min.js\" />\r\n/// <reference path=\"typeahead.bundle.js\" />\r\n/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n/// <reference path=\"knockout.mapping-latest.debug.js\" />\r\n/// <reference path=\"../App/services/datacontext.js\" />\r\n/// <reference path=\"../SphApp/objectbuilders.js\" />\r\n/// <reference path=\"../SphApp/schemas/trigger.workflow.g.js\" />\r\n/// <reference path=\"../SphApp/partial/WorkflowDefinition.js\" />\r\n/// <reference path=\"../App/durandal/amd/text.js\" />\r\n/// <reference path=\"jquery-2.2.0.intellisense.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"require.js\" />\r\n/// <reference path=\"complete.ly.1.0.1.js\" />\r\n\r\n\r\nko.bindingHandlers.workflowFormPathIntellisense = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            schema = ko.unwrap(value.schema),\r\n            allBindings = allBindingsAccessor(),\r\n            setup = function () {\r\n                var input = $(element),\r\n                         div = $(\"<div></div>\").css({\r\n                             'height': \"28px\"\r\n                         });\r\n                input.hide().before(div);\r\n\r\n                var c = completely(div[0], {\r\n                    fontSize: \"12px\",\r\n                    color: \"#555;\",\r\n                    fontFamily: \"\\\"Open Sans\\\", Arial, Helvetica, sans-serif\"\r\n                });\r\n\r\n                c.setText(ko.unwrap(allBindings.value));\r\n                for (var ix in schema) {\r\n                    if (schema.hasOwnProperty(ix)) {\r\n                        if (ix === \"$type\") continue;\r\n                        if (ix === \"addChildItem\") continue;\r\n                        if (ix === \"removeChildItem\") continue;\r\n                        if (ix === \"Empty\") continue;\r\n                        if (ix === \"WebId\") continue;\r\n                        c.options.push(\"\" + ix);\r\n                    }\r\n                }\r\n                c.options.sort();\r\n\r\n                var currentObject = schema;\r\n                c.onChange = function (text) {\r\n                    if (text.lastIndexOf(\".\") === text.length - 1) {\r\n                        c.options = [];\r\n                        var props = text.split(\".\");\r\n\r\n                        currentObject = schema;\r\n                        _(props).each(function (v) {\r\n                            if (v === \"\") { return; }\r\n                            currentObject = currentObject[v];\r\n                        });\r\n                        console.log(\"currentObject\", currentObject);\r\n                        for (var i in currentObject) {\r\n                            if (currentObject.hasOwnProperty(i)) {\r\n                                if (i === \"$type\") continue;\r\n                                if (i === \"addChildItem\") continue;\r\n                                if (i === \"removeChildItem\") continue;\r\n                                if (i === \"Empty\") continue;\r\n                                if (i === \"WebId\") continue;\r\n                                c.options.push(\"\" + i);\r\n                            }\r\n                        }\r\n                        c.options.sort();\r\n                        c.startFrom = text.lastIndexOf(\".\") + 1;\r\n                    }\r\n                    c.repaint();\r\n                };\r\n\r\n                c.repaint();\r\n                $(c.input)\r\n                    .attr(\"autocomplete\", \"off\")\r\n                    .blur(function () {\r\n                        allBindings.value($(this).val());\r\n                    }).parent().find(\"input\")\r\n                    .css({ \"padding\": \"6px 12px\", \"height\": \"28px\" });\r\n\r\n                if ($(element).prop(\"required\")) {\r\n                    $(c.input).prop(\"required\", true);\r\n                }\r\n\r\n\r\n            };\r\n\r\n\r\n        setup();\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.activityClass = {\r\n    init: function (element, valueAccessor) {\r\n\r\n        var div = $(element),\r\n            act = ko.unwrap(valueAccessor()),\r\n        fullName = typeof act.$type === \"function\" ? act.$type() : act.$type,\r\n        name = /Bespoke\\.Sph\\.Domain\\.(.*?),/.exec(fullName)[1];\r\n\r\n        div.addClass(\"activity32\").addClass(\"activity32-\" + name);\r\n    }\r\n};\r\n\r\nko.bindingHandlers.checkedItems = {\r\n    init: function (element, valueAccessor) {\r\n        var item = ko.dataFor(element),\r\n            list = valueAccessor();\r\n\r\n        $(element).change(function () {\r\n            var checked = $(this).is(':checked');\r\n            if (checked) {\r\n                list.push(item);\r\n            } else {\r\n                list.remove(item);\r\n            }\r\n        });\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.typeahead = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var id = ko.unwrap(valueAccessor()),\r\n            allBindings = allBindingsAccessor();\r\n\r\n        if (typeof id === \"undefined\") {\r\n            return;\r\n        }\r\n        var members = new Bloodhound({\r\n            datumTokenizer: function (d) { return Bloodhound.tokenizers.whitespace(d.Path); },\r\n            queryTokenizer: Bloodhound.tokenizers.nonword,\r\n            prefetch: \"/api/workflow-definitions/\" + id + \"/variable-path\"\r\n\r\n        });\r\n        members.initialize();\r\n        $(element).typeahead({ highlight: true }, {\r\n            name: \"schema_paths\" + id,\r\n            displayKey: \"Path\",\r\n            source: members.ttAdapter()\r\n        })\r\n            .on(\"typeahead:closed\", function () {\r\n                allBindings.value($(this).val());\r\n            });\r\n    }\r\n};\r\nko.bindingHandlers.typeaheadExceptions = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n\r\n\r\n        var allBindings = allBindingsAccessor();\r\n\r\n        var exceptions = new Bloodhound({\r\n            datumTokenizer: Bloodhound.tokenizers.whitespace,\r\n            queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n            prefetch: \"/api/assemblies/types/exceptions\"\r\n        });\r\n        \r\n        $(element).typeahead(null, {\r\n            name: \"exceptions\",\r\n            source: exceptions\r\n        }).on(\"typeahead:closed\", function () {\r\n            allBindings.value($(this).val());\r\n        });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.activityPopover = {\r\n    init: function (element, valueAccessor) {\r\n\r\n        var div = $(element),\r\n            act = ko.unwrap(valueAccessor()),\r\n            fullName = typeof act.$type === \"function\" ? act.$type() : act.$type,\r\n            name = /Bespoke\\.Sph\\.Domain\\.(.*?),/.exec(fullName)[1],\r\n            wd = ko.dataFor(div.parent()[0]).wd(),\r\n            pop = div.popover({\r\n                title: name + ' : ' + act.Name(),\r\n                html: true,\r\n                content: function () {\r\n                    $(\"a.edit-activity\").popover(\"hide\");\r\n                    div.find(\"a.edit-activity\").addClass(act.WebId());\r\n                    div.find(\"a.delete-activity\").addClass(act.WebId());\r\n                    div.find(\"a.start-activity\").addClass(act.WebId());\r\n                    return div.find(\"div.context-menu\").html();\r\n                }\r\n            });\r\n\r\n        // just display it for 5 seconds\r\n        pop.on(\"shown.bs.popover\", function () {\r\n            setTimeout(function () { pop.popover('hide'); }, 5000);\r\n        });\r\n\r\n        $(document).on(\"click\", \"a.\" + act.WebId(), function (e) {\r\n            e.preventDefault();\r\n            var app = require(objectbuilders.app),\r\n                link = $(this);\r\n            if (link.hasClass(\"delete-activity\")) {\r\n                app.showMessage(\"Are you sure you want to remove this Activity\", \"Remove activity\", [\"Yes\", \"No\"])\r\n                    .done(function (result) {\r\n                        if (result === \"Yes\") {\r\n                            wd.removeActivity(act)();\r\n                        }\r\n                    });\r\n            }\r\n            if (link.hasClass(\"edit-activity\")) {\r\n                wd.editActivity(act)();\r\n            }\r\n            if (link.hasClass(\"start-activity\")) {\r\n                wd.setStartActivity(act)();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.comboBoxLookupOptions = {\r\n    init: function (element, valueAccessor) {\r\n        var $select = $(element),\r\n            lookup = ko.unwrap(valueAccessor()),\r\n            value = lookup.value,\r\n            caption = lookup.caption,\r\n            context = require(\"services/datacontext\"),\r\n            displayPath = ko.unwrap(lookup.displayPath),\r\n            valuePath = ko.unwrap(lookup.valuePath);\r\n\r\n        var setup = function (query) {\r\n\r\n            //getListAsync\r\n            var promise = ko.unwrap(lookup.valuePath) === ko.unwrap(lookup.displayPath) ?\r\n                context.getListAsync(ko.unwrap(lookup.entity), query, ko.unwrap(lookup.valuePath)) :\r\n                context.getTuplesAsync({\r\n                    entity: ko.unwrap(lookup.entity),\r\n                    query: query,\r\n                    field: valuePath,\r\n                    field2: displayPath\r\n                });\r\n\r\n\r\n            promise.done(function (list) {\r\n                element.options.length = 0;\r\n                if (caption) {\r\n                    element.add(new Option(caption, \"\"));\r\n                }\r\n                _(list).each(function (v) {\r\n                    if (typeof v === \"string\") {\r\n                        element.add(new Option(v, v));\r\n                        return;\r\n                    }\r\n                    if (typeof v.Item1 === \"string\" && typeof v.Item2 === \"string\") {\r\n                        element.add(new Option(v.Item2, v.Item1));\r\n                        return;\r\n                    }\r\n                    if (typeof v[valuePath] === \"string\" && typeof v[displayPath] === \"string\") {\r\n                        element.add(new Option(v[valuePath], v[displayPath]));\r\n                        return;\r\n                    }\r\n                });\r\n\r\n                $select.val(ko.unwrap(value))\r\n                    .on(\"change\", function () {\r\n                        value($select.val());\r\n                    });\r\n\r\n            });\r\n        };\r\n        setup(ko.unwrap(lookup.query));\r\n\r\n        if (typeof lookup.query === \"function\") {\r\n            if (typeof lookup.query.subscribe === \"function\") {\r\n                lookup.query.subscribe(function (v) {\r\n                    setup(ko.unwrap(v));\r\n                });\r\n            }\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var lookup = ko.unwrap(valueAccessor()),\r\n            value = lookup.value;\r\n        $(element).val(ko.unwrap(value));\r\n    }\r\n};\r\n\r\n","/// <reference path=\"~/Scripts/underscore.js\" />\r\n/// <reference path=\"~/Scripts/jstree.min.js\" />\r\n/// <reference path=\"require.js\" />\r\n/// <reference path=\"jquery-2.2.0.intellisense.js\" />\r\n/// <reference path=\"complete.ly.1.0.1.js\" />\r\n/// <reference path=\"../SphApp/objectbuilders.js\" />\r\n/// <reference path=\"../SphApp/schemas/form.designer.g.js\" />\r\n/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n\r\nko.bindingHandlers.tree = {\r\n    init: function (element, valueAccessor) {\r\n        var system = require(objectbuilders.system),\r\n            value = valueAccessor(),\r\n            entity = ko.unwrap(value.entity),\r\n            searchbox = ko.unwrap(value.searchbox),\r\n            member = value.selected,\r\n            jsTreeData = {\r\n                text: entity.Name(),\r\n                state: {\r\n                    opened: true,\r\n                    selected: true\r\n                }\r\n            },\r\n            getNodeMemberType = function (v) {\r\n                var type = ko.unwrap(v.TypeName) || ko.unwrap(v.$type);\r\n                if (type.indexOf(\",\") < 0) {\r\n                    type = ko.unwrap(v.$type);\r\n                }\r\n                return type;\r\n            },\r\n            memberNameSubscription = null,\r\n            memberTypeNameSubscription = null,\r\n            recurseChildMember = function (node) {\r\n                node.children = _(node.data.MemberCollection()).map(function (v) {\r\n\r\n                    const type = getNodeMemberType(v);\r\n                    return {\r\n                        text: v.Name(),\r\n                        state: \"open\",\r\n                        type: type,\r\n                        data: v\r\n                    };\r\n                });\r\n                _(node.children).each(recurseChildMember);\r\n            },\r\n            setNodePropertyForChildOfValueObject = function (node, tag) {\r\n                if (!ko.isObservable(tag.childOfValueMember)) {\r\n                    tag.childOfValueMember = ko.observable(true);\r\n                }\r\n                var ref = $(element).jstree(true),\r\n                       parents = _(node.parents).map(function (n) { return ref.get_node(n); }),\r\n                       valueMember = _(parents).find(function (n) { return n.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\"; });\r\n                tag.childOfValueMember(valueMember || false);\r\n            },\r\n            loadJsTree = function () {\r\n                jsTreeData.children = _(entity.MemberCollection()).map(function (v) {\r\n\r\n                    return {\r\n                        text: ko.unwrap(v.Name),\r\n                        state: \"open\",\r\n                        type: getNodeMemberType(v),\r\n                        data: v\r\n                    };\r\n                });\r\n                _(jsTreeData.children).each(recurseChildMember);\r\n                $(element)\r\n                    .on(\"select_node.jstree\", function (node, selected) {\r\n                        if (typeof member !== \"function\") {\r\n                            return;\r\n                        }\r\n                        if (memberNameSubscription) {\r\n                            memberNameSubscription.dispose();\r\n                            memberNameSubscription = null;\r\n                        }\r\n\r\n                        if (memberTypeNameSubscription) {\r\n                            memberTypeNameSubscription.dispose();\r\n                            memberTypeNameSubscription = null;\r\n                        }\r\n\r\n                        var tag = selected.node.data;\r\n                        if (tag) {\r\n                            if (selected.node.type === \"default\") {\r\n                                return;\r\n                            }\r\n\r\n                            if (!ko.isObservable(tag.childOfValueMember)) {\r\n                                tag.childOfValueMember = ko.observable(true);\r\n                            }\r\n                            if (!ko.isObservable(tag.allowFilter)) {\r\n                                tag.allowFilter = ko.observable(true);\r\n                            }\r\n\r\n                            var ref = $(element).jstree(true),\r\n                                   parents = _(selected.node.parents).map(function (n) { return ref.get_node(n); }),\r\n                                   valueMember = _(parents).find(function (n) { return n.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\"; });\r\n                            tag.childOfValueMember(valueMember || false);\r\n                            // we also need to disable for collection member\r\n                            if (!valueMember) {\r\n\r\n                                var cm = _(parents).find(function (n) {\r\n                                    var mb1 = n.data;\r\n                                    return n.type === \"Bespoke.Sph.Domain.ComplexMember, domain.sph\" && ko.unwrap(mb1.AllowMultiple);\r\n                                });\r\n                                if (cm) {\r\n                                    tag.allowFilter(false);\r\n                                }\r\n                            }\r\n\r\n\r\n                            if (!tag.childOfValueMember()) {\r\n                                ref.edit(selected.node);\r\n                            }\r\n                            member(tag);\r\n                            // subscribe to Name change\r\n                            memberNameSubscription = member().Name.subscribe(function (name) {\r\n                                $(element).jstree(true)\r\n                                    .rename_node(selected.node, name);\r\n                                console.log(\"rename \" + name);\r\n                            });\r\n                            // type\r\n                            if (typeof member().TypeName === \"function\") {\r\n                                memberTypeNameSubscription = member().TypeName.subscribe(function (name) {\r\n                                    $(element).jstree(true)\r\n                                        .set_type(selected.node, name);\r\n                                });\r\n\r\n                            }\r\n                        }\r\n                    })\r\n                    .on(\"create_node.jstree\", function (event, node) {\r\n                        console.log(node, \"node\");\r\n                    })\r\n                    .on(\"move_node.jstree\", function (e, data) {\r\n                        var ref = $(element).jstree(true),\r\n                        \tmbr = data.node.data,\r\n                            oldParent = ref.get_node(data.old_parent),\r\n                            oldCollections = oldParent.data.MemberCollection || entity.MemberCollection,\r\n                            parent = ref.get_node(data.parent),\r\n                            collection = parent.data.MemberCollection || entity.MemberCollection;\r\n                        oldCollections.remove(function (v) {\r\n                            return ko.unwrap(mbr.WebId) === ko.unwrap(v.WebId);\r\n                        });\r\n                        collection.splice(data.position, 0, mbr);\r\n                    })\r\n                    .on(\"rename_node.jstree\", function (ev, node) {\r\n                        var mb = node.node.data;\r\n                        mb.Name(node.text);\r\n                    })\r\n                    .jstree({\r\n                        \"core\": {\r\n                            \"animation\": 0,\r\n                            \"check_callback\": function (operation, node, nodeParent, nodePosition, more) {\r\n                                if (operation === \"move_node\") {\r\n                                    var mbr = node.data,\r\n                                        ref = $(element).jstree(true),\r\n                                        target = ref.get_node(nodeParent);\r\n                                    if (!mbr) {\r\n                                        return false;\r\n                                    }\r\n                                    if (!target) {\r\n                                        return false;\r\n                                    }\r\n                                    if (!ko.isObservable(mbr.childOfValueMember)) {\r\n                                        setNodePropertyForChildOfValueObject(node, mbr);\r\n                                    }\r\n                                    if (ko.unwrap(mbr.childOfValueMember)) {\r\n                                        return false;\r\n                                    }\r\n                                    if (target.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\") {\r\n                                        return false;\r\n                                    }\r\n\r\n                                    return true;\r\n                                }\r\n                                return true;\r\n                            },\r\n                            \"themes\": { \"stripes\": true },\r\n                            'data': jsTreeData\r\n                        },\r\n                        \"dnd\": {\r\n                            \"is_draggable\": function (node) {\r\n                                var mbr = node.data;\r\n                                if (mbr && ko.unwrap(mbr.childOfValueMember)) {\r\n                                    return false;\r\n                                }\r\n                                return true;\r\n                            }\r\n                        },\r\n                        \"contextmenu\": {\r\n                            \"items\": function ($node) {\r\n\r\n                                var ref = $(element).jstree(true),\r\n                                    parents = _($node.parents).map(function (n) { return ref.get_node(n); }),\r\n                                    valueMember = _(parents).find(function (n) { return n.type === \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\"; }),\r\n                                        sel = ref.get_selected();\r\n                                if (valueMember) {\r\n                                    return [];\r\n                                }\r\n\r\n                                var simpleMenu = {\r\n                                    label: \"Add Simple Child\",\r\n                                    action: function () {\r\n                                        const child = new bespoke.sph.domain.SimpleMember({ WebId: system.guid(), TypeName: \"System.String, mscorlib\", Name: \"Member_Name\" }),\r\n                                            parent = $(element).jstree(\"get_selected\", true),\r\n                                            mb = parent[0].data,\r\n                                            newNode = { state: \"open\", type: \"System.String, mscorlib\", text: \"Member_Name\", data: child };\r\n\r\n                                        if (!sel.length) {\r\n                                            return false;\r\n                                        }\r\n                                        sel = sel[0];\r\n                                        sel = ref.create_node(sel, newNode);\r\n                                        if (sel) {\r\n                                            ref.edit(sel);\r\n                                            if (mb && mb.MemberCollection) {\r\n                                                mb.MemberCollection.push(child);\r\n                                            } else {\r\n                                                entity.MemberCollection.push(child);\r\n                                            }\r\n                                            return true;\r\n                                        }\r\n                                        return false;\r\n\r\n\r\n                                    }\r\n                                },\r\n                                    valueObjectMenu = {\r\n                                        label: \"Add Value Object Child\",\r\n                                        action: function () {\r\n                                            var typeName = \"Bespoke.Sph.Domain.ValueObjectDefinition, domain.sph\",\r\n                                                child = new bespoke.sph.domain.ValueObjectMember({ WebId: system.guid(), TypeName: typeName, Name: \"Member_Name\" }),\r\n                                                parent = $(element).jstree(\"get_selected\", true),\r\n                                                mb = parent[0].data,\r\n                                                newNode = { state: \"open\", type: \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\", text: \"Member_Name\", data: child };\r\n\r\n                                            if (!sel.length) {\r\n                                                return false;\r\n                                            }\r\n                                            sel = sel[0];\r\n                                            sel = ref.create_node(sel, newNode);\r\n                                            if (sel) {\r\n                                                ref.edit(sel);\r\n                                                if (mb && mb.MemberCollection) {\r\n                                                    mb.MemberCollection.push(child);\r\n                                                } else {\r\n                                                    entity.MemberCollection.push(child);\r\n                                                }\r\n                                                child.TypeName.subscribe(function () {\r\n                                                    // TODO : clear the node children and populate the node according to the value object definition members\r\n\r\n                                                });\r\n                                                return true;\r\n                                            }\r\n                                            return false;\r\n\r\n\r\n                                        }\r\n                                    },\r\n                                    complexChildMenu = {\r\n                                        label: \"Add Complex Child\",\r\n                                        action: function () {\r\n                                            var child = new bespoke.sph.domain.ComplexMember({ WebId: system.guid(), Name: \"Member_Name\" }),\r\n                                                parent = $(element).jstree(\"get_selected\", true),\r\n                                                mb = parent[0].data,\r\n                                                newNode = { state: \"open\", type: \"Bespoke.Sph.Domain.ComplexMember, domain.sph\", text: \"Member_Name\", data: child };\r\n\r\n                                            if (!sel.length) {\r\n                                                return false;\r\n                                            }\r\n                                            sel = sel[0];\r\n                                            sel = ref.create_node(sel, newNode);\r\n                                            if (sel) {\r\n                                                ref.edit(sel);\r\n                                                if (mb && mb.MemberCollection) {\r\n                                                    mb.MemberCollection.push(child);\r\n                                                } else {\r\n                                                    entity.MemberCollection.push(child);\r\n                                                }\r\n                                                return true;\r\n                                            }\r\n                                            return false;\r\n\r\n\r\n                                        }\r\n                                    },\r\n                                    removeMenu = {\r\n                                        label: \"Remove\",\r\n                                        action: function () {\r\n                                            // now delete the member\r\n                                            var n = ref.get_selected(true)[0],\r\n                                                p = ref.get_node($(\"#\" + n.parent)),\r\n                                                parentMember = p.data;\r\n                                            if (parentMember && typeof parentMember.MemberCollection === \"function\") {\r\n                                                var child = _(parentMember.MemberCollection()).find(function (v) {\r\n                                                    return v.WebId() === n.data.WebId();\r\n                                                });\r\n                                                parentMember.MemberCollection.remove(child);\r\n                                            } else {\r\n                                                var child2 = _(entity.MemberCollection()).find(function (v) {\r\n                                                    return v.WebId() === n.data.WebId();\r\n                                                });\r\n                                                entity.MemberCollection.remove(child2);\r\n                                            }\r\n\r\n                                            if (!sel.length) {\r\n                                                return false;\r\n                                            }\r\n                                            ref.delete_node(sel);\r\n\r\n                                            return true;\r\n\r\n                                        }\r\n                                    };\r\n\r\n                                var items = [];\r\n\r\n                                if ($node.type === \"default\" || $node.type === \"Bespoke.Sph.Domain.ComplexMember, domain.sph\") {\r\n                                    items.push(simpleMenu);\r\n                                    items.push(valueObjectMenu);\r\n                                    items.push(complexChildMenu);\r\n                                }\r\n\r\n                                console.log($node);\r\n                                if ($node.type !== \"default\") {\r\n                                    items.push(removeMenu);\r\n                                }\r\n                                return items;\r\n                            }\r\n                        },\r\n                        \"types\": {\r\n\r\n                            \"default\": {\r\n                                \"icon\": \"fa fa-clipboard\"\r\n                            },\r\n                            \"System.String, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-bold\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.DateTime, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-calendar\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Int32, mscorlib\": {\r\n                                \"icon\": \"fa fa-sort-numeric-asc\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Decimal, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-usd\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"System.Boolean, mscorlib\": {\r\n                                \"icon\": \"glyphicon glyphicon-ok\",\r\n                                \"valid_children\": []\r\n                            },\r\n                            \"Bespoke.Sph.Domain.ValueObjectMember, domain.sph\": {\r\n                                \"icon\": \"fa fa-object-ungroup\"\r\n                            },\r\n                            \"Bespoke.Sph.Domain.ComplexMember, domain.sph\": {\r\n                                \"icon\": \"fa fa-object-group\"\r\n                            }\r\n                        },\r\n                        \"plugins\": [\"contextmenu\", \"dnd\", \"types\", \"search\"]\r\n                    });\r\n            };\r\n        loadJsTree();\r\n\r\n        var to = false;\r\n        $(searchbox).keyup(function () {\r\n            if (to) {\r\n                clearTimeout(to);\r\n            }\r\n            to = setTimeout(function () {\r\n                var v = $(searchbox).val();\r\n                $(element).jstree(true).search(v);\r\n            }, 250);\r\n        });\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.help = {\r\n    init: function (element, valueAccessor) {\r\n        var link = $(element),\r\n            href = ko.unwrap(valueAccessor());\r\n        link.click(function (e) {\r\n            e.preventDefault();\r\n            window.open(\"/docs/#\" + href);\r\n        });\r\n    }\r\n};\r\nvar substringMatcher = function (strs) {\r\n    return function findMatches(q, cb) {\r\n        var matches, substringRegex;\r\n\r\n        // an array that will be populated with substring matches\r\n        matches = [];\r\n        // regex used to determine if a string contains the substring `q`\r\n        substringRegex = new RegExp(q, \"i\");\r\n\r\n        // iterate through the pool of strings and for any string that\r\n        // contains the substring `q`, add it to the `matches` array\r\n        $.each(strs, function (i, str) {\r\n            if (substringRegex.test(str)) {\r\n                // the typeahead jQuery plugin expects suggestions to a\r\n                // JavaScript object, refer to typeahead docs for more info\r\n                matches.push({ value: str });\r\n            }\r\n        });\r\n\r\n        cb(matches);\r\n    };\r\n};\r\n\r\n\r\nko.bindingHandlers.typeaheadUrl = {\r\n    init: function (element, valueAccessor) {\r\n        var types = ko.unwrap(valueAccessor()),\r\n            ttl = 300000,\r\n            url = String.format(\"/list?table={0}&column={1}\", types[0], \"Route\"),\r\n            suggestions = new Bloodhound({\r\n                datumTokenizer: Bloodhound.tokenizers.obj.whitespace(\"name\"),\r\n                queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n                limit: 10,\r\n                remote: {\r\n                    url: url,\r\n                    tt1: ttl,\r\n                    filter: function (list) {\r\n                        return _(list).map(function (v) {\r\n                            return { name: v };\r\n                        });\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n        suggestions.initialize();\r\n        $(element).typeahead(null,\r\n            {\r\n                name: \"EntityView_\" + $(element).prop(\"id\"),\r\n                displayKey: \"name\",\r\n                source: suggestions.ttAdapter()\r\n            });\r\n    }\r\n};\r\nko.bindingHandlers.entityTypeaheadPath = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        const value = valueAccessor(),\r\n            context = require(objectbuilders.datacontext),\r\n            config = require(objectbuilders.config),\r\n            allBindings = allBindingsAccessor(),\r\n            idOrName = ko.unwrap(valueAccessor()) || window.typeaheadEntity,\r\n            setup = function (options) {\r\n               const toCamelCase = function (text) {\r\n                    return text.replace(/^([A-Z])|\\s(\\w)/g, function (match, p1, p2, offset) {\r\n                        if (p2) return p2.toUpperCase();\r\n                        return p1.toLowerCase();\r\n                    });\r\n               };\r\n\r\n                const name = options.name || options,\r\n                    eid = options.id || options,\r\n                    camel = toCamelCase(name);\r\n\r\n                var ed = ko.toJS(bespoke[config.applicationName + \"_\" + camel].domain[name]());\r\n                const input = $(element),\r\n                         div = $(\"<div></div>\").css({\r\n                             'height': \"28px\"\r\n                         });\r\n                input.hide().before(div);\r\n\r\n                var c = completely(div[0], {\r\n                    fontSize: \"12px\",\r\n                    color: \"#555;\",\r\n                    fontFamily: \"\\\"Open Sans\\\", Arial, Helvetica, sans-serif\"\r\n                });\r\n\r\n                c.setText(ko.unwrap(allBindings.value));\r\n                for (let ix in ed) {\r\n                    if (ed.hasOwnProperty(ix)) {\r\n                        if (ix === \"$type\") continue;\r\n                        if (ix === \"addChildItem\") continue;\r\n                        if (ix === \"removeChildItem\") continue;\r\n                        if (ix === \"Empty\") continue;\r\n                        if (ix === \"WebId\") continue;\r\n                        c.options.push(`${ix}`);\r\n                    }\r\n                }\r\n                c.options.sort();\r\n\r\n                var currentObject = ed;\r\n                c.onChange = function (text) {\r\n                    if (text.lastIndexOf(\".\") === text.length - 1) {\r\n                        c.options = [];\r\n                        const props = text.split(\".\");\r\n\r\n                        currentObject = ed;\r\n                        _(props).each(function (v) {\r\n                            if (v === \"\") { return; }\r\n                            currentObject = currentObject[v];\r\n                        });\r\n                        console.log(\"currentObject\", currentObject);\r\n                        for (var i in currentObject) {\r\n                            if (currentObject.hasOwnProperty(i)) {\r\n                                if (i === \"$type\") continue;\r\n                                if (i === \"addChildItem\") continue;\r\n                                if (i === \"removeChildItem\") continue;\r\n                                if (i === \"Empty\") continue;\r\n                                if (i === \"WebId\") continue;\r\n                                c.options.push(\"\" + i);\r\n                            }\r\n                        }\r\n                        c.options.sort();\r\n                        c.startFrom = text.lastIndexOf(\".\") + 1;\r\n                    }\r\n                    c.repaint();\r\n                };\r\n\r\n                c.repaint();\r\n                $(c.input)\r\n                    .attr(\"autocomplete\", \"off\")\r\n                    .blur(function () {\r\n                        allBindings.value($(this).val());\r\n                    }).parent().find(\"input\")\r\n                    .css({ \"padding\": \"6px 12px\", \"height\": \"28px\" });\r\n\r\n                if ($(element).prop(\"required\")) {\r\n                    $(c.input).prop(\"required\", true);\r\n                }\r\n\r\n                c.hideDropDown();\r\n\r\n            };\r\n\r\n\r\n        if (idOrName) {\r\n            context.loadOneAsync(\"EntityDefinition\", `Name eq '${idOrName}' OR id eq '${idOrName}'`, \"Id\")\r\n                .done(function (edf) {\r\n                    setup({ name: edf.Name(), id: edf.Id() });\r\n                });\r\n\r\n        }\r\n\r\n\r\n        if (typeof value === \"function\" && typeof value.subscribe === \"function\") {\r\n            value.subscribe(function (entity) {\r\n                $(element).typeahead(\"destroy\");\r\n                setup(entity);\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.cssTypeahead = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var allBindings = allBindingsAccessor(),\r\n            results = [\"fa\", \"fa-user\", \"fa-user-o\"],\r\n            extractor = function (query) {\r\n                var result = /([^,]+)$/.exec(query);\r\n                if (result && result[1])\r\n                    return result[1].trim();\r\n                return \"\";\r\n            },\r\n            paths = _(results).map(function (v) {\r\n                return { path: v };\r\n            }),\r\n            members = new Bloodhound({\r\n                datumTokenizer: function (d) {\r\n                    return d.path.split(/s+/);\r\n                },\r\n                queryTokenizer: function (s) {\r\n                    return s.split(/\\./);\r\n                },\r\n                local: paths\r\n            });\r\n        members.initialize();\r\n\r\n        $(element).typeahead({\r\n            minLength: 0,\r\n            highlight: true,\r\n            updater: function () {\r\n                return this.$element.val().replace(/[^,]*$/, \"\") + item + \",\";\r\n            },\r\n            matcher: function (item) {\r\n                var tquery = extractor(this.query);\r\n                if (!tquery) return false;\r\n                return ~item.toLowerCase().indexOf(tquery.toLowerCase());\r\n            }\r\n        },\r\n            {\r\n                name: \"css-class\",\r\n                displayKey: \"path\",\r\n                source: members.ttAdapter()\r\n            })\r\n            .on(\"typeahead:closed\", function () {\r\n                allBindings.value($(this).val());\r\n            });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.chart = {\r\n    init: function (element, valueAccessor) {\r\n        var chart = ko.unwrap(valueAccessor()),\r\n            context = require(\"services/datacontext\"),\r\n            entity = chart.Entity(),\r\n            query = JSON.parse(chart.Query()),\r\n            type = chart.Type(),\r\n            tcs = new $.Deferred(),\r\n            name = chart.Name();\r\n\r\n\r\n        context.searchAsync(entity, query)\r\n            .done(function (result) {\r\n\r\n                var buckets = result.aggregations.category.buckets || result.aggregations.category,\r\n                    data = _(buckets).map(function (v) {\r\n                        return {\r\n                            category: v.key_as_string || v.key.toString(),\r\n                            value: v.doc_count\r\n                        };\r\n                    }),\r\n                    categories = _(buckets).map(function (v) {\r\n                        return v.key_as_string || v.key.toString();\r\n                    }),\r\n                    kendoChart = $(element).kendoChart({\r\n                        theme: \"metro\",\r\n                        chartArea: {\r\n                            background: \"\"\r\n                        },\r\n                        title: {\r\n                            text: name\r\n                        },\r\n                        legend: {\r\n                            position: \"bottom\"\r\n                        },\r\n                        seriesDefaults: {\r\n                            labels: {\r\n                                visible: true,\r\n                                format: \"{0}\",\r\n                                background: \"transparent\",\r\n                                template: \"#= category #: #= value#\"\r\n                            }\r\n                        },\r\n                        series: [\r\n                            {\r\n                                type: type,\r\n                                data: data\r\n                            }\r\n                        ],\r\n                        categoryAxis: {\r\n                            categories: categories,\r\n                            majorGridLines: {\r\n                                visible: false\r\n                            }\r\n                        },\r\n                        tooltip: {\r\n                            visible: true,\r\n                            format: \"{0}\",\r\n                            template: \"#= category #: #= value #\"\r\n                        }\r\n                    }).data(\"kendoChart\");\r\n                tcs.resolve(true);\r\n\r\n                context.getScalarAsync(\"EntityView\", \"Id eq '\" + chart.EntityViewId() + \"'\", \"Name\")\r\n                    .done(function (viewName) {\r\n                        kendoChart.options.title.text = name + \" (\" + viewName + \")\";\r\n                        kendoChart.refresh();\r\n                    });\r\n\r\n            });\r\n\r\n\r\n        return tcs.promise();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.iconPicker = {\r\n    init: function (element, valueAccessor) {\r\n        var $input = $(element),\r\n            value = valueAccessor(),\r\n            $picker = $(\"<a href=\\\"#\\\" class=\\\"btn btn-link\\\">Pick Icon</a>\");\r\n\r\n        $input.parent().append($picker);\r\n        $picker.click(function (e) {\r\n            e.preventDefault();\r\n            require([\"viewmodels/icon.picker\", \"durandal/app\"], function (dialog, app2) {\r\n                app2.showDialog(dialog)\r\n                    .done(function (result) {\r\n                        if (result === \"OK\") {\r\n                            value(dialog.icon());\r\n                            $input.val(dialog.icon());\r\n                        }\r\n                    });\r\n\r\n            });\r\n        });\r\n\r\n    }\r\n};\r\n\r\nvar bespoke = bespoke || {};\r\nbespoke.observableArray = bespoke.observableArray || {};\r\n\r\nbespoke.getSingletonObservableArray = function (key) {\r\n    if (bespoke.observableArray[key]) {\r\n        return bespoke.observableArray[key];\r\n    }\r\n\r\n    bespoke.observableArray[key] = ko.observableArray();\r\n    return bespoke.observableArray[key];\r\n};\r\n\r\n\r\nko.bindingHandlers.lookup = {\r\n    init: function (element, valueAccessor) {\r\n        var $link = $(element),\r\n            options = valueAccessor(),\r\n            member = ko.unwrap(options.member);\r\n\r\n        $link.click(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            require([\"viewmodels/entity.lookup.dialog\", \"durandal/app\"], function (dialog, app2) {\r\n                dialog.options(options);\r\n                app2.showDialog(dialog)\r\n                    .done(function (result) {\r\n                        if (!result) return;\r\n                        if (result === \"OK\") {\r\n                            var item = dialog.selected();\r\n                            options.value(item[member]);\r\n                        }\r\n                    });\r\n\r\n            });\r\n\r\n        });\r\n    }\r\n};\r\nko.virtualElements.allowedBindings.lookupText = true;\r\nbespoke.lookupText = function (element, valueAccessor) {\r\n    var options = valueAccessor(),\r\n        entity = ko.unwrap(options.entity),\r\n        displayPath = ko.unwrap(options.displayPath),\r\n        valuePath = ko.unwrap(options.valuePath),\r\n        val = ko.unwrap(options.value),\r\n        context = require(\"services/datacontext\"),\r\n        setTextContent = function (ele, textContent) {\r\n            var value = ko.utils.unwrapObservable(textContent);\r\n            if ((value === null) || (value === undefined))\r\n                value = \"\";\r\n            var innerTextNode = ko.virtualElements.firstChild(ele);\r\n            if (!innerTextNode || innerTextNode.nodeType !== 3 || ko.virtualElements.nextSibling(innerTextNode)) {\r\n                ko.virtualElements.setDomNodeChildren(ele, [ele.ownerDocument.createTextNode(value)]);\r\n            } else {\r\n                innerTextNode.data = value;\r\n            }\r\n\r\n        };\r\n\r\n    context.getScalarAsync(entity, valuePath + \" eq '\" + val + \"'\", displayPath)\r\n    .done(function (text) {\r\n        setTextContent(element, text);\r\n        console.log(text);\r\n    });\r\n};\r\nko.bindingHandlers.lookupText = {\r\n    init: bespoke.lookupText,\r\n    update: bespoke.lookupText\r\n};\r\n\r\n\r\nko.bindingHandlers.readonly = {\r\n    init: function (element, valueAccessor) {\r\n        var input = $(element),\r\n            ro = ko.unwrap(valueAccessor());\r\n\r\n        if (ro) {\r\n            input.prop(\"readonly\", true);\r\n        } else {\r\n\r\n            input.prop(\"readonly\", false);\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var input = $(element),\r\n             ro = ko.unwrap(valueAccessor());\r\n\r\n        if (ro) {\r\n            input.prop(\"readonly\", true);\r\n        } else {\r\n\r\n            input.prop(\"readonly\", false);\r\n        }\r\n    }\r\n};","/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"~/Scripts/jquery-2.2.0.intellisense.js\" />\r\n/// <reference path=\"~/Scripts/require.js\" />\r\n/// <reference path=\"~/kendo/js/kendo.all.js\" />\r\n/// <reference path=\"_pager.js\" />\r\n/// <reference path=\"/SphApp/services/datacontext.js\" />\r\n/// <reference path=\"/SphApp/objectbuilders.js\" />\r\n\r\n\r\n\r\nko.bindingHandlers.kendoEditor = {\r\n    init: function (element, valueAccessor) {\r\n        var $editor = $(element),\r\n            value = valueAccessor(),\r\n            updating = false;\r\n\r\n        setTimeout(function () {\r\n            var editor = $editor.kendoEditor({\r\n                change: function () {\r\n                    if (updating) return;\r\n                    updating = true;\r\n                    value(this.value());\r\n                    setTimeout(function () { updating = false; }, 500);\r\n                }\r\n            }).data(\"kendoEditor\");\r\n\r\n            editor.value(value());\r\n\r\n            value.subscribe(function (html) {\r\n                if (updating) return;\r\n                updating = true;\r\n                editor.value(html);\r\n                setTimeout(function () { updating = false; }, 500);\r\n            });\r\n\r\n        }, 500);\r\n    },\r\n    update2: function (element, valueAccessor) {\r\n        var $editor = $(element),\r\n            value = valueAccessor(),\r\n            ke = $editor.data(\"kendoEditor\");\r\n        if (!$editor.data(\"updating\")) {\r\n            ke.value(value());\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.kendoDropDownListValue = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var currentModelValue = ko.utils.unwrapObservable(value);\r\n        var dd = $(element).data(\"kendoDropDownList\");\r\n        dd.value(currentModelValue);\r\n\r\n        dd.bind(\"change\", function () {\r\n            var nv = dd.value();\r\n            value(nv);\r\n        });\r\n    },\r\n\r\n    update: function (element, valueAccessor) {\r\n        //update value based on a model change\r\n        var value = valueAccessor();\r\n        var modelValue = ko.utils.unwrapObservable(value);\r\n\r\n        if (modelValue) {\r\n            $(element).data(\"kendoDropDownList\").value(modelValue);\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.source = {\r\n};\r\nko.bindingHandlers.kendoComboBox = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            currentModelValue = ko.utils.unwrapObservable(value),\r\n            dd = $(element).data(\"kendoComboBox\") ||\r\n                $(element).kendoComboBox({\r\n                    dataSource: allBindings.source()\r\n                }).data(\"kendoComboBox\");\r\n\r\n        dd.value(currentModelValue);\r\n        allBindings.source.subscribe(function (options) {\r\n            // console.log(options, dd);\r\n            dd.dataSource.data(options);\r\n        });\r\n        dd.bind(\"change\", function () {\r\n            var nv = dd.value();\r\n            value(nv);\r\n        });\r\n    },\r\n\r\n    update: function (element, valueAccessor) {\r\n        //update value based on a model change\r\n        var value = valueAccessor();\r\n        var modelValue = ko.utils.unwrapObservable(value);\r\n\r\n        if (modelValue) {\r\n            $(element).data(\"kendoComboBox\").value(modelValue);\r\n        }\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.decimal = {};\r\nko.bindingHandlers.money = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            decimal = function () {\r\n                if (typeof allBindings.decimal === \"undefined\") {\r\n                    return 2;\r\n                }\r\n                return parseInt(allBindings.decimal);\r\n            },\r\n            textbox = $(element),\r\n            initBinding = function () {\r\n                var val = parseFloat(ko.unwrap(value) || \"0\"),\r\n                    fm = val.toFixed(decimal())\r\n                        .replace(/./g,\r\n                            function (c, i, a) {\r\n                                return i && c !== \".\" && !((a.length - i) % 3) ? \",\" + c : c;\r\n                            });\r\n                if (element.tagName.toLowerCase() === \"span\") {\r\n                    textbox.text(fm);\r\n                    return;\r\n                }\r\n\r\n                textbox.val(fm);\r\n\r\n                textbox.on(\"blur\", function () {\r\n                    var tv = $(this).val().replace(/,/g, \"\");\r\n                    console.log(tv);\r\n                    value(parseFloat(tv));\r\n                });\r\n\r\n            };\r\n        initBinding();\r\n\r\n        if (ko.isObservable(value)) {\r\n            value.subscribe(initBinding);\r\n        }\r\n\r\n\r\n    },\r\n    update: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            decimal = function () {\r\n                if (typeof allBindings.decimal === \"undefined\") {\r\n                    return 2;\r\n                }\r\n                return parseInt(allBindings.decimal);\r\n            },\r\n             textbox = $(element),\r\n             val = parseFloat(ko.unwrap(value) || \"0\"),\r\n             fm = val.toFixed(decimal()).replace(/./g, function (c, i, a) {\r\n                 return i && c !== \".\" && !((a.length - i) % 3) ? \",\" + c : c;\r\n             });\r\n\r\n        textbox.val(fm);\r\n\r\n    }\r\n};\r\n\r\n///user moment format\r\nko.bindingHandlers.date = {\r\n    init: function (element, valueAccessor) {\r\n        var value = ko.utils.unwrapObservable(valueAccessor());\r\n\r\n        if (!value) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n        var dv = ko.unwrap(value.value),\r\n            defaultFormat = (dv || \"\").indexOf(\"T\") > -1 ? \"YYYY-MM-DDTHH:mm:ss\" : \"YYYY-MM-DD\",\r\n            inputFormat = ko.unwrap(value.inputFormat) || defaultFormat,\r\n            date = moment(dv, inputFormat),\r\n            invalid = ko.unwrap(value.invalid) || \"invalid date\",\r\n            format = ko.unwrap(value.format) || \"DD/MM/YYYY\";\r\n\r\n        if (!value.format && typeof ko.unwrap(value) === \"string\") {\r\n            dv = ko.unwrap(value);\r\n            date = moment(dv);\r\n        }\r\n\r\n        $(element).on(\"change\", function () {\r\n            var nv = $(this).val();\r\n            value.value(nv);\r\n        });\r\n        if (!dv) {\r\n            $(element).text(invalid);\r\n            $(element).val(invalid);\r\n            return;\r\n        }\r\n        if (!date) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n\r\n        var dateString = date.format(format).toString();\r\n        if (dateString.indexOf(\"NaN\") < 0) {\r\n            $(element).text(dateString);\r\n            $(element).val(dateString);\r\n        }\r\n\r\n\r\n\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = ko.utils.unwrapObservable(valueAccessor());\r\n\r\n        if (!value) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n        var dv = ko.unwrap(value.value),\r\n            defaultFormat = (dv || \"\").indexOf(\"T\") > -1 ? \"YYYY-MM-DDTHH:mm:ss\" : \"YYYY-MM-DD\",\r\n            inputFormat = ko.unwrap(value.inputFormat) || defaultFormat,\r\n            date = moment(dv, inputFormat),\r\n            invalid = ko.unwrap(value.invalid) || \"invalid date\",\r\n            format = ko.unwrap(value.format) || \"DD/MM/YYYY\";\r\n\r\n        if (!value.format && typeof ko.unwrap(value) === \"string\") {\r\n            dv = ko.unwrap(value);\r\n            date = moment(dv);\r\n        }\r\n\r\n        $(element).on(\"change\", function () {\r\n            var nv = $(this).val();\r\n            value.value(nv);\r\n        });\r\n        if (!dv) {\r\n            $(element).text(invalid);\r\n            $(element).val(invalid);\r\n            return;\r\n        }\r\n        if (!date) {\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            $(element).text(\"\");\r\n            $(element).val(\"\");\r\n            return;\r\n        }\r\n\r\n\r\n        var dateString = date.format(format).toString();\r\n        if (dateString.indexOf(\"NaN\") < 0) {\r\n            $(element).text(dateString);\r\n            $(element).val(dateString);\r\n        }\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.kendoUpload = {\r\n    init: function (element, valueAccessor) {\r\n        var context = require(objectbuilders.datacontext),\r\n             logger = require(objectbuilders.logger),\r\n             value = valueAccessor(),\r\n             options = valueAccessor(),\r\n                 extensions = [];\r\n        if (options && typeof options === \"object\") {\r\n            value = options.value;\r\n            extensions = options.extensions;\r\n        }\r\n\r\n        $(element).attr(\"name\", \"files\").kendoUpload({\r\n            async: {\r\n                saveUrl: \"/BinaryStore/Upload\",\r\n                removeUrl: \"/BinaryStore/Remove\",\r\n                autoUpload: true\r\n            },\r\n            multiple: false,\r\n            error: function (e) {\r\n                logger.logError(e, e, this, true);\r\n            },\r\n            select: function (e) {\r\n                if (extensions.length === 0) {\r\n                    return;\r\n                }\r\n                _(e.files).each(function (v) {\r\n                    if (extensions.indexOf(v.extension) < 0) {\r\n                        logger.error(\"Only \" + extensions.join(\",\") + \" files can be uploaded\");\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            },\r\n            success: function (e) {\r\n                logger.info(\"Your file has been \" + e.operation);\r\n\r\n                var storeId = e.response.storeId,\r\n                    uploaded = e.operation === \"upload\",\r\n                    removed = e.operation !== \"upload\",\r\n                    oldFile = value();\r\n                if (uploaded) {\r\n                    value(storeId);\r\n                    if (oldFile) {\r\n                        context.post(JSON.stringify({ id: oldFile }), \"/BinaryStore/Remove/\");\r\n                    }\r\n                }\r\n                if (removed) {\r\n                    value(\"\");\r\n                }\r\n            },\r\n            remove: function () {\r\n                var tcs = new $.Deferred(),\r\n                    data = JSON.stringify({ id: value() });\r\n                context.post(data, \"/BinaryStore/Remove/\")\r\n                    .then(function (result) {\r\n                        tcs.resolve(result);\r\n                    });\r\n                return tcs.promise();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n///user moment format\r\nko.bindingHandlers.kendoDate = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            $input = $(element),\r\n            allBindings = allBindingsAccessor(),\r\n            currentValue = ko.unwrap(value),\r\n            date = moment(currentValue, \"DD/MM/YYYY\"),\r\n            changed = function (e) {\r\n                console.log(e);\r\n                var nv = this.value();\r\n                if (typeof nv == \"string\") {\r\n                    date = moment(nv, \"DD/MM/YYYY\");\r\n                } else {\r\n                    date = moment(nv);\r\n                }\r\n                // DO NOT fire update\r\n                $input.data(\"stop\", \"true\");\r\n                value(date.format(\"YYYY-MM-DD\"));\r\n                $input.data(\"stop\", \"false\");\r\n\r\n            },\r\n            picker = $input.kendoDatePicker({ format: \"dd/MM/yyyy\", change: changed }).data(\"kendoDatePicker\");\r\n\r\n        if (typeof allBindings.enable === \"boolean\") {\r\n            if (!allBindings.enable) {\r\n                picker.enable(false);\r\n            }\r\n        }\r\n        if (typeof allBindings.enable === \"function\" && typeof allBindings.enable.subscribe === \"function\") {\r\n            allBindings.enable.subscribe(function (enable) {\r\n                picker.enable(enable);\r\n            });\r\n        }\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n        if (typeof currentValue === \"undefined\" && typeof value === \"function\") {\r\n            value(date.format(\"YYYY-MM-DD\"));\r\n        }\r\n    },\r\n    update: function (element, valueAccessor, allBindingsAccessor) {\r\n        var $input = $(element),\r\n            allBindings = allBindingsAccessor();\r\n        if ($input.data(\"stop\") === \"true\") return;\r\n\r\n        var value = valueAccessor(),\r\n            modelValue = ko.utils.unwrapObservable(value),\r\n            date = moment(modelValue),\r\n            picker = $input.data(\"kendoDatePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (typeof allBindings.enable === \"boolean\") {\r\n            if (!allBindings.enable) {\r\n                picker.enable(false);\r\n            }\r\n        }\r\n        if (typeof allBindings.enable === \"function\" && typeof allBindings.enable.subscribe === \"function\") {\r\n            allBindings.enable.subscribe(function (enable) {\r\n                picker.enable(enable);\r\n            });\r\n        }\r\n        picker.value(date.toDate());\r\n\r\n    }\r\n};\r\n\r\n\r\n///user moment format\r\nko.bindingHandlers.kendoDateTime = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            $input = $(element),\r\n            currentValue = ko.utils.unwrapObservable(value),\r\n            date = moment(currentValue, \"DD/MM/YYYY \"),\r\n            changed = function (e) {\r\n                console.log(e);\r\n                var nv = this.value();\r\n                if (typeof nv == \"string\") {\r\n                    date = moment(nv, \"DD/MM/YYYY hh:mm\");\r\n                } else {\r\n                    date = moment(nv);\r\n                }\r\n                // DO NOT fire update\r\n                $input.data(\"stop\", \"true\");\r\n                value(date.format());\r\n                $input.data(\"stop\", \"false\");\r\n\r\n            },\r\n            picker = $input.kendoDateTimePicker({ format: \"dd/MM/yyyy HH:mm\", change: changed }).data(\"kendoDateTimePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var $input = $(element);\r\n        if ($input.data(\"stop\") === \"true\") return;\r\n\r\n        var value = valueAccessor(),\r\n            modelValue = ko.utils.unwrapObservable(value),\r\n            date = moment(modelValue),\r\n            picker = $input.data(\"kendoDateTimePicker\");\r\n\r\n        if (!date) {\r\n            picker.value(null);\r\n            return;\r\n        }\r\n        if (date.year() === 1) { // DateTime.Min\r\n            picker.value(null);\r\n            return;\r\n        }\r\n\r\n        picker.value(date.toDate());\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.slideVisible = {\r\n    init: function (element, valueAccessor) {\r\n        // Initially set the element to be instantly visible/hidden depending on the value\r\n        var value = valueAccessor();\r\n        $(element).toggle(ko.utils.unwrapObservable(value));\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        ko.utils.unwrapObservable(value) ? $(element).slideDown() : $(element).slideUp();\r\n    }\r\n};\r\n\r\nko.bindingHandlers.kendoEnable = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var enable = ko.utils.unwrapObservable(value);\r\n        if (enable) {\r\n            $(element).removeClass(\"k-state-disabled\");\r\n        } else {\r\n            $(element).addClass(\"k-state-disabled\");\r\n        }\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        var enable = ko.utils.unwrapObservable(value);\r\n        if (enable) {\r\n            $(element).removeClass(\"k-state-disabled\");\r\n            $(element).removeAttr(\"disabled\");\r\n        } else {\r\n            $(element).addClass(\"k-state-disabled\");\r\n            $(element).attr(\"disabled\", \"disabled\");\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.command = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var action = valueAccessor(),\r\n            $button = $(element),\r\n            allBindings = allBindingsAccessor(),\r\n            inputValue = $button.val(),\r\n            logger = require(\"services/logger\");\r\n\r\n        if (allBindings.isvisible) {\r\n            var visible = typeof allBindings.isvisible === \"function\" ? allBindings.isvisible() : allBindings.isvisible;\r\n            if (!visible) {\r\n                $button.hide();\r\n            } else {\r\n                $button.show();\r\n            }\r\n\r\n            if (typeof allBindings.isvisible === \"function\") {\r\n                allBindings.isvisible.subscribe(function (v) {\r\n                    if (v)\r\n                        $button.show();\r\n                    else\r\n                        $button.hide();\r\n                });\r\n            }\r\n        }\r\n\r\n        var $spinner = $(\"<i class='fa fa-spin fa-circle-o-notch'></i>\").hide(),\r\n            $warning = $(\"<i class='fa fa-warning' style='color:red'></i>\").hide();\r\n        $button.append($spinner);\r\n        $button.append($warning);\r\n\r\n        $button.click(function (e) {\r\n            e.preventDefault();\r\n            if (this.form) {\r\n                if (!this.form.checkValidity()) return;\r\n            }\r\n            $spinner.show();\r\n            $warning.hide();\r\n\r\n            action(viewModel, e)\r\n                .fail(function (err, o, message) {\r\n                    $button\r\n                       .button(\"complete\")\r\n                       .prop(\"disabled\", false)\r\n                       .val(inputValue)\r\n                       .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                    $warning.show();\r\n                    if (err.status === 404) {\r\n                        logger.error(message);\r\n                        logger.error(err.statusText);\r\n                        return;\r\n                    }\r\n                    if (err.responseJSON) {\r\n                        const responseMessage = err.responseJSON.Message || \"\",\r\n                            details = err.responseJSON.Details || JSON.stringify(err.responseJSON);\r\n                        logger.error(responseMessage);\r\n                        console.error(responseMessage, details);\r\n                    } else {\r\n                        if (err.responseText) {\r\n                            logger.error(err.responseText);\r\n                            console.error(err.responseText);\r\n                        }\r\n                    }\r\n                })\r\n                .done(function () {\r\n                    $button\r\n                        .button(\"complete\")\r\n                        .prop(\"disabled\", false)\r\n                        .val(inputValue)\r\n                        .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                });\r\n            if ($button.data(\"loading-text\")) {\r\n                $button.button(\"loading\");\r\n            }\r\n            $button.addClass(\"btn-disabled\").prop(\"disabled\", true);\r\n\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.field = {\r\n    init: function () {\r\n    }\r\n};\r\n\r\nko.bindingHandlers.unwrapClick = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var action = valueAccessor(),\r\n            button = $(element),\r\n            allBindings = allBindingsAccessor();\r\n\r\n\r\n        button.click(function (e) {\r\n            e.preventDefault();\r\n            var prop = allBindings.property,\r\n                accessor = allBindings.accessor,\r\n                type = allBindings.field,\r\n                entity = allBindings.entity;\r\n            /* if we can't get to the function , i.e. it's still object not ko.observable\r\n            \r\n            */\r\n            if (prop) {\r\n                if (typeof accessor[prop] === \"undefined\") {\r\n                    console.log(\"Can't figure out the accessor.prop\");\r\n                }\r\n                if (typeof accessor[prop] === \"object\") {\r\n                    accessor[prop] = ko.observable(accessor[prop]);\r\n                }\r\n                if (typeof accessor[prop] === \"function\") {\r\n                    action(accessor[prop], type, entity);\r\n                }\r\n            } else {\r\n                action(accessor, type, entity);\r\n            }\r\n\r\n        });\r\n    }\r\n};\r\n\r\nko.bindingHandlers.fieldImage = {\r\n    init: function (element, valueAccessor) {\r\n        var type = valueAccessor(),\r\n            img = $(element);\r\n\r\n        var ft = typeof type === \"function\" ? type() : type;\r\n        img.attr(\"src\", \"/image/index/\" + ft);\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.stringArrayAutoComplete = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            allBindings = allBindingsAccessor(),\r\n            options = allBindings.data();\r\n\r\n        $(element).data(\"kendoAutoComplete\") ||\r\n           $(element).kendoAutoComplete({\r\n               dataSource: options,\r\n               change: function () {\r\n                   var data = _(this.value().split(\",\")).filter(function (s) {\r\n                       return s;\r\n                   });\r\n                   value(data);\r\n               },\r\n               filter: \"startswith\",\r\n               placeholder: \"....\",\r\n               separator: \",\"\r\n           }).val(value());\r\n    },\r\n    update: function (element, valueAccessor) {\r\n        var value = valueAccessor();\r\n        $(element).data(\"kendoAutoComplete\").value(value());\r\n    }\r\n\r\n};\r\n\r\nko.bindingHandlers.pathAutoComplete = {\r\n    init: function (element, valueAccessor) {\r\n        var command = valueAccessor();\r\n        var value = command.value;\r\n        var type = command.type;\r\n\r\n        if (!type()) return;\r\n\r\n        $.get(\"/App/TriggerPathPickerJson/\" + type())\r\n            .done(function (json) {\r\n                var tree = JSON.parse(json);\r\n                var data = _.chain(tree)\r\n                    .map(function (t) {\r\n                        if (t.parent === \"\")\r\n                            return t.name;\r\n                        return undefined;\r\n                    })\r\n                    .filter(function (t) {\r\n                        return typeof t !== \"undefined\";\r\n                    })\r\n                    .value();\r\n\r\n                console.log(data);\r\n\r\n                var dataSource = new kendo.data.DataSource({\r\n                    data: data\r\n                });\r\n                var input = $(element).data(\"kendoAutoComplete\") ||\r\n                   $(element).kendoAutoComplete({\r\n                       dataSource: tree,\r\n                       dataTextField: \"path\",\r\n                       change: function () {\r\n                           var path = this.value();\r\n                           console.log(\"selected path \", path);\r\n\r\n                       },\r\n                       filter: \"startswith\",\r\n                       placeholder: \"Select path...\",\r\n                       separator: \"\"\r\n                   }).data(\"kendoAutoComplete\");\r\n\r\n                $(element)\r\n                        .change(function () {\r\n                            value($(this).val());\r\n                            console.log(\"new value\", value());\r\n                        })\r\n                       .val(value())\r\n                    .on(\"keydown3\", function (e) {\r\n                        if (e.which === 110 || e.which === 190) {\r\n                            var path = $(this).val() + \".\";\r\n                            console.log(\"show the auto complete\", path);\r\n                            var filtered = _.chain(tree)\r\n                                .filter(function (t) {\r\n                                    return t.parent === path;\r\n                                })\r\n                                .map(function (t) {\r\n                                    return t.name;\r\n                                })\r\n                                .value();\r\n                            console.log(filtered);\r\n                            //input.setDataSource(dataSource);\r\n                            dataSource.data(filtered);\r\n                            input.refresh();\r\n                        }\r\n                    });\r\n            });\r\n\r\n    }\r\n\r\n};\r\n\r\nko.bindingHandlers.commandWithParameter = {\r\n    init: function (element, valueAccessor) {\r\n        var command = valueAccessor(),\r\n            callback = command.command,\r\n            parameter = command.parameter || command.commandParameter,\r\n            button = $(element),\r\n            inputValue = button.val();\r\n\r\n\r\n        var $spinner = $(\"<i class='fa fa-spin fa-circle-o-notch'></i>\").hide(),\r\n            $warning = $(\"<i class='fa fa-warning' style='color:red'></i>\").hide();\r\n        button.append($spinner);\r\n        button.append($warning);\r\n\r\n        button.click(function (e) {\r\n            e.preventDefault();\r\n            if (this.form) {\r\n                if (!this.form.checkValidity()) return;\r\n            }\r\n            $spinner.show();\r\n            $warning.hide();\r\n\r\n            callback(parameter)\r\n                .fail(function (err, o, message) {\r\n                    button\r\n                       .button(\"complete\")\r\n                       .prop(\"disabled\", false)\r\n                       .val(inputValue)\r\n                       .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                    $warning.show();\r\n                    if (err.status === 404) {\r\n                        logger.error(message);\r\n                        logger.error(err.statusText);\r\n                        return;\r\n                    }\r\n                    if (err.responseText) {\r\n                        logger.error(err.responseText);\r\n                        console.error(err.responseText);\r\n                    }\r\n                    if (err.responseJSON) {\r\n                        logger.error(JSON.stringify(err.responseJSON));\r\n                        console.error(err.responseJson);\r\n                    }\r\n                })\r\n                .done(function () {\r\n                    button\r\n                        .button(\"complete\")\r\n                        .prop(\"disabled\", false)\r\n                        .val(inputValue)\r\n                        .removeClass(\"btn-disabled\");\r\n                    $spinner.hide();\r\n                });\r\n            if (button.data(\"loading-text\")) {\r\n                button.button(\"loading\");\r\n            }\r\n            button.addClass(\"btn-disabled\").prop(\"disabled\", true);\r\n\r\n        });\r\n    }\r\n\r\n};\r\n\r\n\r\nko.bindingHandlers.filter = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var value = valueAccessor(),\r\n            bindingAccessor = allBindingsAccessor(),\r\n            path = value.path,\r\n            tooltip = value.tooltip || \"Type to filter current page or type and [ENTER] to search the whole view\",\r\n            $element = $(element),\r\n            $filterInput = $(\"<input data-toggle=\\\"tooltip\\\" title=\\\"\" + tooltip + \"\\\" type=\\\"search\\\" class=\\\"search-query input-medium form-control\\\" placeholder=\\\"Filter.. \\\">\"),\r\n            $serverLoadButton = $(\"<a href='/#' title='Carian server'><i class='add-on icon-search'></i><a>\"),\r\n            $form = $(\"<form class='form-search row'>\" +\r\n                \" <div class='input-group pull-right' style='width:300px'>\" +\r\n                \"<span class='input-group-addon'>\" +\r\n                \" <span class='glyphicon glyphicon-remove'></span>\" +\r\n                \"</span> \" +\r\n                \"</div>\" +\r\n                \" </form>\"),\r\n            pagedSearch = bindingAccessor.searchPaging,\r\n            customSearch = value.customSearch;\r\n\r\n\r\n        $form.find(\"span.input-group-addon\").before($filterInput);\r\n        if (pagedSearch) {\r\n            $form.find(\"span.glyphicon-remove\").after($serverLoadButton);\r\n        }\r\n        $element.before($form);\r\n\r\n        $form.submit(function (e) {\r\n            e.preventDefault();\r\n            var filter = $filterInput.val().toLowerCase(),\r\n                tcs = new $.Deferred();\r\n            if (!filter) {\r\n                return tcs.promise();\r\n            }\r\n            if (typeof customSearch === \"function\") {\r\n                return customSearch(filter);\r\n            }\r\n            if (pagedSearch && typeof pagedSearch.query !== \"undefined\" && typeof pagedSearch.query.filterAndSearch === \"function\") {\r\n                return pagedSearch.query.filterAndSearch(filter);\r\n            }\r\n            return tcs.promise();\r\n        });\r\n\r\n        var previousFilter = \"\",\r\n            dofilter = function () {\r\n               var $rows = $element.find(path),\r\n                   filter = $filterInput.val().toLowerCase();\r\n               if (previousFilter === filter) {\r\n                   return;\r\n               }\r\n               previousFilter = filter;\r\n               $rows.each(function () {\r\n                   var $tr = $(this),\r\n                       text = $tr.text().toLowerCase().trim();\r\n                   if (!text) {\r\n                       $(\"input\", $tr).each(function (i, v) { text += \" \" + $(v).val() });\r\n                       text = text.toLowerCase().trim();\r\n                   }\r\n                   if (text.indexOf(filter) > -1) {\r\n                       $tr.show();\r\n                   } else {\r\n                       $tr.hide();\r\n                   }\r\n               });\r\n\r\n\r\n           },\r\n        throttled = _.throttle(dofilter, 800);\r\n\r\n        $filterInput.on(\"keyup\", throttled).siblings(\"span.input-group-addon\")\r\n            .click(function () {\r\n                $filterInput.val(\"\");\r\n                dofilter();\r\n            });\r\n\r\n        if ($filterInput.val()) {\r\n            dofilter();\r\n        }\r\n        $filterInput.tooltip();\r\n\r\n    }\r\n};\r\n\r\nko.bindingHandlers.serverPaging = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var value = valueAccessor(),\r\n            entity = value.entity,\r\n            enableReload = value.enableReload,\r\n            hasCommands = ko.isObservable((viewModel.toolbar || {}).commands),\r\n            query = value.query,\r\n            list = value.list,\r\n            map = value.map,\r\n            pagerHidden = value.pagerHidden || false,\r\n            $element = $(element),\r\n            context = require(\"services/datacontext\"),\r\n            $pagerPanel = $(\"<div></div>\"),\r\n            $spinner = $(\"<img src=\\\"/Images/spinner-md.gif\\\" alt=\\\"loading\\\" class=\\\"absolute-center\\\" />\"),\r\n            startLoad = function () {\r\n                $spinner.show();\r\n                $element.fadeTo(\"fast\", 0.33);\r\n            },\r\n            endLoad = function () {\r\n                $spinner.hide();\r\n                $element.fadeTo(\"fast\", 1);\r\n            },\r\n            setItemsSource = function (items) {\r\n                if (map) {\r\n                    items = _(items).map(map);\r\n                }\r\n                if (typeof list === \"string\") {\r\n                    viewModel[list](items);\r\n                }\r\n                if (typeof list === \"function\") {\r\n                    list(items);\r\n                }\r\n            },\r\n            changed = function (page, size) {\r\n                startLoad();\r\n                return context.loadAsync({\r\n                    entity: entity,\r\n                    page: page,\r\n                    size: size,\r\n                    includeTotal: true\r\n                }, query)\r\n                     .then(function (lo) {\r\n                         setItemsSource(lo.itemCollection);\r\n                         endLoad();\r\n                     });\r\n            };\r\n\r\n        if (enableReload && hasCommands) {\r\n            const commandId = \"server-paging-reload\",\r\n                reloadCommand = viewModel.toolbar.commands().find(x => x.id === commandId);\r\n            if (!reloadCommand) {\r\n                viewModel.toolbar.commands.push({\r\n                    command: function () {\r\n                        return changed(1, 20);\r\n                    },\r\n                    caption: \"Reload\",\r\n                    icon: \"bowtie-icon bowtie-navigate-refresh\",\r\n                    id: commandId\r\n                });\r\n\r\n            }\r\n        }\r\n\r\n        if (enableReload && !hasCommands) {\r\n            console.error(\"Please provide a toolbar with commands : ko.observableArray(), in your viewModel\");\r\n        }\r\n\r\n        $element.after($pagerPanel).after($spinner)\r\n            .fadeTo(\"slow\", 0.33);\r\n\r\n        var tcs = new $.Deferred();\r\n        context.loadAsync({\r\n            entity: entity,\r\n            page: 1,\r\n            size: 20,\r\n            includeTotal: true\r\n        }, query)\r\n        .then(function (lo) {\r\n\r\n            var options = {\r\n                element: $pagerPanel,\r\n                count: lo.rows,\r\n                changed: changed,\r\n                hidden: pagerHidden\r\n            },\r\n                pager = new bespoke.utils.ServerPager(options);\r\n            console.log(pager);\r\n            setTimeout(function () {\r\n                setItemsSource(lo.itemCollection);\r\n                tcs.resolve(true);\r\n                endLoad();\r\n            }, 500);\r\n\r\n        });\r\n        return tcs.promise();\r\n\r\n\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.searchPaging = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {\r\n        var value = valueAccessor(),\r\n            entity = value.entity,\r\n            enableReload = value.enableReload,\r\n            hasCommands = ko.isObservable((viewModel.toolbar || {}).commands),\r\n            query = value.query,\r\n            executedQuery = value.query || value.initialQuery || {},\r\n            list = value.list,\r\n            map = value.map,\r\n            pagerHidden = value.pagerHidden || false,\r\n            searchButton = value.searchButton,\r\n            $element = $(element),\r\n            context = require(\"services/datacontext\"),\r\n            logger = require(\"services/logger\"),\r\n            cultures = require(objectbuilders.cultures),\r\n            $pagerPanel = $(\"<div></div>\"),\r\n            $spinner = $(\"<img src=\\\"/Images/spinner-md.gif\\\" alt=\\\"loading\\\" class=\\\"absolute-center\\\" />\"),\r\n            startLoad = function () {\r\n                $spinner.show();\r\n                $element.fadeTo(\"fast\", 0.33);\r\n            },\r\n            endLoad = function () {\r\n                $spinner.hide();\r\n                $element.fadeTo(\"fast\", 1);\r\n            },\r\n            pager = null,\r\n            setItemsSource = function (items) {\r\n\r\n                if (!pagerHidden) {\r\n                    _(items).each(function (v) {\r\n                        v.pager = {\r\n                            page: pager.page(),\r\n                            size: pager.pageSize()\r\n                        };\r\n                    });\r\n                }\r\n\r\n                if (map) {\r\n                    items = _(items).map(map);\r\n                }\r\n                if (typeof list === \"string\") {\r\n                    viewModel[list](items);\r\n                }\r\n                if (typeof list === \"function\") {\r\n                    list(items);\r\n                }\r\n            },\r\n            pageChanged = function (page, size) {\r\n                startLoad();\r\n                context.searchAsync({\r\n                    entity: entity,\r\n                    page: page,\r\n                    size: size\r\n                }, executedQuery)\r\n                     .then(function (lo) {\r\n                         setItemsSource(lo.itemCollection);\r\n                         endLoad();\r\n                     });\r\n            },\r\n            search = function (q, page, size) {\r\n                executedQuery = q;\r\n                var tcs1 = new $.Deferred();\r\n                startLoad();\r\n                context.searchAsync({\r\n                    entity: entity,\r\n                    page: page || 1,\r\n                    size: size || 20\r\n                }, q)\r\n                    .then(function (lo) {\r\n                        if (pager) {\r\n                            pager.update(lo.rows);\r\n                        } else {\r\n                            var pagerOptions = {\r\n                                element: $pagerPanel,\r\n                                count: lo.rows,\r\n                                changed: pageChanged,\r\n                                hidden: pagerHidden\r\n                            };\r\n                            pager = new bespoke.utils.ServerPager(pagerOptions);\r\n\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            setItemsSource(lo.itemCollection);\r\n                            tcs1.resolve(lo);\r\n                            endLoad();\r\n                        }, 500);\r\n\r\n                    });\r\n                return tcs1.promise();\r\n            },\r\n            filterAndSearch = function (text) {\r\n                var q = JSON.parse(ko.toJSON(value.query || value.initialQuery)),\r\n                    q2 = {\r\n                        \"from\": 0,\r\n                        \"size\": 20,\r\n                        \"query\": {}\r\n                    };\r\n                q.query = q.query || {};\r\n                q.query.filtered = q.query.filtered || {};\r\n\r\n                q2.query.filtered = q.query.filtered;\r\n                q2.query.filtered.query = {\r\n                    \"query_string\": {\r\n                        \"default_field\": \"_all\",\r\n                        \"query\": text\r\n                    }\r\n                };\r\n                if (q.query.bool) {\r\n                    q2.filter = q2.filter || {};\r\n                    q2.filter.bool = q.query.bool;\r\n                }\r\n                q2.sort = q.sort;\r\n                pager.destroy();\r\n                pager = null;\r\n                search(q2);\r\n            };\r\n\r\n        if (typeof query.subscribe === \"function\") {\r\n            query.subscribe(function (q) {\r\n                search(q, 1, 20);\r\n            });\r\n        }\r\n\r\n\r\n        if (enableReload && hasCommands) {\r\n            const commandId = \"search-paging-reload\",\r\n                reloadCommand = viewModel.toolbar.commands().find(x => x.id === commandId);\r\n            if (!reloadCommand) {\r\n                viewModel.toolbar.commands.push({\r\n                    command: function () {\r\n                        return changed(1, 20);\r\n                    },\r\n                    caption: \"Reload\",\r\n                    icon: \"bowtie-icon bowtie-navigate-refresh\",\r\n                    id: commandId\r\n                });\r\n\r\n            }\r\n        }\r\n\r\n        if (enableReload && !hasCommands) {\r\n            console.error(\"Please provide a toolbar with commands : ko.observableArray(), in your viewModel\");\r\n        }\r\n        //exposed the search function\r\n        query.search = search;\r\n        query.filterAndSearch = filterAndSearch;\r\n\r\n        $element.after($pagerPanel).after($spinner)\r\n            .fadeTo(\"slow\", 0.33);\r\n\r\n        if (searchButton) {\r\n            $(document).on(\"click\", searchButton, function (e) {\r\n                e.preventDefault();\r\n                if (!$(this).parents(\"form\")[0].checkValidity()) {\r\n                    logger.error(cultures.messages.FORM_IS_NOT_VALID);\r\n                    return;\r\n                }\r\n                search(ko.toJS(query), 1, pager.pageSize());\r\n            });\r\n\r\n        }\r\n\r\n\r\n        search(ko.toJS(executedQuery));\r\n        return {\r\n            search: search,\r\n            filterAndSearch: filterAndSearch\r\n        };\r\n\r\n    }\r\n};","/// <reference path=\"typeahead.bundle.js\" />\r\n/// <reference path=\"knockout-3.4.0.debug.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"jquery-2.1.1.intellisense.js\" />\r\n\r\nko.bindingHandlers.bootstrapDropDown = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor()) || '[Select your value]',\r\n            anchor = $(element),\r\n            opened = false,\r\n            dropDown = function (e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                var button = $(this);\r\n\r\n                if (opened) {\r\n                    button.parent().removeClass(\"open\");\r\n                    opened = false;\r\n\r\n                } else {\r\n                    button.parent().addClass(\"open\");\r\n                    opened = true;\r\n                    $(document).one('click', function () {\r\n                        button.parent().removeClass(\"open\");\r\n                        opened = false;\r\n                    });\r\n                }\r\n\r\n\r\n            };\r\n        anchor.click(dropDown);\r\n\r\n        if (!anchor.html()) {\r\n            if (text.toString() === \"[object Object]\") {\r\n                text = \"[Select you value]\";\r\n            }\r\n            anchor.html(text + ' <i class=\"fa fa-caret-down\"></i>');\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.tooltip = {\r\n    init: function (element, valueAccesor) {\r\n        var optionOrText = ko.unwrap(valueAccesor()),\r\n            placement = optionOrText.tooltipPlacement || optionOrText.placement || \"top\",\r\n            text = optionOrText.text || optionOrText.tooltip || optionOrText;\r\n        if (typeof text !== \"string\") {\r\n            text = (optionOrText.text || {}).tooltip;\r\n        }\r\n        if (typeof text === \"string\") {\r\n            $(element).tooltip({ title: text, placement: placement });\r\n        }\r\n    }\r\n};\r\n\r\nko.bindingHandlers.bootstrapPopover = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor()).replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\r\n        $(element).popover({ content: \"<pre>\" + text + \"</pre>\", html: true, placement:\"bottom\" });\r\n    }\r\n};\r\nko.bindingHandlers.popover = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).popover({ content: '<pre>' + text + '</pre>', html: true });\r\n    }\r\n};\r\nko.bindingHandlers.bootstrapTooltip = {\r\n    init: function (element, valueAccesor) {\r\n        var text = ko.unwrap(valueAccesor());\r\n        $(element).tooltip({ title: text });\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nko.bindingHandlers.cssAutoComplete = {\r\n    init: function (element, valueAccessor) {\r\n        var value = valueAccessor(),\r\n            bootstrap = _(document.styleSheets).find(function (s) {\r\n                // TODO : what happend if were to combine the css with Bundle\r\n                if (!s) return false;\r\n                if (!s.href) return false;\r\n\r\n                return s.href.indexOf(\"bootstrap\") > -1;\r\n            });\r\n        var data = ['btn', 'btn-warning', 'btn-success', 'btn-link'];\r\n        if (bootstrap) {\r\n            data = _.chain(bootstrap.rules).filter(function (r) {\r\n                return /^\\./g.test(r.selectorText)\r\n                    && !/:/g.test(r.selectorText)\r\n                    && !/\\s/g.test(r.selectorText)\r\n                    && !/\\+/g.test(r.selectorText)\r\n                    && !/>/g.test(r.selectorText)\r\n                    && !/\\[/g.test(r.selectorText);\r\n            }).map(function (s) {\r\n                return s.selectorText.replace(/\\./g, \"\");\r\n            })\r\n                .value();\r\n        }\r\n\r\n        $(element).typeahead({\r\n            name: 'css_class',\r\n            limit: 10,\r\n            local: data\r\n        })\r\n        .on('typeahead:closed', function () {\r\n            value($(this).val());\r\n        });\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\nko.bindingHandlers.autocomplete = {\r\n    init: function (element, valueAccessor, allBindingsAccessor) {\r\n        var va = ko.unwrap(valueAccessor()),\r\n         entity = ko.unwrap(va.entity),\r\n         field = ko.unwrap(va.field),\r\n         query = ko.unwrap(va.query),\r\n         ttl = va.ttl || 300000,\r\n         allBindings = allBindingsAccessor(),\r\n         url = String.format(\"/api/list?table={0}&column={1}&filter={2}\", entity, field, query),\r\n         suggestions = new Bloodhound({\r\n             datumTokenizer: Bloodhound.tokenizers.obj.whitespace(\"name\"),\r\n             queryTokenizer: Bloodhound.tokenizers.whitespace,\r\n             prefetch: {\r\n                 url: url,\r\n                 tt1: ttl,\r\n                 filter: function (list) {\r\n                     return _(list).map(function (v) {\r\n                         return { name: v };\r\n                     });\r\n                 }\r\n             }\r\n\r\n         });\r\n\r\n        suggestions.initialize();\r\n        $(element).typeahead(null, {\r\n            name: 'autocomplete_' + $(element).prop(\"id\"),\r\n            displayKey: \"name\",\r\n            source: suggestions.ttAdapter()\r\n        })\r\n           .on('typeahead:closed', function () {\r\n               allBindings.value($(this).val());\r\n           });\r\n\r\n    }\r\n};\r\n\r\n\r\nko.bindingHandlers.scroll = {\r\n    init: function (element, valueAccessor) {\r\n        var rows = ko.unwrap(valueAccessor()),\r\n            done = false;\r\n        // wait for attached\r\n        //setTimeout(function () {\r\n        //    // TODO : just do it this once rows is more than certail values\r\n        //    $(element).tableScroll({ height: height });\r\n        //    done = true;\r\n        //}, 500);\r\n    }\r\n};\r\n","(function () {\r\n    Function.prototype.partial = function () {\r\n        var fn = this, args = Array.prototype.slice.call(arguments);\r\n        return function () {\r\n            var arg = 0;\r\n            for (var i = 0; i < args.length && arg < arguments.length; i++) {\r\n                if (args[i] === undefined) {\r\n                    args[i] = arguments[arg++];\r\n                }\r\n            }\r\n            return fn.apply(this, args);\r\n        };\r\n    };\r\n\r\n})();","(function (window) {\r\n    window.bespoke = window.bespoke || {};\r\n    window.bespoke.ServerOperationStatus = {        \r\n        OK: \"OK\",\r\n        ERROR : \"ERROR\"\r\n    };\r\n\r\n    window.bespoke.messagesText = {\r\n        SAVE_SUCCESS : \"Your item has been saved\"\r\n    };\r\n\r\n})(window);\r\n","/// <reference path=\"bootstrap.js\" />\r\n/// <reference path=\"google-maps-3-vs-1-0-vsdoc.js\" />\r\n/// <reference path=\"bootstrap-datepicker.js\" />\r\n/// <reference path=\"jquery.validate-vsdoc.js\" />\r\n/// <reference path=\"jquery-1.9.1.intellisense.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"underscore.js\" />\r\n/// <reference path=\"modernizr-2.6.2.js\" />\r\n\r\n\r\nvar _uiready = function () {\r\n    var init = function (view) {\r\n    };\r\n    return {\r\n        init: init\r\n    };\r\n\r\n}();\r\n","(function (window, $) {\r\n    window.bespoke = window.bespoke || {};\r\n    bespoke.utils = bespoke.utils || {};\r\n    bespoke.utils.form = bespoke.utils.form || {};\r\n    bespoke.utils.form.checkValidity = function (button) {\r\n        if (button.form)\r\n            return button.form.checkValidity();\r\n        var form = $(button).attr('form');\r\n        if (form) {\r\n           return document.getElementById(form).checkValidity();\r\n        }\r\n        throw \"cannot find the form for the button\";\r\n    };\r\n\r\n\r\n    window.console = window.console || {};\r\n    window.console.dir = window.console.dir || function (){};\r\n\r\n\r\n})(window, jQuery);","(function (window, $) {\r\n    window.Task = window.Task || {};\r\n    window.Task.fromResult = function (returnValue, delay) {\r\n        var tcs = new $.Deferred(),\r\n            d = delay || 100;\r\n\r\n        setTimeout(function () {\r\n            tcs.resolve(returnValue);\r\n        }, d);\r\n        return tcs.promise();\r\n\r\n    };\r\n\r\n})(window, jQuery);\r\n","\r\nko.bindingHandlers.theme = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {\r\n        // First get the latest data that we're bound to\r\n        var value = valueAccessor(), allBindings = allBindingsAccessor();\r\n        var valueUnwrapped = ko.unwrap(value);\r\n        if(bespoke.sph.Theme) {\r\n            var theme = new bespoke.sph.Theme();\r\n            if (theme[valueUnwrapped]) {\r\n                theme[valueUnwrapped](element, viewModel, allBindings, bindingContext);\r\n            }\r\n            \r\n        }\r\n\r\n    }\r\n};","/// <reference path=\"jquery-2.2.0.js\" />\r\n/// <reference path=\"jquery-ui-1.11.1.js\" />\r\n/// <reference path=\"modernizr-2.8.3.js\" />\r\n/// <reference path=\"bootstrap.js\" />\r\n/// <reference path=\"breeze.debug.js\" />\r\n/// <reference path=\"knockout-2.2.1.debug.js\" />\r\n/// <reference path=\"moment.js\" />\r\n/// <reference path=\"q.js\" />\r\n/// <reference path=\"toastr-1.1.5.js\" />\r\n"],"sourceRoot":"/source/"}