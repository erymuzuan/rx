var bespoke=bespoke||{};bespoke.sph=bespoke.sph||{};bespoke.sph.domain=bespoke.sph.domain||{};bespoke.sph.domain.SpacePartial=function(n){var i=require("durandal/system"),u=require(objectbuilders.datacontext),f=require(objectbuilders.logger),e=function(n){var t=_(this.CustomFieldValueCollection()).find(function(t){return t.Name()===n});if(!t)throw"Cannot find custom field for "+n+" in Space";return t.Value},o=function(n){var t=_(this.CustomListValueCollection()).find(function(t){return t.Name()===n});if(!t)throw"Cannot find custom list named "+n+" in Building";return t},s=function(n){return function(){var t=_(this.CustomListValueCollection()).find(function(t){return t.Name()===n}),r=new bespoke.sph.domain.CustomListRow(i.guid()),u=_(t.CustomFieldCollection()).map(function(n){var r=i.guid(),t=new bespoke.sph.domain.CustomFieldValue(r);return t.Name(n.Name()),t.Type(n.Type()),t});r.CustomFieldValueCollection(u);t.CustomListRowCollection.push(r)}},h=function(n,t){var i=this,r=_(i.CustomListValueCollection()).find(function(t){return t.Name()===n});return function(){r.CustomListRowCollection.remove(t)}},c=function(n){var t=this;return function(){require(["viewmodels/photo.dialog","durandal/app"],function(i,r){var u=ko.mapping.fromJS(ko.mapping.toJS(n));i.photo(u);r.showModal(i).done(function(i){i=="OK"&&t.PhotoCollection.replace(n,u)})})}},l=function(){var n=this;require(["viewmodels/photo.dialog","durandal/app"],function(t,r){var u=new bespoke.sph.domain.Photo(i.guid());t.photo(u);r.showModal(t).done(function(t){t&&t=="OK"&&n.PhotoCollection.push(u)})})},a=function(n){var t=this;return function(){t.PhotoCollection.remove(n)}},r=ko.observable(),t=function(n){if(n){var t=$.get("/Space/GetEncodedPath/"+n),i=$.get("/Space/GetCenter/"+n);$.when(t,i).then(function(n,t){if(t[0]){var i=t[0],u=String.format("http://maps.google.com/maps/api/staticmap?center={0},{1}&size=640x300&markers={0},{1}&sensor=false",i.Lat,i.Lng);r(u)}})}},v=function(n){var i=new $.Deferred;return u.post(JSON.stringify(n),"/Space/SaveMap").then(function(r){i.resolve(!0);f.log("Map has been successfully saved ",r,"buildingdetail",!0);t(n.spaceId)}),i.promise()};return typeof n.SpaceId=="number"&&t(n.SpaceId),typeof n.SpaceId=="function"&&(t(n.SpaceId()),n.SpaceId.subscribe(t)),{CustomField:e,CustomList:o,addCustomListItem:s,removeCustomListItem:h,staticMap:r,ApplicationTemplateOptions:ko.observableArray([]),addPhoto:l,editPhoto:c,removePhoto:a,saveMap:v}};bespoke.sph.domain.RolePartial=function(){return{permissions:ko.observableArray()}};
/*
//# sourceMappingURL=Space.min.js.map
*/