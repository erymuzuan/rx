define(["durandal/system","plugins/router","services/logger","services/datacontext",objectbuilders.config,objectbuilders.cultures],function(n,t,i,r,u){var e=function(){return t.map(u.routes).buildNavigationModel().mapUnknownRoutes("viewmodels/page.list","page.list").activate()},o=function(){var o=function(n){n.preventDefault();n.stopPropagation();var t=$(this);t.parent().addClass("open");$(document).one("click",function(){t.parent().removeClass("open")})};$(document).on("click","button.btn-context-action,a.btn-context-action",function(n){n.preventDefault();var i=$(this),t=i.parent().find(".context-action"),r=function(n){n.preventDefault();t.hide()};t.css({right:n.offsetX||"0px"}).show();$("button.close").one("click",r)});$(document).on("click","a.dropdown-toggle",o);$(document).on("click","table.table-striped th",function(n){n.preventDefault();var t=$(this).parents("table.table-striped");t&&!t.prop("sorted")&&(console.dir(n),t.tablesorter(),t.prop("sorted","1"),$(this).trigger("click"))});var r=$("#slider-menu"),u=function(){$("section#content").animate({"margin-left":0});r.hide().css({width:0})},e=function(){var n=new $.Deferred;return $("section#content").animate({"margin-left":280},function(){n.resolve(!0);r.show()}),r.css("height",$(document).height()).animate({width:280},n.resolve),n.promise()},n=r.is(":visible");$("#drawer-menu").on("click",function(t){t.preventDefault();n?u():e();n=!n});$("#slider-menu").on("click","li>a",function(){u();n=!1});$(document).on("keyup",function(t){t.ctrlKey&&t.keyCode===81&&(n?(u(),n=!1):e().done(function(){i.focus();n=!0}))});var s=$("div#slider-menu li"),i=$("#filter-text"),t=0,f=function(n){if(!n||!n.keyCode||n.keyCode!==40&&n.keyCode!==38&&n.keyCode!==13){t=0;var r=i.val().toLowerCase();s.each(function(){var n=$(this);typeof n.data("string")=="string"&&(n.data("string").toLowerCase().indexOf(r)>-1?n.show():n.hide())})}},h=function(n){var i=function(n){t+=n;var i=$("div#slider-menu li:visible");if(t<=0){t=1;return}if(t>i.length-1){t=i.length-1;return}i.removeClass("active");$(i[t]).addClass("active")};if(n&&n.keyCode){if(n.keyCode===40){i(1);return}if(n.keyCode===38){i(-1);return}if(n.keyCode===13){$("div#slider-menu li:visible.active").find("a").trigger("click");return}}},c=_.throttle(f,800);i.on("keyup",c).on("keyup",h).siblings("span").click(function(){i.val("");f()});i.val()&&f()},s=function(n){console.log(n);var i=String.format("Type eq '{0}' and EntityId eq {1}",n.entity,n.id()),t=new $.Deferred;return r.loadAsync("AuditTrail",i).then(function(n){f.auditTrailCollection(n.itemCollection);f.selectedAuditTrail(new bespoke.sph.domain.AuditTrail);t.resolve(!0);$("#shell-logviewer-modal").modal({})}),t.promise()},h=function(n){f.selectedAuditTrail(n)},c=function(n){var t=typeof n=="function"?n():n,i=new $.Deferred,r="/print/"+t.entity+"/"+t.id();return window.open(r),setTimeout(function(){i.resolve(!0)},500),i.promise()},f={activate:e,attached:o,router:t,viewAuditTrailCommand:s,printCommand:c,auditTrailCollection:ko.observableArray(),selectedAuditTrail:ko.observable(new bespoke.sph.domain.AuditTrail),selectAuditTrail:h};return f});
/*
//# sourceMappingURL=shell.min.js.map
*/