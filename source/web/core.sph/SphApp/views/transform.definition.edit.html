<link href="/Content/external/transformation-mapping.css" rel="stylesheet" />
<h1 data-bind="text:td().Name">Mapping Transform Definition</h1>
<style type="text/css">
    .functoid {
        border: 1px solid #356d55;
        border: 1px solid rgba(49, 140, 101, 0.33);
        width: 30px;
        height: 30px;
        position: absolute;
        padding: 5px;
        cursor: move;
    }

    #container-canvas {
        background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAHElEQVQYV2NkIBIwEqmOYVQh3pAiKni6urpmAgAP3AJCVok6LAAAAABJRU5ErkJggg==)repeat;
        min-height: 800px;
    }

    .category-common {
        color: #ff1f46;
    }

    .category-string {
        color: green;
    }

    .category-date {
        color: #0000ff;
    }

    .category-null {
        color: #a908c2;
    }

    div.error {
        color: #ff0000;
        content: "XX";
    }

    div.fep {
        width: 15px;
        height: 15px;
        background-color: orange;
        position: absolute;
        bottom: -7px;
        right: -7px;
        cursor: pointer;
    }

    ._jsPlumb_target_hover, ._jsPlumb_source_hover {
        background-color: #1e8151 !important;
    }

    .connector-label {
        color: white;
        background-color: rgb(137, 135, 135);
        padding: 5px;
    }

    .context-menu-item {
        cursor: default;
        display: block;
    }

        .context-menu-item > span {
            margin-left: 5px;
        }

        .context-menu-item:hover {
            background-color: #ccc;
        }

    /*!
    * jQuery contextMenu - Plugin for simple contextMenu handling

    */
    @font-face {
        font-family: context-menu-icons;
        font-style: normal;
        font-weight: 400;
        src: url(font/context-menu-icons.eot?4maaf);
        src: url(font/context-menu-icons.eot?4maaf#iefix) format("embedded-opentype"),url(font/context-menu-icons.woff2?4maaf) format("woff2"),url(font/context-menu-icons.woff?4maaf) format("woff"),url(font/context-menu-icons.ttf?4maaf) format("truetype");
    }

    .context-menu-icon-add:before, .context-menu-icon-copy:before, .context-menu-icon-cut:before, .context-menu-icon-delete:before, .context-menu-icon-edit:before, .context-menu-icon-paste:before, .context-menu-icon-quit:before {
        position: absolute;
        top: 50%;
        left: 0;
        width: 28px;
        font-family: context-menu-icons;
        font-size: 16px;
        font-style: normal;
        font-weight: 400;
        line-height: 1;
        color: #2980b9;
        text-align: center;
        -webkit-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
        -o-transform: translateY(-50%);
        transform: translateY(-50%);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .context-menu-icon-add.context-menu-hover:before, .context-menu-icon-copy.context-menu-hover:before, .context-menu-icon-cut.context-menu-hover:before, .context-menu-icon-delete.context-menu-hover:before, .context-menu-icon-edit.context-menu-hover:before, .context-menu-icon-paste.context-menu-hover:before, .context-menu-icon-quit.context-menu-hover:before {
        color: #fff;
    }

    .context-menu-icon-add:before {
        content: "";
    }

    .context-menu-icon-copy:before {
        content: "";
    }

    .context-menu-icon-cut:before {
        content: "";
    }

    .context-menu-icon-delete:before {
        content: "";
    }

    .context-menu-icon-edit:before {
        content: "";
    }

    .context-menu-icon-paste:before {
        content: "";
    }

    .context-menu-icon-quit:before {
        content: "";
    }

    .context-menu-list {
        position: absolute;
        display: inline-block;
        min-width: 180px;
        max-width: 360px;
        padding: 4px 0;
        margin: 5px;
        font-family: inherit;
        font-size: inherit;
        list-style-type: none;
        background: #fff;
        border: 1px solid #bebebe;
        border-radius: 3px;
        -webkit-box-shadow: 0 2px 5px rgba(0,0,0,.5);
        box-shadow: 0 2px 5px rgba(0,0,0,.5);
    }

    .context-menu-item {
        position: relative;
        padding: 3px 28px;
        color: #2f2f2f;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background-color: #fff;
    }

    .context-menu-separator {
        padding: 0;
        margin: 5px 0;
        border-bottom: 1px solid #e6e6e6;
    }

    .context-menu-item > label > input, .context-menu-item > label > textarea {
        -webkit-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        user-select: text;
    }

    .context-menu-item.context-menu-hover {
        color: #fff;
        cursor: pointer;
        background-color: #2980b9;
    }

    .context-menu-item.context-menu-disabled {
        color: #626262;
        background-color: #fff;
    }

        .context-menu-input.context-menu-hover, .context-menu-item.context-menu-disabled.context-menu-hover {
            cursor: default;
            background-color: #eee;
        }

    .context-menu-submenu:after {
        position: absolute;
        top: 50%;
        right: 8px;
        z-index: 1;
        width: 0;
        height: 0;
        content: '';
        border-color: transparent transparent transparent #2f2f2f;
        border-style: solid;
        border-width: 4px 0 4px 4px;
        -webkit-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
        -o-transform: translateY(-50%);
        transform: translateY(-50%);
    }

    .context-menu-item.context-menu-input {
        padding: 5px 10px;
    }

    .context-menu-input > label > * {
        vertical-align: top;
    }

    .context-menu-input > label > input[type=checkbox], .context-menu-input > label > input[type=radio] {
        position: relative;
        top: 3px;
    }

    .context-menu-input > label, .context-menu-input > label > input[type=text], .context-menu-input > label > select, .context-menu-input > label > textarea {
        display: block;
        width: 100%;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

        .context-menu-input > label > textarea {
            height: 100px;
        }

    .context-menu-item > .context-menu-list {
        top: 5px;
        right: -5px;
        display: none;
    }

    .context-menu-item.context-menu-visible > .context-menu-list {
        display: block;
    }

    .context-menu-accesskey {
        text-decoration: underline;
    }

    .connected {
        font-weight: bolder;
    }
</style>


<div id="error-list" class="row" data-bind="visible:errors().length">
    <!-- ko foreach : errors -->
    <div class="col-md-8 col-md-offset-2 alert alert-dismissable alert-danger" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <i class="fa fa-exclamation"></i>
        <span data-bind="text:Message"></span>
        <!-- ko if : Code -->
        <strong class="icon-read-more" data-bind="bootstrapPopover : Code"> ..more</strong>
        <!-- /ko-->
        <!-- ko if : FileName -->
        <br />
        <a href="javascript:;" data-bind="click : $root.viewFile">
            <span class="small" data-bind="text:FileName"></span>(<span class="small" data-bind="text:Line"></span>)
        </a>
        <!-- /ko-->

    </div>
    <div class="col-md-2"></div>
    <!-- /ko-->
</div>


<div class="row">
    <div class="col-lg-2">
        <h3 data-bind="with : td"><span data-bind="attr:{title:InputTypeName}">Source</span></h3>
        <a href="#" data-bind="visible:!sourceSchema(), click : editProp" style="margin-top: 50px">
            <br />
            <br />
            <br />
            <br />
            <br />
            Pick a source
            <i class="fa fa-sign-in fa-2x" style="color: green"></i>
        </a>

        <ul id="source-panel" style="list-style: none;margin-left: -49px"></ul>
    </div>
    <div class="col-lg-6" data-bind="with: td">
        <div>
            <ul data-bind="foreach: $root.pages" class="nav nav-tabs">
                <li role="presentation" data-bind="css: {'active' : active}">
                    <a href="#" data-bind="text:name, click : $root.changePage"></a>
                </li>
            </ul>
        </div>
        <div id="container-canvas" data-bind="foreach: $root.functoids">
            <!-- ko ifnot : ko.unwrap($type) === 'Bespoke.Sph.Domain.SourceFunctoid, domain.sph' -->
            <div class="functoid" style="z-index: 999" data-bind="style : {'left': X() + 'px','top': Y() + 'px'},
                attr : {id : WebId},
                functoidPopover : $data">
                <div data-bind="with:designer">
                    <div class="toolbox-item" data-bind="visible: FontAwesomeIcon">
                        <i data-bind="attr : {'class':'fa fa-' + FontAwesomeIcon + ' category-' + Category}"></i>
                    </div>
                    <div class="toolbox-item" data-bind="visible: BootstrapIcon">
                        <i data-bind="attr : {'class':'glyphicon glyphicon-' + BootstrapIcon + ' category-' + Category}"></i>
                    </div>
                </div>

                <div class="fep"></div>
            </div>
            <!-- /ko -->
        </div>
    </div>
    <div class="col-lg-2">
        <h3 data-bind="with : td"><span data-bind="attr:{title:OutputTypeName}">Destination</span></h3>
        <a href="#" data-bind="visible:!destinationSchema(), click : editProp" style="margin-top: 50px">
            <br />
            <br />
            <br />
            <br />
            <br />
            Pick the output
            <i class="fa fa-sign-out fa-2x" style="color: blue"></i>
        </a>
        <ul id="destination-panel" style="list-style: none;margin-left: -75px"></ul>
    </div>
    <div class="col-lg-2" id="functoid-toolbars">


        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" data-bind="foreach : $root.functoidGroups">

            <div class="row">
                <a role="button" style="text-align: left;padding: 10px" class="btn btn-default col-md-12 col-lg-12" data-bind="attr : {'href' : '#' + id, 'aria-controls' : id}" data-toggle="collapse" data-parent="#accordion" aria-expanded="false" aria-controls="collapseOne">
                    <i class="fa fa-cogs" style="margin-right: 5px"></i>
                    <strong data-bind="text:Category"></strong>
                </a>
            </div>

            <ul data-bind="attr : {'id':id, 'aria-labelledby' : id}, foreach :functoids" class="functoid-toolbox list-group panel-collapse collapse">
                <li class="list-group-item">
                    <div data-bind="with:designer">
                        <div class="toolbox-item" data-bind="visible: FontAwesomeIcon" style="display: inline-block">
                            <i data-bind="attr : {'class':'fa fa-' + FontAwesomeIcon + ' category-' + Category}"></i>
                        </div>
                        <div class="toolbox-item" data-bind="visible: BootstrapIcon" style="display: inline-block">
                            <i data-bind="attr : {'class':'glyphicon glyphicon-' + BootstrapIcon + ' category-' + Category}"></i>
                        </div>
                        <span data-bind="text:Name"></span>
                    </div>
                </li>
            </ul>


        </div>


    </div>


</div>

<div class="row">
</div>


