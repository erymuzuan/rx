{
  "$type": "Bespoke.Sph.Domain.Page, domain.sph",
  "PageId": 5,
  "Name": "Permohonan Baru",
  "IsRazor": true,
  "IsPartial": false,
  "VirtualPath": "~/Views/Workflow_8002_0/PermohonanBaru.cshtml",
  "Tag": "wf_8002_affb4e73-6669-41aa-a641-d218b0c5aa74",
  "Version": 0,
  "Mode": null,
  "Extension": null,
  "Code": "@using System.Web.Mvc.Html\n@using Bespoke.Sph.Domain\n@using Newtonsoft.Json\n@model Bespoke.Sph.Workflows_8002_0.PermohonanBaruViewModel\n\n@{\n    ViewBag.Title = Model.Instance.Name;\n    Layout = \"~/Views/Shared/_Layout.cshtml\";\n    const string controllerString = \"Controller\";\n    var setting = new JsonSerializerSettings {TypeNameHandling = TypeNameHandling.All};\n    var confirmationText = Model.Screen.ConfirmationOptions.Value;\n    \n}\n\n<div class=\"row\">\n    <h1>@Model.Screen.FormDesign.Name</h1>\n    <span>@Model.Screen.FormDesign.Description</span>\n</div>\n<div class=\"row\">\n    <form class=\"form-horizontal\" id=\"workflow-start-form\" data-bind=\"with: instance\">\n        @foreach (var fe in Model.Screen.FormDesign.FormElementCollection)\n        {\n            fe.Path = fe.Path.ConvertJavascriptObjectToFunction();\n            fe.SetDefaultLayout(Model.Screen.FormDesign);\n            @Html.EditorFor(f => fe)\n        }\n   \n    </form>\n\n</div>\n\n\n@section scripts\n{\n    <script type=\"text/javascript\" src=\"/Workflow_8002_0/Schemas\"></script>\n    <script type=\"text/javascript\">\n        require(['services/datacontext', 'jquery','services/app', 'services/system'], function(context,jquery,app, system) {\n\n            \n           var instance = context.toObservable(@Html.Raw(JsonConvert.SerializeObject(Model.Instance, setting)),/@Model.Namespace.Replace(\".\",\"\\\\.\")\\.(.*?),/),\n               screen = context.toObservable(@Html.Raw(JsonConvert.SerializeObject(Model.Screen, setting)),/@Model.Namespace.Replace(\".\",\"\\\\.\")\\.(.*?),/),\n               vm = {\n                id : @Model.Instance.WorkflowDefinitionId,\n                instance : ko.observable(instance),    \n                screen : ko.observable(screen),\n                isBusy : ko.observable(),\n                save : function(){\n                      var tcs = new $.Deferred(),\n                            data = ko.mapping.toJSON(vm.instance),\n                            button = $(this);\n\n                        button.prop('disabled', true);\n                        context.post(data, \"/workflow_8002_0/SavePermohonanBaru\")\n                            .then(function(result) {\n                                tcs.resolve(result);\n                                @if(Model.Screen.ConfirmationOptions.Type == \"Message\")\n                                {\n                                    <text>\n                                    var msg = _.template('@Html.Raw(confirmationText)')(result.wf);\n                                    app.showMessage(msg, '@Model.Screen.Name', ['OK'])\n                                        .done(function(dr){\n                                            console.log(dr);\n                                        });\n                                    </text>\n                                }else\n                                {\n                                    <text>\n                                    window.location = \"@confirmationText\";\n                                    </text>\n                                }\n                       \n\n                            });\n                        return tcs.promise();\n                }\n            };\n            \n            instance.addChildItem = function(list, type){\n                        return function(){\n                            var item = bespoke.sph.w_8002_0[type](system.guid());\n                            list.push(item);\n                        }\n                    };\n            \n            instance.removeChildItem = function(list, obj){\n                        return function(){\n                            list.remove(obj);\n                        }\n                    };\n            ko.applyBindings(vm, document.getElementById('body'));\n            @*  the div#body is defined in _Layout.cshtml, if you use different Layout then this has got to changed accordingly *@\n\n      \n        });\n\n    </script>\n}",
  "CreatedBy": "admin",
  "CreatedDate": "2014-02-05T14:15:37.6069968+08:00",
  "ChangedBy": "admin",
  "ChangedDate": "2014-02-05T14:15:37.6059967+08:00",
  "WebId": "d141bb6c-db52-43ad-b03e-ac5cde86dfb8"
}